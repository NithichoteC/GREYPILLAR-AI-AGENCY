<!DOCTYPE html><!--  Professional Calendar Booking Page  -->
<html data-wf-page="686bac2b4d1341d4cca18e08" data-wf-site="686bac2b4d1341d4cca18daf" lang="en">
<head>
  <meta charset="utf-8">
  <title>Book Your Strategy Session - AI Automation Consultation</title>
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." name="description">
  <meta content="Book Your Strategy Session - AI Automation Consultation" property="og:title">
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." property="og:description">
  <meta content="Book Your Strategy Session - AI Automation Consultation" property="twitter:title">
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." property="twitter:description">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/phuns-fresh-site.webflow.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="apple-touch-icon.png" rel="apple-touch-icon">
  <link rel="manifest" href="/manifest.json">
  <!-- Mobile Overflow Fixes -->
  <link href="css/mobile-fixes.css" rel="stylesheet" type="text/css">
  
  <!-- Custom Video Player Styles -->
  
  <!-- Removed iframe-resizer due to license requirements -->
  
  <!-- Performance: Preload Cal.com resources -->
  <link rel="preload" href="https://app.cal.com/embed/embed.js" as="script">
  <link rel="dns-prefetch" href="https://app.cal.com">
  <link rel="preconnect" href="https://app.cal.com">
  
  <!-- Video.js Professional Video Player -->
  <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
  <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
  
  <!-- Cal.com embed script with immediate setup -->
  <script type="text/javascript">
    (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
    
    // Cal.com loader ready - initialization happens in DOMContentLoaded for proper timing
  </script>
  
  <style>
    /* Calendar Page Design */
    :root {
      /* CORRECTED: Use actual main site background color #0f0f0f */
      --primary-black: #0f0f0f; /* Match main site dark grey background */
      --white: white;
      --border: #b4b4b414;
      --grey: #b4b4b4;
      --dark: #0f0f0f;
      --secondary-black: #0f0f0f;
    }
    
    * {
      box-sizing: border-box;
      -webkit-text-stroke: unset !important;
      text-stroke: unset !important;
    }

    /* Professional Mobile Experience - Prevent Zoom & Scroll Bounce */
    html, body {
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;
      overflow-x: hidden;
      touch-action: manipulation;
      -webkit-text-size-adjust: 100%;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    
    /* Allow text selection in input fields and content areas */
    input, textarea, [contenteditable] {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }

    /* Remove unwanted text effects globally */
    ::selection {
      background: rgba(59, 130, 246, 0.2) !important;
      color: inherit !important;
      -webkit-text-stroke: none !important;
    }

    ::-moz-selection {
      background: rgba(59, 130, 246, 0.2) !important;
      color: inherit !important;
    }
    
    /* PHONE INPUT CURSOR FIX: Force I-beam cursor consistently */
    #phoneInput,
    input[type="tel"]#phoneInput {
      cursor: text !important;
    }
    
    #phoneInput:hover,
    #phoneInput:focus,
    #phoneInput:active {
      cursor: text !important;
    }
    
    /* Ensure parent containers don't override cursor */
    #phoneFormContainer,
    #phoneComponentContainer {
      cursor: default !important;
    }
    
    /* DEFENSIVE PROGRAMMING: Ensure interactions work even if JS fails */
    #phoneComponentContainer.form-active,
    #phoneComponentContainer:hover,
    #phoneFormContainer[style*="opacity: 1"] {
      pointer-events: auto !important;
    }
    
    #phoneInput,
    #callButton {
      pointer-events: auto !important;
    }
    
    /* Enhanced button interaction states */
    #callButton:hover {
      cursor: pointer !important;
      opacity: 0.8 !important;
    }
    
    /* Form container activation states */
    #phoneFormContainer[style*="opacity: 1"] #phoneInput {
      cursor: text !important;
    }
    
    /* ENHANCED: Professional confirmation page reload persistence */
    body.confirmation-loading {
      /* Prevent flash of calendar content during confirmation restoration */
      overflow: hidden;
    }
    
    body.confirmation-loading #my-cal-inline-30min,
    body.confirmation-loading .calendar-container {
      /* Hide calendar content during restoration to prevent flash */
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.1s ease;
    }
    
    body.confirmation-loading::before {
      /* Professional loading overlay during restoration */
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--primary-black);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    body.confirmation-loading::after {
      /* Loading indicator */
      content: 'Restoring your session...';
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: var(--white);
      font-size: 1.1rem;
      font-weight: 500;
      z-index: 10000;
      opacity: 0;
      animation: fadeInLoading 0.3s ease 0.1s forwards;
    }
    
    @keyframes fadeInLoading {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) translateY(10px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) translateY(0);
      }
    }
    
    html {
      overflow-x: hidden;
      overflow-y: auto;
    }
    
    body {
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background-color: var(--primary-black);
      color: var(--white);
      line-height: 1.5;
      overflow-x: hidden;
      overflow-y: auto;
    }
    
    .page-wrapper {
      min-height: 100vh;
      background-color: var(--primary-black);
      overflow: visible;
    }
    
    /* Header Section */
    .calendar-header {
      text-align: center;
      padding: 4rem 0 2rem 0;
      background-color: var(--primary-black); /* Match site background */
    }
    
    .calendar-header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 0 0 1rem 0;
      color: var(--white);
      letter-spacing: -0.02em;
    }
    
    .calendar-header p {
      font-size: 1.1rem;
      color: var(--grey);
      margin: 0;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Progress Indicator */
    .progress-indicator {
      text-align: center;
      padding: 1rem 0 2rem 0;
    }
    
    /* Removed duplicate .progress-steps definition - main one is at line 2889 */
    
    .progress-step {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .step-circle {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      color: var(--grey);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      border: 2px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }
    
    .step-circle.completed {
      background: rgba(255, 255, 255, 0.3) !important; /* Match line color */
      color: var(--primary-black) !important; /* Black - shows background through */
      border: none !important; /* Remove weird border */
      box-shadow: none !important; /* Clean look */
      font-size: 0.9rem;
      font-weight: 700;
    }
    
    .step-circle.completed svg {
      width: 14px !important;
      height: 14px !important;
      fill: white !important;
      display: block !important;
      flex-shrink: 0;
      background: transparent !important; /* Remove any background */
      border: none !important; /* Remove any border */
    }
    
    .progress-indicator .step-circle.completed svg path {
      fill: var(--primary-black) !important; /* Black - shows background through like the "2" */
      stroke: none !important; /* No stroke needed */
      font-weight: normal !important; /* Remove font-weight interference */
    }
    
    .step-circle:not(.completed) {
      background: rgba(255, 255, 255, 0.8);
      color: var(--primary-black);
      border: 2px solid rgba(255, 255, 255, 0.9);
    }
    
    /* Active progress step styling - fixed to show white circles */
    .progress-step.active .step-circle {
      background: var(--white) !important;
      color: var(--primary-black) !important;
      border: 2px solid var(--white) !important;
    }
    
    /* Progress step active state consistency */
    .progress-step.active .progress-step-circle {
      background: var(--white) !important;
      border-color: var(--white) !important;
      color: var(--primary-black) !important;
    }
    
    .step-text {
      font-size: 0.9rem;
      color: var(--grey);
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .progress-step:has(.step-circle.completed) .step-text {
      color: rgba(255, 255, 255, 0.3) !important; /* Match line color */
      font-weight: 600;
    }
    
    .progress-step:has(.step-circle:not(.completed)) .step-text {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
    }
    
    .progress-indicator .progress-steps .step-divider {
      width: 40px !important;
      max-width: 40px !important;
      height: 2px !important;
      background: rgba(255, 255, 255, 0.3) !important; /* Visible white on black background */
      opacity: 1 !important;
      flex: 0 0 40px !important; /* Fixed flex basis - won't expand */
      align-self: flex-start !important; /* Align to top where circles are */
      margin-top: 11px !important; /* Center with 24px circle (12px - 0.5px) */
      margin-left: 15px !important;
      margin-right: 15px !important;
    }
    
    .progress-steps:hover .step-divider {
      background: rgba(255, 255, 255, 0.4); /* Slightly brighter on hover */
    }
    
    /* Calendar Container - Professional Design */
    .calendar-container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: 0 1rem 2rem 1rem;
      background-color: var(--primary-black); /* Match site background */
    }
    
    /* Personalized Message Section */
    .personalized-message {
      text-align: center;
      padding: 0.5rem 0 1rem 0; /* Reduced top padding */
    }
    
    .personalized-text {
      font-size: 1.1rem;
      color: var(--grey);
      margin: 0 0 1.5rem 0; /* Reduced bottom margin */
      font-weight: 400;
    }
    
    .calendar-divider {
      width: 100px;
      height: 1px;
      background: var(--border);
      margin: 0 auto 0.375rem auto; /* Tighter spacing between divider and calendar */
    }
    
    /* Modern Container-Free Cal.com Architecture - 2024 Best Practice */
    .cal-modern-embed {
      width: 100%;
      background: var(--primary-black);
    }
    
    /* Modern responsive iframe with CSS aspect-ratio */
    .cal-modern-embed iframe {
      width: 100%;
      border: none;
      background: var(--primary-black);
      display: block;
    }
    
    /* Mobile: 4:3 aspect ratio for optimal mobile viewing */
    @media (max-width: 767px) {
      .cal-modern-embed iframe {
        aspect-ratio: 4 / 3;
      }
      
      /* Mobile alignment fix */
      .calendar-container {
        padding: 0 0.5rem 2rem 0.5rem;
        max-width: 100%;
        overflow-x: hidden;
      }
      
      #my-cal-inline-30min {
        width: 100% !important;
        max-width: 100vw !important;
        margin: 0 auto !important;
        padding: 0 !important;
      }
      
      .cal-modern-embed {
        width: 100% !important;
        max-width: 100% !important;
        overflow: hidden;
      }
    }
    
    /* Tablet: 16:10 aspect ratio for tablet viewing */
    @media (min-width: 768px) and (max-width: 1023px) {
      .cal-modern-embed iframe {
        aspect-ratio: 16 / 10;
      }
    }
    
    /* Desktop: 16:9 aspect ratio for desktop viewing */
    @media (min-width: 1024px) {
      .cal-modern-embed iframe {
        aspect-ratio: 16 / 9;
      }
    }
    
    
    /* Aggressively hide ALL Cal.com branding */
    [data-cal-namespace] [class*="cal-com"],
    [data-cal-namespace] [class*="powered"],
    [data-cal-namespace] [class*="branding"],
    [data-cal-namespace] footer,
    [data-cal-namespace] [href*="cal.com"],
    #my-cal-inline-30min [class*="powered-by"],
    #my-cal-inline-30min [class*="branding"],
    #my-cal-inline-30min footer,
    .cal-powered-by,
    .cal-branding,
    a[href*="cal.com"]:not([href*="app.cal.com"]),
    /* Target specific confirmation page branding */
    [data-cal-namespace] [class*="create-your-own"],
    [data-cal-namespace] [class*="try-it-free"],
    [data-cal-namespace] [class*="promotional"],
    #my-cal-inline-30min [href*="cal.com/signup"],
    #my-cal-inline-30min [href*="cal.com"][target="_blank"],
    /* Target parent containers of Cal.com links */
    div:has(> a[href*="cal.com"]),
    p:has(> a[href*="cal.com"]),
    /* Target the specific text on confirmation */
    *:has-text("Create your own booking link"),
    *:has-text("Try it for free") {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    /* REMOVED: Let Cal.com handle color-scheme internally */
    
    /* Professional Cal.com Container - Consolidated Styling */
    #my-cal-inline-30min {
      width: 100% !important;
      max-width: 100% !important;
      font-family: inherit;
      border-radius: 8px;
      overflow: hidden;
      background-color: var(--primary-black) !important;
    }
    
    /* REMOVED AGGRESSIVE OVERRIDES: Let Cal.com handle its own internal styling */
    /* Only fixing the white container background issue with surgical approach */
    
    /* MINIMAL CAL.COM OVERRIDE - Using Official Theming */
    /* Only target container background for consistency */
    #my-cal-inline-30min {
      background-color: var(--primary-black) !important;
    }
    
    /* Ensure Cal.com container matches site background */
    #my-cal-inline-30min > div:first-child {
      background-color: var(--primary-black) !important;
    }
    
    /* CUSTOM LOADING SCREEN - Replaces Cal.com Blue Redirect */
    .custom-loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-black);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    .custom-loading-overlay.active {
      display: flex;
    }
    
    /* Professional Site-Matching Spinner */
    .custom-loading-spinner {
      width: 60px;
      height: 60px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-top: 2px solid var(--white);
      border-radius: 50%;
      animation: customSpin 1s linear infinite;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .custom-loading-spinner::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 50%;
      animation: customPulse 2s ease-in-out infinite;
    }
    
    @keyframes customSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes customPulse {
      0%, 100% { 
        opacity: 0.3; 
        transform: scale(1); 
      }
      50% { 
        opacity: 1; 
        transform: scale(1.05); 
      }
    }
    
    .custom-loading-text {
      color: var(--white);
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      letter-spacing: -0.01em;
    }
    
    .custom-loading-subtitle {
      color: var(--grey);
      font-size: 1rem;
      font-weight: 400;
      text-align: center;
      max-width: 400px;
      line-height: 1.5;
    }
    
    /* Fade transitions for smooth UX */
    .custom-loading-overlay {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    
    .custom-loading-overlay.active {
      opacity: 1;
    }
    
    /* LEGACY: Keep original loading container for fallback */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 580px;
      width: 100%;
      color: var(--grey);
      background: var(--primary-black); /* Match main site black background */
      border-radius: 8px;
      position: relative;
      overflow: hidden;
    }
    
    /* Premium Loading Spinner */
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 3px solid var(--border);
      border-top: 3px solid var(--white);
      border-radius: 50%;
      animation: spin 1.2s linear infinite;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .loading-spinner::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }
    
    /* Calendar Skeleton Placeholder */
    .calendar-skeleton {
      width: 100%;
      max-width: 800px;
      margin: 2rem auto;
      background: var(--primary-black);
      border-radius: 12px;
      padding: 2rem;
      display: none; /* Show after initial spinner */
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .skeleton-header {
      height: 40px;
      background: linear-gradient(90deg, #404040 25%, #505050 50%, #404040 75%);
      border-radius: 8px;
      margin-bottom: 2rem;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-header::after {
      content: '';
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 30px;
      height: 20px;
      background: linear-gradient(90deg, #303030 25%, #404040 50%, #303030 75%);
      border-radius: 4px;
      animation: shimmer 2.5s infinite 0.2s;
    }
    
    .skeleton-calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 12px;
      margin-bottom: 3rem;
    }
    
    .skeleton-day {
      height: 45px;
      background: linear-gradient(90deg, #3a3a3a 25%, #4a4a4a 50%, #3a3a3a 75%);
      border-radius: 8px;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-day:nth-child(odd) { animation-delay: 0.1s; }
    .skeleton-day:nth-child(even) { animation-delay: 0.2s; }
    
    .skeleton-day.available {
      background: linear-gradient(90deg, #1a5f3a 25%, #2a7f4a 50%, #1a5f3a 75%);
      animation: shimmer 2.5s infinite 0.3s;
    }
    
    /* Professional Custom Video Player */
    .professional-video-container {
      position: relative;
      width: 100%;
      max-width: 900px; /* Professional laptop-friendly size */
      margin: 0 auto 3rem;
      /* Remove aspect-ratio to let child container control dimensions */
      background: transparent;
      border-radius: 12px;
      overflow: hidden;
    }
    
    .video-poster-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      border-radius: 12px;
      overflow: hidden;
      background: transparent;
      border: 2px solid rgba(255, 255, 255, 0.15);
    }
    
    .video-poster {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .video-poster:hover {
      /* Remove excessive scaling animation */
    }
    
    .video-poster-content {
      text-align: center;
      margin-bottom: 2rem;
      z-index: 2;
      position: relative;
    }
    
    .video-title {
      font-size: 2rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 0.5rem;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .video-subtitle {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 400;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    /* UPDATED: Lower specificity definition - should be overridden by high-specificity version */
    .video-play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.4);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    
    /* CONSOLIDATED: Professional Play Button - Apple/Vercel Style */
    .video-poster .professional-play-button {
      width: 80px !important;
      height: 80px !important;
      border-radius: 50% !important;
      background: rgba(255, 255, 255, 1) !important;
      border: none !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 0 0 rgba(255, 255, 255, 0.4) !important;
      position: relative !important;
      z-index: 10 !important;
      outline: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    
    .video-poster .professional-play-button:focus,
    .video-poster .professional-play-button:active {
      outline: none !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4) !important;
    }
    
    .video-poster .professional-play-button:hover {
      transform: scale(1.05) !important;
      background: rgba(255, 255, 255, 1) !important;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 0 0 0 4px rgba(255, 255, 255, 0.2) !important;
    }
    
    .video-poster .professional-play-button:active {
      transform: scale(1.02) !important;
    }
    
    /* Unicode Play Symbol - Bulletproof Rendering */
    .play-symbol {
      font-size: 24px !important;
      color: #2d2d2d !important;
      font-weight: normal !important;
      line-height: 1 !important;
      margin-left: 3px; /* Optical adjustment for play symbol */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      -webkit-font-smoothing: antialiased !important;
      text-rendering: optimizeLegibility !important;
    }
    
    .hidden-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      z-index: 5;
      display: none;
    }
    
    .hidden-video.playing {
      display: block;
    }
    
    /* Professional HTML5 Video Controls Styling */
    
    .replay-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 15;
    }
    
    .replay-overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }
    
    .replay-button {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .replay-button:hover {
      transform: scale(1.1);
      background: rgba(255, 255, 255, 1);
    }
    
    .replay-icon {
      width: 32px;
      height: 32px;
      color: #333;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .video-title {
        font-size: 1.5rem;
      }
      
      .video-subtitle {
        font-size: 0.9rem;
      }
      
      .video-poster .professional-play-button {
        width: 80px !important;
        height: 80px !important;
      }
      
      .play-symbol {
        font-size: 20px !important;
      }
      
      .play-icon {
        width: 24px;
        height: 24px;
      }
    }
    
    /* Week Days Header */
    .skeleton-weekday {
      height: 20px;
      background: linear-gradient(90deg, #303030 25%, #404040 50%, #303030 75%);
      border-radius: 4px;
      animation: shimmer 2.5s infinite;
      margin-bottom: 10px;
    }
    
    .skeleton-times {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin-bottom: 2rem;
    }
    
    .skeleton-time {
      height: 44px;
      background: linear-gradient(90deg, #2a4a2a 25%, #3a5a3a 50%, #2a4a2a 75%);
      border-radius: 8px;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-time:nth-child(1) { animation-delay: 0.1s; }
    .skeleton-time:nth-child(2) { animation-delay: 0.2s; }
    .skeleton-time:nth-child(3) { animation-delay: 0.3s; }
    .skeleton-time:nth-child(4) { animation-delay: 0.4s; }
    .skeleton-time:nth-child(5) { animation-delay: 0.5s; }
    .skeleton-time:nth-child(6) { animation-delay: 0.6s; }
    
    @keyframes shimmer {
      0% {
        background-position: -200px 0;
      }
      100% {
        background-position: calc(200px + 100%) 0;
      }
    }
    
    /* Professional Confirmation Section - Matches Homepage Style */
    .confirmation-container {
      text-align: center;
      padding: 8rem 2rem; /* Match .padding-section-large */
      min-height: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f0f0f; /* Match site background */
      margin: 0;
    }
    
    .confirmation-success-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(74, 222, 128, 0.1);
      color: #4ade80;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 2rem;
      border: 1px solid rgba(74, 222, 128, 0.2);
    }
    
    .confirmation-heading {
      font-size: clamp(2.5rem, 5vw, 3.5rem);
      margin-bottom: 1.5rem;
      color: #ffffff;
      font-weight: 600;
      letter-spacing: -0.02em;
      line-height: 1.1;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
    }
    
    .confirmation-tagline {
      font-size: 1.25rem;
      color: #b4b4b4;
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
      font-weight: 300;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .confirmation-message {
      font-size: 1.1rem;
      color: #ffffff;
      margin-bottom: 3rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
      font-weight: 400;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .confirmation-button {
      display: inline-block;
      padding: 1rem 3rem;
      background: var(--white);
      color: var(--primary-black);
      text-decoration: none;
      border: 2px solid var(--white);
      border-radius: 0;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.3s ease;
      cursor: pointer;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .confirmation-button:hover {
      background: transparent;
      color: var(--white);
    }
    
    /* Section Dividers */
    .section-divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      margin: 2.5rem auto;
      width: 100%;
      max-width: 600px;
    }
    
    /* Mobile spacing reduction */
    @media (max-width: 767px) {
      .section-divider {
        margin: 1.5rem auto;
      }
      
      /* Reduce spacing between confirmation sections on mobile */
      .confirmation-container {
        padding: 4rem 2rem; /* Reduce from 8rem */
      }
      
      .confirmation-video {
        margin: 1rem 0 1.5rem 0; /* Reduce bottom margin */
      }
      
      .ai-supporting-text {
        margin: 0.75rem 0 !important; /* Tighter mobile spacing */
        font-size: 0.85rem;
      }
    }
    
    @media (max-width: 479px) {
      .section-divider {
        margin: 1rem auto; /* Even tighter on very small screens */
      }
      
      .confirmation-container {
        padding: 3rem 1.5rem; /* Even more compact */
      }
      
      .ai-supporting-text {
        margin: 0.5rem 0 !important; /* Very tight mobile spacing */
        font-size: 0.8rem;
      }
    }
    
    /* Enhanced Confirmation Page Styles */
    .confirmation-video {
      margin: 1rem 0 2rem 0;
      text-align: center;
      width: 100%;
      max-width: 900px; /* Match professional laptop-friendly size */
      margin-left: auto;
      margin-right: auto;
    }
    
    .confirmation-video h3 {
      font-size: 1.375rem;
      margin-bottom: 0;
      color: var(--white);
      font-weight: 600;
    }
    
    .video-wrapper {
      max-width: 900px; /* Professional laptop-friendly size */
      margin: 0 auto;
      position: relative;
      background: transparent;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      /* Use aspect-ratio instead of padding hack */
      aspect-ratio: 16 / 9;
    }
    
    /* Fallback for older browsers */
    @supports not (aspect-ratio: 16 / 9) {
      .video-wrapper {
        padding-bottom: 56.25%;
        height: 0;
      }
    }
    
    .video-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #202020;
      color: var(--grey);
      font-style: italic;
    }
    
    /* PROFESSIONAL ASPECT-RATIO VIDEO - Same proportions all devices */
    #confirmation-video-player {
      width: 100%;
      max-width: 900px; /* Professional laptop-friendly size */
      height: auto;
      display: block;
      object-fit: cover;
      background: transparent;
      border-radius: 12px;
      margin: 0 auto; /* Center the video */
      aspect-ratio: 16/9; /* Force consistent 16:9 ratio on all devices */
    }
    
    #confirmation-video-player:hover {
      /* Removed brightness filter - keep original video untouched */
    }
    
    /* Professional video thumbnail styling */
    #confirmation-video-player[poster] {
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    /* Clean video wrapper - minimalistic design */
    .video-wrapper {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      background: #202020;
    }
    
    /* UPDATED: Another lower specificity definition - should be overridden */
    .video-play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.4);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
      opacity: 1;
    }
    
    
    .video-play-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    /* Clean, simple play button */
    .video-play-button {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }
    
    
    /* Play triangle - Unicode Symbol (No Black Square Issues) */
    .video-play-button::after {
      content: '▶';
      font-size: 24px;
      color: #2d2d2d;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin-left: 3px;
      line-height: 1;
      text-shadow: none;
      -webkit-text-stroke: none;
      text-stroke: none;
      display: inline-block;
      width: auto;
      height: auto;
      border: none;
    }
    
    /* ================================
       CLEAN VIDEO PLAYER STYLES
       ================================ */
    
    /* Parent Container Protection - Prevent Flex/Grid Interference */
    /* FIXED: Professional video container - Merge essential properties without breaking positioning */
    .professional-video-container {
      /* Core layout properties */
      position: relative !important;
      display: block !important;
      width: 100% !important;
      max-width: 900px !important;
      margin: 0 auto 3rem !important;
      
      /* Background and visibility */
      background: transparent !important;
      background-color: transparent !important;
      opacity: 1 !important;
      visibility: visible !important;
      
      /* Shape and overflow */
      border-radius: 12px !important;
      overflow: hidden !important;
      
      /* Flex/grid protection */
      flex-shrink: 0 !important;
      flex-grow: 0 !important;
      align-self: stretch !important;
      justify-self: stretch !important;
    }
    
    /* Remove conflicting background styles - let the main definition handle it */
    
    /* FIXED: Allow video element to display poster properly */
    .main-video {
      /* Let browser handle video poster display naturally - no background override */
      object-fit: cover !important; /* Ensure video/poster fills container properly */
    }
    
    /* Don't add borders to text elements - but preserve overlay background */
    .professional-video-container p,
    .professional-video-container span,
    .professional-video-container button {
      border: none !important;
      box-shadow: none !important;
      background: transparent !important;
    }
    
    /* Allow video play overlay to maintain its dark background for visibility */
    .professional-video-container .video-play-overlay {
      border: none !important;
      box-shadow: none !important;
      /* Don't override background - let overlay styles handle it */
    }
    
    /* COMMENTED OUT - This CSS rule was causing height: 0 and breaking video display
    .professional-video-player {
      position: relative !important;
      width: 100% !important;
      max-width: 900px !important;
      height: 0 !important; 
      padding-top: 56.25% !important;
      margin: 0 auto !important;
      border-radius: 12px !important;
      overflow: hidden !important;
      background: #2a2a2a !important;
      border: 1px solid rgba(255, 255, 255, 0.1) !important;
    */
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important;
      
      /* Force exact dimensions - no browser/extension override */
      max-height: none !important;
      min-height: unset !important;
      flex-grow: 0 !important;
      flex-shrink: 0 !important;
      /* NUCLEAR override for aspect ratio conflicts */
      aspect-ratio: unset !important;
      display: block !important;
      box-sizing: border-box !important;
    }
    
    /* Main Video Element - Force Fill Container Completely */
    .professional-video-player .main-video,
    .main-video {
      /* POSITIONING - Force absolute positioning */
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      
      /* DIMENSIONS - Force exact container fill */
      width: 100% !important;
      height: 100% !important;
      min-width: 100% !important;
      min-height: 100% !important;
      max-width: none !important;
      max-height: none !important;
      
      /* OBJECT FIT - Force video to fill completely */
      object-fit: cover !important;
      object-position: center center !important;
      
      /* DISPLAY - Force block display */
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      
      /* STYLING */
      border-radius: 12px !important;
      /* Let browser handle video poster display naturally - no background override */
      
      /* STEP 3: Professional Poster Image Styling */
      object-fit: cover !important; /* Ensures poster maintains aspect ratio */
      
      /* LAYERING */
      z-index: 1 !important;
      
      /* PREVENT SHRINKING */
      flex-shrink: 0 !important;
      flex-grow: 0 !important;
      
      /* FORCE DIMENSIONS */
      box-sizing: border-box !important;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      outline: none !important;
    }
    
    /* FIXED: Maximum specificity permanent blur overlay */
    #professionalVideoPlayer .video-play-overlay,
    .professional-video-container .video-play-overlay,
    .video-play-overlay#videoPlayOverlay {
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      background: rgba(0, 0, 0, 0.4) !important;
      /* Cross-browser backdrop-filter support */
      -webkit-backdrop-filter: blur(12px) !important;
      -moz-backdrop-filter: blur(12px) !important;
      -ms-backdrop-filter: blur(12px) !important;
      backdrop-filter: blur(12px) !important;
      transition: all 0.3s ease !important;
      cursor: pointer !important;
      border-radius: 12px !important;
      z-index: 20 !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* CRITICAL: Override for hidden state - must hide overlay during video playback */
    #professionalVideoPlayer .video-play-overlay.hidden,
    .professional-video-container .video-play-overlay.hidden,
    .video-play-overlay#videoPlayOverlay.hidden {
      opacity: 0 !important;
      visibility: hidden !important;
      pointer-events: none !important;
      /* Keep backdrop-filter properties but make invisible */
      -webkit-backdrop-filter: blur(12px) !important;
      -moz-backdrop-filter: blur(12px) !important;
      -ms-backdrop-filter: blur(12px) !important;
      backdrop-filter: blur(12px) !important;
    }
    
    /* FALLBACK: For browsers that don't support backdrop-filter */
    @supports not (backdrop-filter: blur(12px)) {
      #professionalVideoPlayer .video-play-overlay::before,
      .professional-video-container .video-play-overlay::before,
      .video-play-overlay#videoPlayOverlay::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: inherit;
        background-size: cover;
        background-position: center;
        filter: blur(12px);
        z-index: -1;
      }
    }
    
    /* FIXED: Maximum specificity hover - maintain same appearance */
    #professionalVideoPlayer .video-play-overlay:hover,
    .professional-video-container .video-play-overlay:hover,
    .video-play-overlay#videoPlayOverlay:hover {
      background: rgba(0, 0, 0, 0.5) !important;
      -webkit-backdrop-filter: blur(12px) !important;
      -moz-backdrop-filter: blur(12px) !important;
      backdrop-filter: blur(12px) !important;
    }
    
    /* CRITICAL: Hidden state overrides hover - overlay must stay hidden during playback */
    #professionalVideoPlayer .video-play-overlay.hidden:hover,
    .professional-video-container .video-play-overlay.hidden:hover,
    .video-play-overlay#videoPlayOverlay.hidden:hover {
      opacity: 0 !important;
      visibility: hidden !important;
      pointer-events: none !important;
    }
    
    /* BULLETPROOF PLAY BUTTON - Simplified */
    .video-play-overlay .clean-play-button,
    .clean-play-button {
      /* DIMENSIONS - Force exact size */
      width: 72px !important;
      height: 72px !important;
      min-width: 72px !important;
      min-height: 72px !important;
      border-radius: 50% !important;
      
      /* BACKGROUND - Force white background */
      background: rgba(255, 255, 255, 0.95) !important;
      background-color: rgba(255, 255, 255, 0.95) !important;
      border: none !important;
      border-width: 0 !important;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2) !important;
      
      /* TEXT - Force dark text */
      font-size: 24px !important;
      color: #1a1a1a !important;
      font-weight: normal !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      line-height: 1 !important;
      
      /* LAYOUT - Force centering */
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      text-align: center !important;
      padding: 0 !important;
      padding-left: 3px !important; /* Optical centering for play symbol */
      margin: 0 !important;
      margin-bottom: 16px !important;
      
      /* INTERACTION */
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      
      /* ELIMINATE BLACK SQUARES - Nuclear option */
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      outline: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
      
      /* ADDITIONAL OVERRIDES */
      text-decoration: none !important;
      text-transform: none !important;
      letter-spacing: normal !important;
      word-spacing: normal !important;
      opacity: 1 !important;
      visibility: visible !important;
      display: flex !important;
      position: relative !important;
      z-index: 10 !important;
    }
    
    
    .video-play-overlay .clean-play-button:active,
    .clean-play-button:active {
      transform: scale(1.05) !important;
    }
    
    /* Video Info Caption */
    .video-info {
      text-align: center;
    }
    
    .video-caption {
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
      font-weight: 500;
      margin: 0;
      padding: 8px 16px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 20px;
      background: rgba(0, 0, 0, 0.8);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    /* Hide overlay when video is playing */
    .video-play-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* REMOVED: Lower specificity hover effect - replaced with higher specificity version above */

    
    /* Professional video controls */
    .main-video::-webkit-media-controls {
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .main-video:hover::-webkit-media-controls {
      opacity: 1;
    }
    
    /* Mobile responsive styles for clean video player */
    @media screen and (max-width: 768px) {
      .professional-video-player {
        max-width: 100%;
        margin: 0;
      }
      
      .clean-play-button {
        width: 60px;
        height: 60px;
        font-size: 20px;
      }
      
      .video-caption {
        font-size: 12px;
        padding: 6px 12px;
      }
    }
    
    /* PROFESSIONAL: Completely Hide All Native Video Controls */
    video::-webkit-media-controls,
    video::-webkit-media-controls-panel,
    video::-webkit-media-controls-play-button,
    video::-webkit-media-controls-start-playback-button,
    video::-webkit-media-controls-fullscreen-button,
    video::-webkit-media-controls-timeline,
    video::-webkit-media-controls-current-time-display,
    video::-webkit-media-controls-time-remaining-display,
    video::-webkit-media-controls-mute-button,
    video::-webkit-media-controls-volume-slider {
      display: none !important;
      opacity: 0 !important;
      visibility: hidden !important;
    }
    
    /* Ensure no native controls show on any state */
    video:hover::-webkit-media-controls-panel,
    video:focus::-webkit-media-controls-panel,
    video:active::-webkit-media-controls-panel {
      display: none !important;
      opacity: 0 !important;
    }
    
    /* All native controls are completely hidden - only custom controls visible */
    
    /* Firefox native controls - hide everything */
    video::-moz-media-controls,
    video::-moz-media-controls-panel {
      display: none !important;
      opacity: 0 !important;
      visibility: hidden !important;
    }
    
    /* iOS Safari - Additional enforcement */
    video {
      -webkit-appearance: none;
      appearance: none;
    }
    video:focus {
      outline: none;
    }
    
    /* General video element styling */
    video {
      /* Let browser handle video background/poster display naturally */
    }
    
    /* Loading spinner already defined earlier in the CSS */
    
    /* Calendar Section Styles */
    .calendar-section {
      margin: 3rem 0;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    /* Cal.com Confirmation Section */
    .cal-confirmation-section {
      margin: 2rem 0;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      border: 1px solid rgba(74, 222, 128, 0.2);
      text-align: center;
    }

    .confirmation-details {
      margin-top: 1.5rem;
    }

    .confirmation-icon {
      display: flex;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    .confirmation-icon svg {
      color: #4ade80;
      background: rgba(74, 222, 128, 0.1);
      padding: 12px;
      border-radius: 50%;
      width: 72px;
      height: 72px;
    }

    /* 2025 Minimal Typography Confirmation - Match Steps */
    .minimal-confirmation {
      text-align: center;
      padding: 1rem 0 2rem 0;
      font-family: General Sans, Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
    }

    /* Main Title - Match Step Headers */
    .minimal-title {
      color: var(--white);
      font-size: 2rem;
      font-weight: 600;
      margin: 0 0 1rem 0;
      line-height: 1.3;
      text-transform: uppercase;
      font-family: General Sans, Arial, sans-serif;
    }

    .minimal-subtitle {
      color: var(--grey);
      font-size: 1.1rem;
      font-weight: 400;
      margin: 0 0 2rem 0;
      line-height: 1.6;
      font-family: General Sans, Arial, sans-serif;
    }

    /* Clean Divider */
    .minimal-divider {
      width: 60px;
      height: 1px;
      background: var(--grey);
      margin: 0 auto 2rem auto;
      opacity: 0.3;
    }

    /* Professional Preparation Accordion - Based on FAQ Section */
    .prep-section {
      margin-top: 2rem;
      margin-bottom: 0;
      max-width: 900px; /* Desktop max-width */
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      padding: 0; /* Remove padding - let mobile breakpoints handle their own spacing */
    }

    .prep-title {
      color: var(--white);
      font-size: 1rem;
      font-weight: 500;
      margin: 0 0 1.5rem 0;
      font-family: General Sans, Arial, sans-serif;
      text-align: center;
    }

    .prep-accordion {
      max-width: 100%;
      margin: 0 auto;
      text-align: left;
    }

    .prep-item {
      margin-bottom: 0;
      background: transparent;
      border: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
      transition: background-color 0.2s ease;
    }

    .prep-item:first-child {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .prep-question {
      padding: 1.5rem 0;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgba(255, 255, 255, 0.9);
      font-size: 1rem;
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.3;
      transition: color 0.2s ease;
      font-family: General Sans, Arial, sans-serif;
    }

    .prep-question:hover {
      color: rgba(255, 255, 255, 1);
    }

    .prep-toggle {
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.4);
      transition: transform 0.25s ease-out, color 0.2s ease;
      line-height: 1;
      font-weight: 300;
      transform-origin: center center;
      will-change: transform;
    }

    .prep-item:hover .prep-toggle {
      color: rgba(255, 255, 255, 0.6);
    }

    .prep-item.active .prep-question {
      color: #fff;
    }

    .prep-item.active .prep-toggle {
      color: #fff;
      transform: rotate(45deg);
    }

    .prep-answer {
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 0.25s ease-out;
      color: rgba(255, 255, 255, 0.6);
      line-height: 1.6;
      font-size: 0.95rem;
      margin: 0;
      padding: 0;
    }

    .prep-answer-content {
      overflow: hidden;
      min-height: 0;
      padding: 0;
      margin: 0;
      opacity: 0;
      transform: scale(0.98);
      transition: opacity 0.25s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .prep-item.active .prep-answer {
      grid-template-rows: 1fr;
    }

    .prep-item.active .prep-answer-content {
      padding: 0 0 1.5rem 0;
      opacity: 1;
      transform: scale(1);
    }

    .prep-answer p {
      margin: 0;
      font-family: General Sans, Arial, sans-serif;
    }

    /* Email Link - Match Footer Style */
    .minimal-contact {
      margin-top: 2rem;
      text-align: center;
    }
    
    .minimal-contact .link-button {
      display: inline-block !important;
      width: auto !important;
    }

    /* MAXIMUM SPECIFICITY: Show underline by default, animate to right and disappear on hover */
    body .minimal-contact .link-button .underline,
    body .minimal-contact .link-button .underline.is-nav,
    body .minimal-contact a.link-button .underline,
    body .minimal-contact a.link-button .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8) !important;
      width: 100% !important;
      height: 1px !important;
      margin-top: 3px !important;
      transform: scaleX(1) !important;
      transform-origin: left !important;
      transition: transform 0.3s ease !important;
      display: block !important;
      -webkit-transform: scaleX(1) !important;
      -moz-transform: scaleX(1) !important;
      -ms-transform: scaleX(1) !important;
    }
    
    body .minimal-contact .link-button .underline.is-nav,
    body .minimal-contact a.link-button .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8) !important;
    }
    
    body .minimal-contact .link-button:hover .underline,
    body .minimal-contact .link-button:hover .underline.is-nav,
    body .minimal-contact a.link-button:hover .underline,
    body .minimal-contact a.link-button:hover .underline.is-nav {
      transform: scaleX(0) !important;
      transform-origin: right !important;
      -webkit-transform: scaleX(0) !important;
      -moz-transform: scaleX(0) !important;
      -ms-transform: scaleX(0) !important;
    }


    /* Mobile Responsive - Match Steps */
    @media (max-width: 991px) {
      .minimal-confirmation {
        padding: 2rem 0 1.5rem 0;
      }

      .minimal-title {
        font-size: 1.8rem;
      }

      .minimal-subtitle {
        font-size: 1rem;
      }

      .minimal-section-title {
        font-size: 1.1rem;
      }
    }

    @media (max-width: 767px) {
      .minimal-confirmation {
        padding: 1.5rem 1rem;
        text-align: center;
      }
      
      /* FIXED: Make accordion inherit natural container width like title/subtitle */
      .prep-section {
        margin-top: 2rem;
        margin-bottom: 0;
        /* Remove width constraints - let it use full container width like title/subtitle */
      }

      .minimal-title {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }

      .minimal-subtitle {
        font-size: 1rem;
        margin-bottom: 1.5rem;
      }

      .prep-section {
        /* Basic mobile overrides, viewport breakout handled in specific breakpoints */
        max-width: none;
        margin-top: 2rem;
      }

      .prep-title {
        font-size: 0.95rem;
        margin-bottom: 1.125rem;
      }

      .prep-question {
        padding: 1.25rem 0; /* Balanced vertical spacing */
        font-size: 0.9rem; /* Slightly smaller for better text fitting */
        line-height: 1.35; /* Optimized for multi-line consistency */
        letter-spacing: -0.01em; /* Subtle tighter spacing for more text */
      }

      .prep-answer {
        font-size: 0.9rem;
        line-height: 1.5; /* Improved mobile readability */
      }

      .prep-item.active .prep-answer-content {
        padding: 0 0 1.25rem 0; /* Match question vertical spacing for visual balance */
      }

      .prep-list {
        max-width: 100%;
      }

      .minimal-divider {
        margin: 0 auto 1.5rem auto;
      }
    }

    @media (max-width: 479px) {
      .minimal-title {
        font-size: 1.3rem;
      }

      .minimal-subtitle {
        font-size: 0.95rem;
      }

      .prep-title {
        font-size: 0.9rem;
      }

      .prep-section {
        margin-top: 2rem;
        margin-bottom: 0;
        /* Remove width constraints - let it use full container width like title/subtitle */
      }

      .prep-question {
        padding: 1.125rem 0; /* Balanced vertical spacing */
        font-size: 0.85rem; /* Optimized for very small screens and text fitting */
        line-height: 1.32; /* Tight but readable for multi-line consistency */
        letter-spacing: -0.005em; /* Subtle spacing optimization */
      }

      .prep-answer {
        font-size: 0.85rem;
        line-height: 1.45; /* Better small screen readability */
      }

      .prep-item.active .prep-answer-content {
        padding: 0 0 1.125rem 0; /* Match question vertical spacing for visual balance */
      }
    }

    .confirmation-text {
      font-size: 1.1rem;
      color: var(--white);
      line-height: 1.6;
      margin-bottom: 2rem;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .next-steps {
      text-align: left;
      background: rgba(255, 255, 255, 0.02);
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      max-width: 400px;
      margin: 0 auto;
    }

    .next-steps h4 {
      color: var(--white);
      margin-bottom: 1rem;
      font-size: 1rem;
      font-weight: 600;
    }

    .next-steps ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .next-steps li {
      color: rgba(255, 255, 255, 0.8);
      padding: 0.5rem 0;
      font-size: 0.95rem;
      line-height: 1.4;
      position: relative;
      padding-left: 1.5rem;
    }

    .next-steps li:before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #4ade80;
      font-weight: bold;
    }
    
    .calendar-section h3 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--white);
      text-align: center;
    }
    
    .calendar-subtext {
      text-align: center;
      color: var(--grey);
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
    }
    
    /* Premium Calendar Buttons Grid */
    .calendar-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .calendar-buttons-grid {
      display: grid !important;
      grid-template-columns: repeat(4, 1fr) !important;
      gap: 0.75rem !important;
      max-width: 600px !important;
      margin: 0 auto !important;
    }
    
    .calendar-button, .calendar-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      padding: 0.75rem 1rem;
      background: rgba(255, 255, 255, 0.08) !important;
      backdrop-filter: blur(6px) !important;
      -webkit-backdrop-filter: blur(6px) !important;
      color: rgba(255, 255, 255, 0.9) !important;
      text-decoration: none;
      border: none !important;
      border-radius: 6px !important;
      font-weight: 500;
      font-size: 0.85rem !important;
      transition: all 0.3s ease;
      cursor: pointer;
      font-family: 'General Sans', -apple-system, sans-serif;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
    }
    
    /* DESKTOP/TABLET: Fix black box behind text labels */
    .calendar-button span, .calendar-btn span {
      background: transparent !important;
      background-color: transparent !important;
      background-image: none !important;
      padding: 0 !important;
      margin: 0 !important;
      display: inline !important;
      color: inherit !important;
      border: none !important;
      box-shadow: none !important;
    }
    
    .calendar-button:hover, .calendar-btn:hover {
      background: rgba(255, 255, 255, 0.12) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      color: rgba(255, 255, 255, 1) !important;
      transition: all 0.2s ease !important;
    }
    
    /* Subtle icon brightness on hover */
    .calendar-button:hover svg g, .calendar-btn:hover svg g {
      fill: #ffffff !important;
      opacity: 1 !important;
    }
    
    .calendar-button svg, .calendar-btn svg {
      width: 18px;
      height: 18px;
      flex-shrink: 0;
      /* FIXED: Allow inline style to override for proper color */
      /* Removed color: transparent to let SVG inline style work */
    }
    
    /* REMOVED: This was forcing fill on ALL paths and circles, causing black squares
    .calendar-button svg path, .calendar-btn svg path,
    .calendar-button svg circle, .calendar-btn svg circle {
      fill: #0f0f0f !important;
    }
    */
    
    /* CRITICAL: Override loading state to ensure calendar buttons are always visible */
    body.confirmation-loading .calendar-buttons-section,
    body.confirmation-loading .calendar-buttons-grid,
    body.confirmation-loading .calendar-btn {
      opacity: 1 !important;
      pointer-events: auto !important;
      visibility: visible !important;
    }
    
    /* MOBILE: Icon-only circular buttons in horizontal row (≤480px) */
    @media (max-width: 480px) {
      .calendar-buttons-grid {
        /* Horizontal row layout for 4 buttons */
        display: flex !important;
        flex-direction: row !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 1rem !important;
        max-width: 280px !important;
        margin: 0 auto !important;
      }
      
      .calendar-button, .calendar-btn {
        /* Circular icon-only buttons */
        width: 44px !important;
        height: 44px !important;
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 0 !important;
        border-radius: 50% !important;
        
        /* Subtle glass effect - not overpowering */
        background: rgba(255, 255, 255, 0.08) !important;
        backdrop-filter: blur(6px) !important;
        -webkit-backdrop-filter: blur(6px) !important;
        border: none !important;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
        
        /* Center icon perfectly */
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        
        /* Remove text - hide spans */
        font-size: 0 !important;
        overflow: hidden !important;
      }
      
      .calendar-button:hover, .calendar-btn:hover {
        background: rgba(255, 255, 255, 0.12) !important;
        backdrop-filter: blur(8px) !important;
        -webkit-backdrop-filter: blur(8px) !important;
        transform: scale(1.05) !important;
        transition: all 0.2s ease !important;
      }
      
      /* Hide text on mobile - show only icons */
      .calendar-button span, .calendar-btn span {
        display: none !important;
      }
      
      /* Ensure SVG icons are visible and properly sized */
      .calendar-button svg, .calendar-btn svg {
        width: 20px !important;
        height: 20px !important;
        min-width: 20px !important;
        min-height: 20px !important;
        display: block !important;
        flex-shrink: 0 !important;
      }
    }
    
    /* MEDIUM SCREENS: Fix center alignment (480px-768px) */
    @media (min-width: 480px) and (max-width: 768px) {
      .calendar-buttons-grid {
        /* 2x2 grid with proper center alignment */
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        gap: 1rem !important;
        max-width: 400px !important;
        margin: 0 auto !important;
      }
      
      .calendar-button, .calendar-btn {
        /* Fix left-alignment issue */
        justify-content: center !important;
        text-align: center !important;
        padding: 0.875rem 1rem !important;
        font-size: 0.9rem !important;
        width: 100% !important;
      }
    }
    
    /* TABLET: Slight improvements for larger screens */
    @media (min-width: 768px) and (max-width: 1024px) {
      .calendar-button, .calendar-btn {
        font-size: 0.9rem !important;
        justify-content: center !important;
      }
    }
    
    /* PROFESSIONAL: Ensure SVG icons render properly */
    .calendar-btn svg,
    .calendar-button svg {
      display: inline-block !important;
      width: 18px !important;
      height: 18px !important;
      min-width: 18px !important;
      min-height: 18px !important;
      max-width: 18px !important;
      max-height: 18px !important;
      flex-shrink: 0 !important;
      pointer-events: none !important;
    }
    
    /* DISABLED: Conflicting CSS rules - using inline styles instead
    .calendar-btn svg path,
    .calendar-btn svg circle,
    .calendar-btn svg rect,
    .calendar-button svg path,
    .calendar-button svg circle,
    .calendar-button svg rect {
      stroke: currentColor !important;
      fill: none !important;
      vector-effect: non-scaling-stroke !important;
    }
    */
    
    /* DISABLED: Conflicting CSS rules - using inline styles instead
    .calendar-btn svg[fill="none"] path,
    .calendar-btn svg[fill="none"] circle,
    .calendar-btn svg[fill="none"] rect,
    .calendar-button svg[fill="none"] path,
    .calendar-button svg[fill="none"] circle,
    .calendar-button svg[fill="none"] rect {
      fill: none !important;
      stroke: currentColor !important;
      stroke-width: 2 !important;
    }
    */
    
    /* SPECIFIC: Handle filled elements (like Apple icon dot) */
    .calendar-btn svg circle[fill="#0f0f0f"],
    .calendar-button svg circle[fill="#0f0f0f"] {
      fill: #0f0f0f !important;
      stroke: none !important;
    }
    
    /* AI Assistant Section */
    .ai-assistant-section {
      margin: 3rem 0;
      padding: 2.5rem;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .ai-assistant-section::before {
      /* DISABLED: Vignette effect causing dark shadows around video */
      display: none;
      /*
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
      animation: pulse 4s ease-in-out infinite;
      */
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }
    
    .ai-assistant-section h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--white);
      position: relative;
      z-index: 1;
    }
    
    .ai-description {
      color: var(--grey);
      margin-bottom: 2rem;
      font-size: 1rem;
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }
    
    .ai-discovery-button {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--white);
      color: var(--primary-black);
      text-decoration: none;
      border: 2px solid var(--white);
      border-radius: 0;
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      z-index: 1;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .ai-discovery-button:hover {
      background: transparent;
      color: var(--white);
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(255, 255, 255, 0.2);
    }
    
    /* Cal.com Calendar Section */
    .cal-calendar-section {
      margin: 0.5rem 0 1rem 0;
      text-align: center;
    }
    
    .cal-calendar-section h3 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--white);
    }
    
    /* Enhanced confirmation wrapper */
    .enhanced-confirmation {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }
    
    /* CRITICAL: Hide Cal.com embed when confirmation page is active */
    .enhanced-confirmation ~ #my-cal-inline-30min,
    .calendar-container:has(.enhanced-confirmation) #my-cal-inline-30min {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
    }
    
    /* CSS hiding rules removed - we now replace content entirely instead of hiding it */
    
    /* SURGICAL CURSOR FIX - Maximum specificity for phone input */
    input#phoneInput[type="tel"],
    div#phoneComponentContainer input#phoneInput[type="tel"],
    div#phoneFormContainer input#phoneInput[type="tel"],
    .enhanced-confirmation input#phoneInput[type="tel"] {
      cursor: text !important;
    }
    
    input#phoneInput[type="tel"]:hover,
    div#phoneComponentContainer input#phoneInput[type="tel"]:hover,
    div#phoneFormContainer input#phoneInput[type="tel"]:hover,
    .enhanced-confirmation input#phoneInput[type="tel"]:hover,
    /* Remove ALL browser default styling for phone input */
    input#phoneInput[type="tel"] {
      outline: none !important;
      border: 1px solid rgba(255, 255, 255, 0.1) !important;
      background: rgba(255, 255, 255, 0.05) !important;
      box-shadow: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    
    input#phoneInput[type="tel"]:focus,
    div#phoneComponentContainer input#phoneInput[type="tel"]:focus,
    div#phoneFormContainer input#phoneInput[type="tel"]:focus,
    .enhanced-confirmation input#phoneInput[type="tel"]:focus {
      cursor: text !important;
      outline: none !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      background: rgba(255, 255, 255, 0.15) !important;
      box-shadow: none !important;
    }
    
    /* Override for full-width confirmation display when created dynamically */
    .enhanced-confirmation[style*="max-width: none"] {
      max-width: none !important;
      width: 100% !important;
      margin: 0 !important;
    }
    
    /* Confirmation page-specific styles for seamless integration */
    .calendly-embed-container.confirmation-page {
      height: auto !important;
      min-height: 1200px !important;
      overflow: visible !important;
      background: transparent !important;
      border: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      padding: 0 !important;
      margin: 0 !important;
    }
    
    /* Professional container setup */
    .calendar-container {
      min-height: 100vh;
      height: auto;
      position: relative;
    }
    
    .calendly-embed-container.confirmation-page .calendly-inline-widget {
      width: 100%;
      height: auto;
      position: relative;
    }
    
    /* Ensure iframe can expand naturally */
    #my-cal-inline-30min.iframe-container {
      width: 100%;
      position: relative;
      overflow: visible;
    }
    
    /* Remove all scroll indicators on confirmation page */
    .calendly-embed-container.confirmation-page::before,
    .calendly-embed-container.confirmation-page::after {
      display: none !important;
      content: none !important;
    }
    
    /* Remove scrollbar styling on confirmation */
    .calendly-embed-container.confirmation-page::-webkit-scrollbar {
      display: none !important;
    }
    
    .calendly-embed-container.confirmation-page .calendly-inline-widget,
    .calendly-embed-container.confirmation-page #my-cal-inline-30min {
      height: auto !important;
      min-height: 600px !important;
      overflow: visible !important;
    }
    
    /* Simple confirmation page solution */
    .calendly-embed-container.confirmation-page {
      width: 100%;
      height: auto;
      min-height: 100vh;
      position: relative;
      background: transparent;
      border: none;
      overflow: visible;
    }
    
    /* Desktop/Laptop: Dynamic height based on content */
    @media screen and (min-width: 769px) {
      .calendly-embed-container.confirmation-page iframe {
        width: 100%;
        height: auto;
        min-height: 600px; /* Minimum while loading */
        border: none;
        display: block;
      }
    }
    
    /* Mobile: Fixed height to prevent excess space */
    @media screen and (max-width: 768px) {
      .calendly-embed-container.confirmation-page iframe {
        width: 100%;
        height: 1000px !important;
        min-height: 1000px !important;
        max-height: 1000px !important;
        border: none;
      }
    }
    
    /* iPad specific adjustment */
    @media screen and (min-width: 769px) and (max-width: 1024px) {
      .calendly-embed-container.confirmation-page iframe {
        height: auto;
        min-height: 600px; /* Minimum while loading */
      }
    }
    
    /* Premium Responsive Styles */
    @media screen and (min-width: 1024px) {
      .calendar-buttons-grid {
        grid-template-columns: repeat(4, 1fr) !important;
        gap: 0.75rem !important;
        max-width: 600px !important;
      }
    }
    
    @media screen and (max-width: 1023px) {
      .calendar-buttons, .calendar-buttons-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.875rem !important;
        max-width: 420px !important;
      }
      
      .calendar-button, .calendar-btn {
        padding: 0.875rem 1.25rem !important;
      }
    }
    
    @media screen and (max-width: 768px) {
      .calendar-buttons, .calendar-buttons-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.75rem !important;
        max-width: 100% !important;
      }
      
      .calendar-button, .calendar-btn {
        padding: 0.75rem 1rem !important;
        font-size: 0.85rem !important;
      }
    }
    
    @media screen and (max-width: 480px) {
      .calendar-buttons, .calendar-buttons-grid {
        grid-template-columns: 1fr !important;
        gap: 0.75rem !important;
      }
      
      .calendar-button, .calendar-btn {
        width: 100% !important;
        justify-content: center !important;
      }
    }
      
      .ai-assistant-section {
        padding: 2rem 1.5rem;
      }
      
      .ai-description br {
        display: none;
      }
      
    }
    
    
    /* Tablet-specific styles (iPad Mini, etc) */
    @media screen and (min-width: 480px) and (max-width: 768px) {
      .calendar-header {
        padding: 2rem 0 1rem 0;
      }
      
      .calendar-header h1 {
        font-size: 2rem;
      }
      
      .calendar-container {
        padding: 0 1rem 2rem 1rem;
      }
      
      .personalized-message {
        padding: 0.75rem 0 1.5rem 0;
      }
      
      .personalized-text {
        font-size: 1rem;
      }
      
      .calendar-divider {
        width: 80px;
        margin-bottom: 0.375rem;
      }
      
      .progress-steps {
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .progress-indicator .progress-steps .step-divider {
        width: 35px !important;
        max-width: 35px !important;
        height: 2px !important;
        background: rgba(255, 255, 255, 0.3) !important;
        opacity: 1 !important;
        flex: 0 0 35px !important;
        align-self: flex-start !important;
        margin-top: 11px !important;
        margin-left: 12px !important;
        margin-right: 12px !important;
      }
      
      /* Scrollable container for tablets - same as mobile */
      .calendly-embed-container {
        height: 800px; /* Fixed viewport height */
        padding: 0;
        margin: 0;
        overflow-y: auto;
        overflow-x: hidden;
        position: relative;
        background: rgba(15, 15, 15, 0.5);
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
        /* Container boundaries */
        border: 1px solid rgba(180, 180, 180, 0.15);
        border-radius: 8px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1), 
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      
      /* Scroll indicators for tablets */
      .calendly-embed-container::after {
        content: '';
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 0 0 8px 8px;
      }
      
      .calendly-embed-container::before {
        content: '';
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to top, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 8px 8px 0 0;
      }
      
      .calendly-embed-container.has-scroll-bottom::after {
        opacity: 1;
      }
      
      .calendly-embed-container.has-scroll-top::before {
        opacity: 1;
      }
      
      /* Styled scrollbar for tablets */
      .calendly-embed-container::-webkit-scrollbar {
        width: 6px;
        background: transparent;
      }
      
      .calendly-embed-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        transition: background 0.2s ease;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      
      .calendly-embed-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.05);
      }
      
      .calendly-inline-widget {
        height: auto;
        position: relative;
        overflow: visible;
      }
      
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        width: 100% !important;
        height: 2000px !important; /* Increased to accommodate full day schedules */
        border: 0 !important;
        display: block;
        position: relative;
        border-radius: 8px;
      }
      
      .loading-container {
        height: 580px;
      }
      
      #my-cal-inline-30min {
        height: auto;
        overflow: visible;
        position: relative;
      }
    }
    
    @media screen and (max-width: 479px) {
      /* Ensure page scrolling on mobile */
      html, body {
        overflow-x: hidden;
        overflow-y: auto;
        height: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      .page-wrapper {
        min-height: 100vh;
        height: auto;
        overflow: visible;
      }
      
      /* Reduce vertical spacing for more calendar room */
      .calendar-header {
        padding: 1.5rem 1.25rem 0.75rem 1.25rem; /* Less top/bottom padding */
      }
      
      .calendar-header h1 {
        font-size: 1.8rem;
      }
      
      .progress-indicator {
        padding: 0.5rem 0; /* Reduced vertical padding */
      }
      
      /* Smaller progress elements on mobile */
      .progress-steps {
        gap: 0.5rem; /* Tighter spacing */
        align-items: center;
        flex-direction: row; /* Keep horizontal on mobile */
      }
      
      .step-circle {
        width: 20px; /* Reduced from 24px */
        height: 20px;
        font-size: 0.7rem; /* Smaller font */
      }
      
      .step-text {
        font-size: 0.8rem; /* Reduced from 0.9rem */
      }
      
      .progress-indicator .progress-steps .step-divider {
        width: 30px !important;
        max-width: 30px !important;
        height: 2px !important;
        background: rgba(255, 255, 255, 0.3) !important;
        opacity: 1 !important;
        flex: 0 0 30px !important;
        align-self: flex-start !important;
        margin-top: 9px !important; /* Smaller circles need less margin */
        margin-left: 10px !important;
        margin-right: 10px !important;
      }
      
      .calendar-container {
        padding: 0 1rem 2rem 1rem; /* Add horizontal padding for proper spacing */
      }
      
      .personalized-message {
        padding: 0.5rem 1.25rem 1rem 1.25rem; /* Reduced vertical padding */
      }
      
      .personalized-text {
        font-size: 0.95rem;
      }
      
      .calendar-divider {
        width: 60px;
      }
      
      /* Refined scrollable container solution */
      .calendly-embed-container {
        height: 800px; /* Reasonable viewport height */
        padding: 0;
        margin: 0; /* Remove margin to prevent alignment issues */
        overflow-y: auto; /* Enable vertical scrolling */
        overflow-x: hidden;
        position: relative;
        background: rgba(15, 15, 15, 0.5); /* Subtle background */
        -webkit-overflow-scrolling: touch; /* Smooth iOS scrolling */
        scroll-behavior: smooth;
        /* Define container boundaries */
        border: 1px solid rgba(180, 180, 180, 0.15);
        border-radius: 8px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1), 
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      
      /* Bottom scroll indicator gradient */
      .calendly-embed-container::after {
        content: '';
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 0 0 8px 8px;
      }
      
      /* Top scroll indicator gradient */
      .calendly-embed-container::before {
        content: '';
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to top, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 8px 8px 0 0;
      }
      
      /* Show gradients based on scroll position */
      .calendly-embed-container.has-scroll-bottom::after {
        opacity: 1;
      }
      
      .calendly-embed-container.has-scroll-top::before {
        opacity: 1;
      }
      
      /* End of content indicator */
      .scroll-end-indicator {
        display: none;
        text-align: center;
        padding: 1rem;
        color: rgba(180, 180, 180, 0.6);
        font-size: 0.85rem;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.9));
        pointer-events: none;
      }
      
      .calendly-embed-container.at-bottom .scroll-end-indicator {
        display: block;
      }
      
      .calendly-inline-widget {
        height: auto;
        position: relative;
        overflow: visible;
      }
      
      /* Keep iframe tall to show all content */
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        width: 100% !important;
        height: 1600px !important; /* Increased to accommodate full day schedules */
        border: 0 !important;
        display: block;
        position: relative;
        border-radius: 8px; /* Match container radius */
      }
      
      #my-cal-inline-30min {
        height: auto;
        overflow: visible;
        position: relative;
      }
      
      .loading-container {
        height: 600px;
      }
      
      /* Styled scrollbar for better UX */
      .calendly-embed-container::-webkit-scrollbar {
        width: 6px;
        background: transparent;
      }
      
      .calendly-embed-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        transition: background 0.2s ease;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      
      /* Firefox scrollbar styling */
      .calendly-embed-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.05);
      }
      
      /* Confirmation page mobile styles - Match homepage responsive */
      .confirmation-container {
        padding: 4rem 1.25rem;
      }
      
      .confirmation-success-badge {
        font-size: 0.8rem;
        padding: 0.625rem 1.25rem;
      }
      
      .confirmation-heading {
        font-size: clamp(2rem, 8vw, 2.5rem);
        line-height: 1.2;
      }
      
      .confirmation-tagline {
        font-size: 1.1rem;
      }
      
      .confirmation-message {
        font-size: 1rem;
      }
      
      .confirmation-button {
        font-size: 12px;
        padding: 0.875rem 2.5rem;
      }
    }
    
    
    /* Desktop styles */
    @media screen and (min-width: 769px) {
      /* Fix Cal.com embed height on desktop - show full content */
      #my-cal-inline-30min {
        min-height: 700px;
        height: auto;
      }
      
      .calendly-inline-widget {
        min-height: 700px;
        height: auto;
      }
      
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 700px !important; /* Taller height for desktop to show full calendar */
        min-height: 700px !important;
      }
      
      /* Ensure scrollable container doesn't add scrollbars on desktop */
      .calendly-embed-container {
        height: auto !important;
        overflow: visible !important;
      }
      
      /* Reduce spacing for single-screen view */
      .confirmation-video {
        margin: 2rem 0;
      }
      
      .ai-assistant-section {
        margin: 2rem 0;
      }
      
      .cal-calendar-section {
        margin: 1.5rem 0 1rem 0;
      }
    }
    
    /* Laptop screens (smaller desktops) */
    @media screen and (min-width: 1024px) and (max-width: 1440px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 650px !important; /* Slightly shorter for laptops */
        min-height: 650px !important;
      }
      
      #my-cal-inline-30min {
        min-height: 650px;
      }
      
      .calendly-inline-widget {
        min-height: 650px;
      }
    }
    
    /* Large desktop screens */
    @media screen and (min-width: 1441px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 750px !important; /* Even taller for large screens */
        min-height: 750px !important;
      }
      
      #my-cal-inline-30min {
        min-height: 750px;
      }
      
      .calendly-inline-widget {
        min-height: 750px;
      }
    }
    
    /* For very small screens (iPhone SE, etc) */
    @media screen and (max-width: 375px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 1100px !important; /* Slightly less for smaller screens */
      }
      
      /* Restored progress indicator text */
      .step-text {
        font-size: 0.8rem;
        color: var(--grey);
      }
      
      .progress-indicator .progress-steps .step-divider {
        width: 25px !important;
        max-width: 25px !important;
        height: 2px !important;
        background: rgba(255, 255, 255, 0.3) !important;
        opacity: 1 !important;
        flex: 0 0 25px !important;
        align-self: flex-start !important;
        margin-top: 9px !important;
        margin-left: 8px !important;
        margin-right: 8px !important;
      }
      
      .progress-steps {
        gap: 0.25rem; /* Minimal spacing */
      }
    }
    
    /* Mobile confirmation page overrides */
    @media screen and (max-width: 768px) {
      .calendly-embed-container.confirmation-page {
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
        border-radius: 0 !important;
      }
      
      .calendly-embed-container.confirmation-page::before,
      .calendly-embed-container.confirmation-page::after {
        display: none !important;
      }
      
      .calendly-embed-container.confirmation-page iframe {
        border-radius: 0 !important;
      }
    }
    
    /* Larger screens optimization */
    @media screen and (min-width: 1280px) {
      .calendly-embed-container {
        max-width: 100%;
      }
      
      .calendar-container {
        max-width: 1800px;
      }
    }
    
    /* AI Discovery Section Styles - Premium Dark Design */
    .ai-discovery-section {
      padding: 4rem 2rem; /* Reduced from 8rem for single-page flow */
      background-color: var(--primary-black);
      position: relative;
      overflow: hidden;
      display: block;
      visibility: visible;
      opacity: 1;
      min-height: 200px;
    }
    
    
    .ai-discovery-container {
      max-width: 1000px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    
    .ai-discovery-heading {
      font-size: 2rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.75rem;
      line-height: 1.2;
      letter-spacing: -0.02em;
      text-align: center;
      display: block;
      visibility: visible;
    }
    
    .ai-discovery-subheading {
      font-size: 1.125rem;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 1.5rem;
      line-height: 1.4;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }
    
    
    /* 3-Step Progress Indicator - Vercel/Apple Style */
    .progress-steps {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 2rem 0 3rem 0;
      padding: 0 1rem;
      gap: 0; /* Manual spacing control */
    }
    
    .progress-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      opacity: 0.4;
      transition: opacity 0.3s ease;
    }
    
    .progress-step.active {
      opacity: 1;
    }
    
    .progress-step:has(.step-circle.completed) {
      opacity: 1; /* Make completed steps fully visible */
    }
    
    .progress-step-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.6);
      transition: all 0.3s ease;
    }
    
    .progress-step.active .progress-step-circle {
      background: var(--white);
      border-color: var(--white);
      color: var(--primary-black);
    }
    
    .progress-step-label {
      font-size: 0.75rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
      white-space: nowrap;
    }
    
    .progress-step.active .progress-step-label {
      color: rgba(255, 255, 255, 0.9);
    }
    
    .progress-step-connector {
      width: 60px;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 0 1rem;
    }
    
    @media (max-width: 768px) {
      .progress-steps {
        margin: 1.5rem 0 2rem 0;
      }
      
      .progress-step-connector {
        width: 40px;
        margin: 0 0.5rem;
      }
      
      .progress-step-label {
        font-size: 0.7rem;
      }
      
      .progress-step-circle {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
      }
    }

    /* Step Indicators for Visual Hierarchy */
    .step-indicator {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 2rem;
      justify-content: center;
    }
    
    .step-number-badge {
      width: 32px;
      height: 32px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
      flex-shrink: 0;
    }
    
    .step-indicator h2,
    .step-indicator h3 {
      margin: 0;
      font-size: 1.375rem !important;
      font-weight: 600;
      color: var(--white);
      letter-spacing: -0.01em;
    }
    
    /* Recommended Label */
    .recommended-label {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 1rem;
      text-align: center;
    }
    
    /* MAXIMUM SPECIFICITY: Phone Button - Bulletproof White Button */
    body .phone-form-container .ai-discovery-cta,
    body .phone-form-container button.ai-discovery-cta,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta,
    body .phone-form-container #submitPhoneButton,
    body button#submitPhoneButton.ai-discovery-cta,
    body #submitPhoneButton {
      display: inline-block !important;
      visibility: visible !important;
      margin: 1.5rem auto 0 !important;
      padding: 1.25rem 2rem !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      color: #1a1a1a !important;
      text-decoration: none !important;
      border: 2px solid rgba(255, 255, 255, 0.3) !important;
      border-radius: 12px !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: 'General Sans', -apple-system, sans-serif !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      cursor: pointer !important;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
      opacity: 1 !important;
      transform: translateY(0) scale(1) !important;
      position: relative !important;
      text-align: center !important;
      backdrop-filter: none !important;
      width: auto !important;
      min-width: 280px !important;
      max-width: 400px !important;
      outline: none !important;
      -webkit-appearance: none !important;
      appearance: none !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
      line-height: 1 !important;
      white-space: nowrap !important;
      overflow: visible !important;
      outline: none !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
      min-width: auto !important;
    }
    
    /* MAXIMUM SPECIFICITY: Phone Button States */
    body .phone-form-container .ai-discovery-cta:hover,
    body .phone-form-container button.ai-discovery-cta:hover,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:hover,
    body .phone-form-container .ai-discovery-cta:focus,
    body .phone-form-container button.ai-discovery-cta:focus,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:focus,
    body .phone-form-container .ai-discovery-cta:active,
    body .phone-form-container button.ai-discovery-cta:active,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:active,
    body #submitPhoneButton:hover,
    body #submitPhoneButton:focus,
    body #submitPhoneButton:active {
      color: #1a1a1a !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border-color: rgba(255, 255, 255, 0.5) !important;
      transform: translateY(-1px) scale(1) !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
      outline: none !important;
      -webkit-text-stroke: none !important;
      text-stroke: none !important;
    }
    
    /* Progressive Disclosure States */
    .ai-discovery-cta.transitioning {
      transform: translateY(-10px) scale(0.9) !important;
      opacity: 0.7 !important;
      pointer-events: none !important;
    }
    
    .ai-discovery-cta.hidden-smooth {
      transform: translateY(-20px) scale(0.8) !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    .ai-discovery-cta .button-content {
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 3px !important;
      color: inherit !important;
      width: 100% !important;
      height: auto !important;
    }

    /* MAXIMUM SPECIFICITY: Phone Button Text - Force Dark Text */
    body .phone-form-container .ai-discovery-cta .button-content span,
    body .phone-form-container button.ai-discovery-cta .button-content span,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta .button-content span,
    body .phone-form-container .ai-discovery-cta span,
    body .phone-form-container button.ai-discovery-cta span,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta span,
    body .phone-form-container #submitPhoneButton span,
    body .phone-form-container #submitPhoneButton .button-content span,
    body #submitPhoneButton span,
    body #submitPhoneButton .button-content span,
    body button#submitPhoneButton span,
    html body .phone-form-container #submitPhoneButton,
    html body #submitPhoneButton,
    html body button#submitPhoneButton {
      color: #1a1a1a !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      opacity: 1 !important;
      display: inline-block !important;
      visibility: visible !important;
      text-shadow: none !important;
      white-space: nowrap !important;
      line-height: 1.2 !important;
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      outline: none !important;
      user-select: none !important;
      -webkit-user-select: none !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
      text-decoration: none !important;
    }
    
    /* Hide underline effect for professional button */
    .ai-discovery-cta .button-underline {
      display: none !important;
    }
    
    .ai-discovery-cta .phone-icon {
      display: none !important; /* Hide icon for clean main site aesthetic */
    }
    
    /* Supporting text styling - Clean minimal design */
    .ai-supporting-text {
      color: var(--grey);
      font-size: 0.95rem;
      line-height: 1.6;
      margin: 1rem auto; /* Center with auto margins for professional desktop width */
      max-width: 600px; /* Professional width constraint for desktop */
      padding: 0; /* Remove padding for cleaner look */
      background: transparent; /* Remove background */
      border: none; /* Remove left border */
      position: relative;
      text-align: center; /* Center align for better mobile balance */
    }
    
    .ai-supporting-text strong {
      color: var(--white);
      font-weight: 600;
    }
    
    .button-text-block.bigger {
      height: 1.4rem;
    }
    
    /* Professional Phone Form - Progressive Disclosure */
    /* AI CTA Container for In-Place Transformation */
    .ai-cta-container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80px;
      width: 100%;
      max-width: 420px;
      margin: 1.5rem auto;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .phone-form-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 2rem;
      text-align: center;
      opacity: 0;
      transform: translateY(20px) scale(0.95);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      visibility: hidden;
      pointer-events: none;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      z-index: 2;
    }
    
    .phone-form-container.active {
      opacity: 1;
      transform: translateY(0) scale(1);
      visibility: visible;
      pointer-events: auto;
    }
    
    .phone-form-container.entering {
      opacity: 0.5;
      transform: translateY(10px) scale(0.98);
    }
    
    /* Enhanced Phone Form Header */
    .phone-form-header {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .phone-form-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.5rem;
      line-height: 1.3;
      letter-spacing: -0.02em;
    }
    
    .phone-form-subtitle {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.5;
      margin-bottom: 0;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Enhanced Phone Input Wrapper */
    .phone-input-wrapper {
      position: relative;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }
    
    .enhanced-phone-wrapper {
      margin-bottom: 2rem;
    }
    
    .phone-input-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 0.5rem;
      text-align: left;
    }
    
    .phone-input-container {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .phone-input-hint {
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.5);
      margin-top: 0.5rem;
      text-align: center;
      font-style: italic;
    }
    
    .phone-input {
      width: 100%;
      padding: 1.4rem 1.2rem 1.4rem 3.5rem;
      background: rgba(255, 255, 255, 0.04) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 12px !important;
      color: #ffffff !important;
      font-size: 16px !important;
      font-family: 'General Sans', -apple-system, sans-serif !important;
      font-weight: 400;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      outline: none !important;
      box-sizing: border-box;
      text-align: center;
      backdrop-filter: blur(5px);
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .phone-input:focus {
      border-color: rgba(255, 255, 255, 0.4) !important;
      background: rgba(255, 255, 255, 0.06) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1),
        0 0 0 3px rgba(255, 255, 255, 0.1),
        0 2px 8px rgba(0, 0, 0, 0.15);
      transform: translateY(-1px) scale(1.01);
    }
    
    /* Professional Input Validation States */
    .phone-input-wrapper.valid .phone-input {
      border-color: rgba(74, 222, 128, 0.6) !important;
      background: rgba(74, 222, 128, 0.05) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1),
        0 0 0 3px rgba(74, 222, 128, 0.15);
    }
    
    .phone-input-wrapper.valid .phone-input-icon {
      color: #4ade80 !important;
    }
    
    .phone-input-wrapper.error .phone-input {
      border-color: rgba(255, 255, 255, 0.2) !important;
      background: rgba(255, 255, 255, 0.05) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .phone-input-wrapper.error .phone-input-icon {
      color: #ef4444 !important;
    }
    
    /* Professional input states with micro-animations */
    .phone-input-wrapper.valid {
      animation: validPulse 0.3s ease;
    }
    
    .phone-input-wrapper.error {
      /* Subtle error state without distracting animation */
    }
    
    @keyframes validPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }
    
    @keyframes errorShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }

    /* ============================================
       PROFESSIONAL POLISH & MICRO-INTERACTIONS
       ============================================ */

    /* Enhanced Button Hover States */
    .btn, .cta-button, .ai-cta-button, .phone-submit-btn, .back-button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }

    .btn::before, .cta-button::before, .ai-cta-button::before, .phone-submit-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s ease;
      z-index: 1;
    }

    .btn:hover::before, .cta-button:hover::before, .ai-cta-button:hover::before, .phone-submit-btn:hover::before {
      left: 100%;
    }

    /* Professional Button Hover Effects */
    .btn:hover, .cta-button:hover, .ai-cta-button:hover, .phone-submit-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(255, 255, 255, 0.15);
    }

    .btn:active, .cta-button:active, .ai-cta-button:active, .phone-submit-btn:active {
      transform: translateY(0px);
      transition: transform 0.1s ease;
    }

    /* Enhanced Focus States for Accessibility */
    .btn:focus-visible, .cta-button:focus-visible, .ai-cta-button:focus-visible, .phone-input:focus-visible {
      outline: 2px solid rgba(255, 255, 255, 0.6);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);
    }

    /* Professional Loading States */
    .loading-state {
      position: relative;
      color: transparent !important;
      pointer-events: none;
    }

    .loading-state::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: loadingSpin 1s linear infinite;
    }

    @keyframes loadingSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Subtle Animations for State Changes */
    .confirmation-section, .ai-phone-form-container, .calendar-embed-container {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Professional Typography Enhancement */
    h1, h2, h3, .section-title {
      font-weight: 600;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }

    /* Enhanced Card Hover Effects */
    .confirmation-section, .calendar-section {
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .confirmation-section:hover, .calendar-section:hover {
      border-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    /* Professional Form Enhancements */
    .phone-input-wrapper {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .phone-input:focus {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* Enhanced Video Player Professional Touch */
    .professional-video-container {
      position: relative;
      transition: all 0.3s ease;
    }


    /* Duplicate definition removed - consolidated above */

    /* Smooth Scrolling Enhancement */
    html {
      scroll-behavior: smooth;
    }

    /* Professional Mobile Optimizations */
    @media (max-width: 768px) {
      .btn:hover, .cta-button:hover, .ai-cta-button:hover {
        transform: none;
        box-shadow: none;
      }
      
      .confirmation-section:hover, .calendar-section:hover {
        transform: none;
      }
      
      .professional-video-container:hover {
        transform: none;
      }
    }

    /* Enhanced Status Indicators */
    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .status-indicator.success {
      background: rgba(34, 197, 94, 0.1);
      color: #22c55e;
      border: 1px solid rgba(34, 197, 94, 0.2);
    }

    .status-indicator.processing {
      background: rgba(59, 130, 246, 0.1);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    /* Professional Skeleton Loaders */
    .skeleton {
      background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.1) 0%, 
        rgba(255, 255, 255, 0.2) 50%, 
        rgba(255, 255, 255, 0.1) 100%);
      background-size: 200% 100%;
      animation: skeletonLoading 1.5s ease-in-out infinite;
      border-radius: 4px;
    }

    @keyframes skeletonLoading {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .phone-input::placeholder {
      color: rgba(255, 255, 255, 0.6) !important;
      font-weight: 400;
      text-align: center;
    }
    
    .phone-input-icon {
      position: absolute;
      left: 1.2rem;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.6) !important;
      width: 18px;
      height: 18px;
      stroke-width: 2;
      transition: color 0.3s ease;
      z-index: 2;
      pointer-events: none;
    }
    
    /* Professional AI Discovery CTA Button */
    .professional-ai-cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      padding: 1rem 2rem;
      background: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      color: var(--primary-black) !important;
      font-size: 1rem;
      font-weight: 600;
      font-family: 'General Sans', -apple-system, sans-serif;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      background: rgba(0, 0, 0, 0.8);
      margin: 1.5rem auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
      text-shadow: none;
      min-width: 280px;
    }
    
    
    .professional-ai-cta:hover {
      background: #ffffff;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      border-color: rgba(255, 255, 255, 0.4);
    }
    
    
    .professional-ai-cta:active {
      transform: translateY(0px);
      transition: transform 0.1s ease;
    }
    
    .professional-ai-cta.fading-out {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }
    
    .professional-ai-cta .button-content {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      position: relative;
      z-index: 1;
    }
    
    .professional-ai-cta .button-text {
      font-weight: 400; /* Change from 600 to 400 for normal weight */
      letter-spacing: -0.01em;
      color: var(--primary-black) !important;
      text-shadow: none !important;
      background: transparent !important;
      -webkit-text-stroke: 0 !important;
    }
    
    .professional-ai-cta .button-arrow {
      width: 1.1rem;
      height: 1.1rem;
      transition: transform 0.3s ease;
    }
    
    .professional-ai-cta:hover .button-arrow {
      transform: translateX(2px);
    }

    /* Smart Phone CTA with Inline Transformation - NUCLEAR PRIORITY */
    .smart-phone-cta {
      position: relative;
      height: 64px;
      width: 100%;
      max-width: 520px;
      margin: 0 auto;
      overflow: hidden;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border: 2px solid #e5e5e5 !important;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    }

    .smart-phone-cta:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
    }

    /* Button and Phone States */
    .button-state,
    .phone-state {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 0 1.5rem;
      box-sizing: border-box;
    }

    /* Initial Button State - MAXIMUM VISIBILITY */
    .button-state {
      background: #ffffff !important;
      background-color: #ffffff !important;
      transform: translateX(0);
      z-index: 2;
    }

    .button-state .button-text {
      font-weight: 600 !important;
      font-size: 1rem !important;
      color: #1a1a1a !important;
      margin-right: 0.75rem;
      white-space: nowrap;
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      opacity: 1 !important;
      visibility: visible !important;
    }

    .button-state .button-arrow {
      width: 1.1rem;
      height: 1.1rem;
      color: #1a1a1a !important;
      fill: #1a1a1a !important;
      stroke: #1a1a1a !important;
      transition: transform 0.3s ease;
      opacity: 1 !important;
    }

    /* Phone Input State */
    .phone-state {
      background: #ffffff;
      transform: translateX(100%);
      z-index: 1;
      gap: 1rem;
    }

    .phone-state.active {
      transform: translateX(0);
      z-index: 3;
    }

    .button-state.sliding-out {
      transform: translateX(-100%);
    }

    /* Phone Icon */
    .phone-icon {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      color: var(--primary-black);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .phone-icon svg {
      width: 100%;
      height: 100%;
    }

    /* Digit Input Form */
    .digit-input-form {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex: 1;
    }

    .digit-input-group {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      flex: 1;
    }

    /* Format Characters */
    .format-char {
      font-weight: 600;
      color: var(--primary-black);
      font-size: 1rem;
      user-select: none;
    }

    /* Individual Digit Boxes */
    .digit-box {
      width: 2.8rem;
      height: 2.8rem;
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-black);
      background: rgba(0, 0, 0, 0.03);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      transition: all 0.2s ease;
      outline: none;
      font-family: 'General Sans', -apple-system, sans-serif;
    }

    .digit-box:focus {
      background: rgba(255, 255, 255, 0.05);
      border-color: var(--white);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
      transform: scale(1.05);
    }

    .digit-box.filled {
      background: rgba(74, 222, 128, 0.05);
      border-color: #10b981;
    }

    .digit-box.error {
      background: rgba(239, 68, 68, 0.05);
      border-color: #ef4444;
      animation: shake 0.3s ease;
    }

    /* Confirm Button */
    .confirm-btn {
      flex-shrink: 0;
      padding: 0.75rem 1.5rem;
      background: var(--primary-black);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'General Sans', -apple-system, sans-serif;
    }

    .confirm-btn:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    .confirm-btn:disabled {
      background: rgba(0, 0, 0, 0.1);
      color: rgba(0, 0, 0, 0.4);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Animations */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .smart-phone-cta {
        max-width: 100%;
        height: 60px;
      }
      
      .digit-box {
        width: 2.4rem;
        height: 2.4rem;
        font-size: 1rem;
      }
      
      .format-char {
        font-size: 0.9rem;
      }
      
      .confirm-btn {
        padding: 0.6rem 1.2rem;
        font-size: 0.85rem;
      }
    }

    /* APPLE-STYLE BUTTON - ABSOLUTE POSITIONED */
    html body .ai-cta-container button.emergency-phone-button,
    html body button.emergency-phone-button,
    html body .emergency-phone-button,
    body .emergency-phone-button {
      /* Reset and rebuild for absolute positioning */
      all: initial !important;
      
      /* Absolute positioning within container */
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100% !important;
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      box-sizing: border-box !important;
      
      /* SOPHISTICATED BACKGROUND - matches site design */
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      
      /* Sophisticated typography */
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-style: normal !important;
      line-height: 60px !important;
      color: #1f2937 !important;
      text-align: center !important;
      text-decoration: none !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      white-space: nowrap !important;
      
      /* Apple-style transitions */
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      
      /* Default visible state */
      opacity: 1 !important;
      visibility: visible !important;
      z-index: 2 !important;
      transform: translateY(0) scale(1) !important;
      pointer-events: auto !important;
      
      /* Sophisticated shadow */
      outline: none !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      -webkit-appearance: none !important;
      appearance: none !important;
      
      /* Remove any potential conflicts */
      text-shadow: none !important;
      -webkit-text-stroke: none !important;
      filter: none !important;
      mask: none !important;
      -webkit-mask: none !important;
    }
    
    /* Apple-style button fade out is handled by .hidden class in the main system above */
    
    /* Sophisticated hover - matches site aesthetic */
    html body .ai-cta-container button.emergency-phone-button:hover,
    html body button.emergency-phone-button:hover,
    html body .emergency-phone-button:hover,
    body .emergency-phone-button:hover,
    .emergency-phone-button:hover {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      color: #111827 !important;
      transform: translateY(-2px) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Sophisticated active state */
    html body .ai-cta-container button.emergency-phone-button:active,
    html body button.emergency-phone-button:active,
    html body .emergency-phone-button:active,
    body .emergency-phone-button:active,
    .emergency-phone-button:active {
      background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%) !important;
      border-color: rgba(255, 255, 255, 0.2) !important;
      color: #111827 !important;
      transform: translateY(0) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Focus state for accessibility */
    .emergency-phone-button:focus {
      outline: 2px solid #93c5fd !important;
      outline-offset: 2px !important;
    }
    
    /* VERCEL-STYLE CLEAN PHONE COMPONENT */
    .phone-component-container {
      position: relative !important;
      width: 100% !important;
      max-width: 400px !important;
      height: 80px !important; /* Accommodate input + status message */
      margin: 2rem auto !important;
    }
    
    /* Shared transition for all elements */
    .transition-element {
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out !important;
    }
    
    /* Visible state */
    .fade-in {
      opacity: 1 !important;
      transform: translateY(0) !important;
      pointer-events: auto !important;
    }
    
    /* Hidden state */
    .fade-out {
      opacity: 0 !important;
      transform: translateY(5px) !important;
      pointer-events: none !important;
    }
    
    /* PROFESSIONAL BUTTON - MATCHES YOUR SITE DESIGN */
    .cta-button {
      width: 100% !important;
      height: 48px !important;
      padding: 0 24px !important;
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      color: #1f2937 !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.2s ease-in-out !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 10px !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      outline: none !important;
      letter-spacing: -0.01em !important;
    }
    
    .cta-button:hover {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* ULTRA-NUCLEAR OVERRIDES - ELIMINATE BLACK SQUARES/BARS IN CTA BUTTON */
    /* Maximum specificity overrides */
    .cta-button,
    .cta-button *,
    .cta-button span,
    .cta-button svg,
    .cta-button path,
    .phone-icon,
    .phone-icon * {
      /* ELIMINATE TEXT STROKE ISSUES */
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      -webkit-text-stroke-width: 0 !important;
      -webkit-text-stroke-color: transparent !important;
      
      /* FORCE PROPER FONT RENDERING */
      font-smooth: always !important;
      -webkit-font-smoothing: antialiased !important;
      -moz-osx-font-smoothing: grayscale !important;
      text-rendering: optimizeLegibility !important;
      
      /* ELIMINATE WEIRD APPEARANCE ISSUES */
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
      
      /* FORCE VISIBILITY */
      opacity: 1 !important;
      visibility: visible !important;
      display: inherit !important;
      
      /* PREVENT BACKGROUND BLEEDING */
      background-clip: padding-box !important;
      -webkit-background-clip: padding-box !important;
      
      /* FORCE PROPER COLORS */
      color: inherit !important;
      fill: currentColor !important;
      stroke: currentColor !important;
    }
    
    /* ULTRA-SPECIFIC OVERRIDES - HIGHEST PRIORITY */
    #phoneComponentContainer #buttonContainer #ctaButton,
    #phoneComponentContainer #buttonContainer #ctaButton *,
    #phoneComponentContainer #buttonContainer #ctaButton span,
    #phoneComponentContainer #buttonContainer #ctaButton svg,
    #phoneComponentContainer #buttonContainer #ctaButton path,
    div.phone-component-container div.transition-element.fade-in button.cta-button,
    div.phone-component-container div.transition-element.fade-in button.cta-button *,
    div.phone-component-container div.transition-element.fade-in button.cta-button span,
    div.phone-component-container div.transition-element.fade-in button.cta-button svg {
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      -webkit-text-stroke-width: 0 !important;
      -webkit-text-stroke-color: transparent !important;
      text-shadow: none !important;
      color: inherit !important;
      fill: currentColor !important;
      stroke: currentColor !important;
      background-clip: padding-box !important;
      -webkit-background-clip: padding-box !important;
      pointer-events: auto !important;
      cursor: pointer !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* ENSURE CONTAINERS DON'T BLOCK CLICKS */
    #phoneComponentContainer,
    #buttonContainer,
    .phone-component-container,
    .transition-element.fade-in {
      pointer-events: auto !important;
      cursor: pointer !important;
      z-index: 10 !important;
      position: relative !important;
    }

    /* SPECIFIC SVG ICON FIXES */
    .phone-icon {
      width: 20px !important;
      height: 20px !important;
      color: #6b7280 !important;
    }
    
    /* DARK-THEMED FORM - MATCHES YOUR SITE */
    .phone-input-wrapper {
      position: relative !important;
      display: flex !important;
      align-items: center !important;
      width: 100% !important;
      height: 48px !important;
    }
    
    .phone-input {
      width: 100% !important;
      height: 48px !important;
      padding: 0 120px 0 20px !important; /* Space for Call Me button */
      background: #1f2937 !important;
      border: 1px solid #374151 !important;
      border-radius: 8px !important;
      color: #ffffff !important;
      font-size: 16px !important;
      font-weight: 500 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      outline: none !important;
      transition: all 0.2s ease-in-out !important;
      box-sizing: border-box !important;
    }
    
    .phone-input::placeholder {
      color: #9ca3af !important;
      font-weight: 400 !important;
    }
    
    .phone-input:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1) !important;
    }
    
    .call-button {
      position: absolute !important;
      right: 6px !important;
      top: 50% !important;
      transform: translateY(-50%) !important;
      height: 36px !important;
      padding: 0 16px !important;
      background: #3b82f6 !important;
      color: #ffffff !important;
      border: none !important;
      border-radius: 6px !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.2s ease-in-out !important;
      outline: none !important;
      white-space: nowrap !important;
    }
    
    .call-button:hover {
      background: var(--primary-black) !important;
    }
    
    .call-button:disabled {
      background: #6b7280 !important;
      cursor: not-allowed !important;
    }
    
    .status-message {
      position: absolute !important;
      top: 56px !important;
      left: 0 !important;
      right: 0 !important;
      font-size: 12px !important;
      text-align: center !important;
      height: 16px !important;
      transition: color 0.2s ease !important;
      color: #6b7280 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
    }
    
    .status-success {
      color: #22c55e !important;
    }
    
    .status-error {
      color: #ef4444 !important;
    }
    
    /* Professional phone form container - matches button position */
    .smart-phone-cta .phone-state {
      display: none;
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      margin: 0 !important;
    }
    
    .smart-phone-cta .phone-state.active {
      display: block !important;
    }
    
    /* Professional phone form layout */
    .professional-phone-form {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* PROFESSIONAL FORM - MATCHES BUTTON AESTHETIC */
    .phone-input-container {
      display: flex !important;
      align-items: center !important;
      gap: 12px !important;
      width: 100% !important;
      height: 60px !important;
      /* Match button's sophisticated gradient background */
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      padding: 0 16px !important;
      box-sizing: border-box !important;
      /* Match button's professional shadow */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Professional phone input field */
    .professional-phone-input {
      flex: 1 !important;
      height: 44px !important;
      border: none !important;
      outline: none !important;
      font-size: 16px !important;
      font-weight: 500 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      color: #1f2937 !important;
      background: transparent !important;
      padding: 0 !important;
      letter-spacing: -0.01em !important;
    }
    
    .professional-phone-input::placeholder {
      color: #6b7280 !important;
      font-weight: 400 !important;
    }
    
    .professional-phone-input:focus {
      outline: none !important;
    }
    
    /* Sophisticated focus state */
    .phone-input-container:focus-within {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Professional call button - matches button style */
    .professional-call-btn {
      height: 44px !important;
      padding: 0 20px !important;
      /* Sophisticated dark button to contrast with light form */
      background: #374151 !important;
      color: #ffffff !important;
      border: none !important;
      border-radius: 6px !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      white-space: nowrap !important;
      outline: none !important;
      letter-spacing: -0.01em !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    }
    
    .professional-call-btn:hover {
      background: #1f2937 !important;
      transform: translateY(-0.5px) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    }
    
    .professional-call-btn:active {
      background: #111827 !important;
      transform: translateY(0) !important;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    }

    /* Enhanced Professional Back Button */
    .professional-back-button, .back-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.9rem;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 2rem;
      background: rgba(0, 0, 0, 0.7);
    }
    
    .professional-back-button:hover, .back-button:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
      color: rgba(255, 255, 255, 0.95);
      transform: translateX(-2px);
    }
    
    .back-icon {
      width: 1rem;
      height: 1rem;
      transition: transform 0.3s ease;
    }
    
    .professional-back-button:hover .back-icon, 
    .back-button:hover .back-icon {
      transform: translateX(-2px);
    }
    
    /* NUCLEAR OPTION: Global Text-Stroke Elimination */
    *, *::before, *::after {
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
    }
    
    /* Force disable text-stroke on buttons specifically */
    button, .button, [type="submit"], .ai-discovery-cta, #submitPhoneButton {
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
      outline: none !important;
    }
    
    /* Ultimate phone button fix - Maximum Nuclear Specificity */
    html body div .phone-form-container #submitPhoneButton {
      background: #ffffff !important;
      background-color: #ffffff !important;
      color: #1a1a1a !important;
      border: 1px solid rgba(0, 0, 0, 0.15) !important;
      padding: 1rem 2rem !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif !important;
      border-radius: 8px !important;
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
      display: inline-block !important;
      visibility: visible !important;
      opacity: 1 !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
      text-decoration: none !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    }
    
    html body div .phone-form-container #submitPhoneButton:hover {
      background: #f8f8f8 !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    }

    /* Professional Back Button */
    .back-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: transparent;
      border: none;
      color: rgba(255, 255, 255, 0.6);
      font-size: 14px;
      font-weight: 400;
      font-family: 'General Sans', -apple-system, sans-serif;
      cursor: pointer;
      padding: 0.5rem 0;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .back-button:hover {
      color: rgba(255, 255, 255, 0.9);
      transform: translateX(-2px);
    }
    
    .back-icon {
      width: 16px;
      height: 16px;
      transition: transform 0.3s ease;
    }
    
    .back-button:hover .back-icon {
      transform: translateX(-2px);
    }

    /* AI Success Message CSS - REMOVED (Unprofessional design) */

    /* Success message CSS removed - unprofessional design */

    /* Tablet success message CSS removed */

    /* Desktop success message CSS removed */
    
    .submit-phone-button {
      width: 100%;
      padding: 1rem 2rem;
      background: var(--white);
      color: var(--primary-black);
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .submit-phone-button:hover {
      background: var(--grey);
      transform: translateY(-1px);
    }
    
    .submit-phone-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .ai-supporting-text {
      font-size: 0.875rem;
      color: var(--grey);
      margin-top: 1rem !important; /* Clean balanced spacing */
      margin-bottom: 1rem !important; /* Clean balanced spacing */
      line-height: 1.5;
    }
    
    /* Success State */
    .success-message {
      display: none;
      background: var(--secondary-black);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 1.5rem;
      margin-top: 1rem;
      text-align: center;
    }
    
    /* Premium Calendar Section */
    .cal-calendar-section {
      padding: 0.5rem 2rem 1.5rem 2rem;
      background-color: var(--primary-black);
      text-align: center;
      margin-top: 0;
    }
    
    .cal-calendar-section h3 {
      font-size: 1.375rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0;
      letter-spacing: -0.01em;
    }
    
    .calendar-subtext {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 0.5rem;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.5;
    }
    
    .success-message.active {
      display: block;
      animation: slideUp 0.4s ease;
    }
    
    .success-icon {
      color: var(--white);
      width: 32px;
      height: 32px;
      margin: 0 auto 1rem;
    }
    
    .success-title {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.5rem;
    }
    
    .success-text {
      color: var(--grey);
      font-size: 0.875rem;
    }
    
    /* Footer Section - Premium Dark - Hidden by default, shown only on confirmation */
    .confirmation-footer {
      display: none; /* Hidden by default during calendar view */
      padding: 1.5rem;
      background: var(--primary-black); /* Match site background */
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      text-align: center;
    }
    
    .footer-links {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      flex-wrap: wrap;
    }
    
    /* Import button styles from main site */
    .link-button {
      grid-column-gap: 3px;
      grid-row-gap: 3px;
      flex-flow: column;
      justify-content: flex-start;
      align-items: center;
      text-decoration: none;
      display: flex;
      overflow: hidden;
    }
    
    .button-link-wrapper {
      grid-column-gap: 5px;
      grid-row-gap: 5px;
      flex-flow: row;
      justify-content: flex-start;
      align-items: center;
      display: flex;
      position: relative;
    }
    
    .button-text-block {
      flex-flow: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 1rem;
      display: flex;
      position: relative;
      overflow: hidden;
    }
    
    .button-text {
      color: rgba(255, 255, 255, 0.6);
      text-transform: uppercase;
      white-space: nowrap;
      font-size: 12px;
      font-weight: 500;
      line-height: 1rem;
      transition: transform .3s cubic-bezier(.165, .84, .44, 1);
      display: flex;
      align-items: center;
      height: 1rem;
    }
    
    .button-text.is-hover {
      color: rgba(255, 255, 255, 0.8);
      position: absolute;
      top: 1rem;
    }
    
    .link-button:hover .button-text {
      transform: translateY(-100%);
    }
    
    .link-button:hover .button-text.is-hover {
      transform: translateY(-100%);
    }
    
    .arrow-button-block {
      justify-content: center;
      align-items: center;
      width: 1rem;
      height: 1rem;
      display: flex;
      position: relative;
      overflow: hidden;
    }
    
    .arrow-button {
      color: rgba(255, 255, 255, 0.6);
      width: 1rem;
      height: 1rem;
      display: block;
      position: absolute;
      inset: 0%;
      transition: transform .3s cubic-bezier(.165, .84, .44, 1);
    }
    
    .arrow-button._02 {
      color: rgba(255, 255, 255, 0.8);
      transform: translateX(-100%);
    }
    
    .link-button:hover .arrow-button._01 {
      transform: translateX(100%);
    }
    
    .link-button:hover .arrow-button._02 {
      transform: translateX(0);
    }
    
    .underline {
      background-color: rgba(255, 255, 255, 0.6);
      width: 100%;
      height: 1px;
      margin-top: 3px;
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }

    .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8);
    }
    
    .link-button:hover .underline {
      background-color: rgba(255, 255, 255, 0.8);
      transform: scaleX(1);
    }
    
    .footer-divider {
      width: 1px;
      height: 14px;
      background: rgba(255, 255, 255, 0.1);
      display: inline-block;
    }
    
    /* CTA Button Hover States */
    #ctaButton:hover {
      background: rgba(255, 255, 255, 0.1) !important;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    /* Disabled State - Maintain professional loading appearance */
    #ctaButton:disabled {
      background: white !important;
      color: #333333 !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
      cursor: not-allowed !important;
      pointer-events: none !important;
    }
    
    #ctaButton:disabled:hover {
      background: white !important;
      color: #333333 !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
      cursor: not-allowed !important;
    }
    
    /* AI Call Button Success State - Prevent Hover Effects */
    #aiCallButton.success-state:hover {
      transform: none !important;
      background: rgba(34, 197, 94, 0.1) !important;
      border: 1px solid rgba(34, 197, 94, 0.3) !important;
      color: #22c55e !important;
    }
    
    /* Loading Animations */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes progress {
      0% { stroke-dashoffset: 31.416; }
      50% { stroke-dashoffset: 0; }
      100% { stroke-dashoffset: -31.416; }
    }
    
    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Responsive Styles */
    @media (max-width: 768px) {
      /* Stack step indicators vertically on mobile */
      .step-indicator {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
      }
      
      .step-indicator h2,
      .step-indicator h3 {
        text-align: center;
      }
      
      .ai-discovery-section {
        padding: 5rem 1.5rem; /* Match homepage mobile .padding-section-large */
      }
      
      .ai-discovery-heading {
        font-size: 1.5rem;
      }
      
      .ai-discovery-subheading {
        font-size: 1rem;
      }
      
      .link-button.ai-discovery-cta,
      body .phone-form-container .ai-discovery-cta,
      body .phone-form-container button.ai-discovery-cta,
      body .phone-form-container #submitPhoneButton.ai-discovery-cta,
      body #submitPhoneButton {
        transform: scale(1) !important;
        display: inline-block !important;
        visibility: visible !important;
        background: #ffffff !important;
        background-color: #ffffff !important;
        color: #1a1a1a !important;
      }
      
      .footer-links {
        flex-direction: column;
        gap: 1rem;
      }
      
      .footer-divider {
        display: none;
      }
      
      .link-button {
        transform: scale(1);
        margin: 0.5rem 0;
      }
    }
    
    /* COMPREHENSIVE Background Fix - Zero White Backgrounds */
    html, body {
      background-color: var(--primary-black) !important; /* #0f0f0f */
      min-height: 100vh;
    }
    
    .page-wrapper {
      background-color: var(--primary-black) !important;
      min-height: 100vh;
    }
    
    /* Universal background enforcement for all containers */
    .page-wrapper *,
    main,
    section,
    header,
    footer {
      background-color: var(--primary-black) !important;
    }
    
    /* SURGICAL Cal.com Container Targeting - Fix ONLY White Background */
    /* Container styling consolidated above - targeting only wrapper divs */
    
    /* Target only the immediate wrapper divs, preserve Cal.com's internal styling */
    #my-cal-inline-30min > div:first-child {
      background-color: var(--primary-black) !important;
    }
    
    /* ✅ REMOVED SURGICAL TEXT OVERRIDES: 
     * User's original config with cal-brand: "#fafafa" handles text colors properly
     * No manual color overrides needed with month_view layout
     */
    
    /* ✅ REMOVED DESKTOP OVERLAY OVERRIDES:
     * month_view layout behaves differently than column_view
     * User's original configuration should handle overlays properly
     */
    
    /* PROFESSIONAL Cal.com Integration Best Practices 2024 */
    /* Professional loading states and error handling */
    
    /* Professional loading states */
    #my-cal-inline-30min[data-cal-loading="true"] {
      opacity: 0.8;
      pointer-events: none;
    }
    
    /* Enhanced Responsive Design for Professional Presentation */
    @media (max-width: 768px) {
      #my-cal-inline-30min {
        margin: 0;
        border-radius: 4px;
        padding: 0;
      }
    }
    
    @media (max-width: 480px) {
      #my-cal-inline-30min {
        border-radius: 0;
        margin: 0 -1rem; /* Extend to screen edges on small devices */
      }
    }
    
    /* Professional error handling */
    #my-cal-inline-30min .cal-error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #f87171;
      padding: 1rem;
      border-radius: 6px;
      text-align: center;
    }
    
    /* Catch any remaining transparent backgrounds */
    *[style*="background: transparent"],
    *[style*="background-color: transparent"] {
      background-color: var(--primary-black) !important;
    }
    
    /* Target specific Cal.com generated containers */
    [data-cal-namespace],
    [data-cal-namespace] *,
    [class*="cal-"],
    [id*="cal-"] {
      background-color: var(--primary-black) !important;
    }
    
    /* Modern CSS eliminates the need for complex height overrides */
    
    /* 🎯 PROFESSIONAL: Metadata-only approach - no customer-facing technical data */
  </style>
  <!-- Cookie Consent Styles -->
  <link href="css/cookie-consent.css" rel="stylesheet" type="text/css">
</head>

<body>

  <!-- Custom Loading Overlay - Replaces Cal.com Blue Redirect -->
  <div id="customLoadingOverlay" class="custom-loading-overlay">
    <div class="custom-loading-spinner"></div>
    <div class="custom-loading-text">Preparing Your Session</div>
    <div class="custom-loading-subtitle">Setting up your personalized automation strategy session...</div>
  </div>

  <div class="page-wrapper">
    <!-- Header Section -->
    <header class="calendar-header">
      <div class="padding-global">
        <div class="container-large">
          <h1>Book Your Strategy Session</h1>
          <p>Let's map your highest-impact automations together in this personalized 30-minute consultation.</p>
        </div>
      </div>
    </header>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
      <div class="progress-steps">
        <div class="progress-step">
          <div class="step-circle completed">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M 20.292969 5.2929688 L 9 16.585938 L 4.7070312 12.292969 L 3.2929688 13.707031 L 9 19.414062 L 21.707031 6.7070312 L 20.292969 5.2929688 z"/>
            </svg>
          </div>
          <span class="step-text">Assessment Complete</span>
        </div>
        <div class="step-divider"></div>
        <div class="progress-step active">
          <div class="step-circle">2</div>
          <span class="step-text">Book Your Session</span>
        </div>
      </div>
    </div>

    <!-- Personalized Message Section -->
    <div class="personalized-message" id="personalized-message" style="display: none;">
      <p class="personalized-text" id="personalized-text">
        <!-- Personalized message will be populated via JavaScript -->
      </p>
      <div class="calendar-divider"></div>
    </div>
    

    <!-- Calendar Section - Official Cal.com Inline Embed -->
    <main class="calendar-container">
      <!-- Cal inline embed code begins -->
      <div style="width:100%;height:100%;overflow:scroll" id="my-cal-inline-30min"></div>
      <script type="text/javascript">
        // Initialize Cal.com with questionnaire data (using Cal loader from header)
        document.addEventListener('DOMContentLoaded', function() {
          // PROFESSIONAL CALENDAR INTEGRATION FUNCTIONS
          // Extract calendar data from Cal.com booking event
          window.extractCalendarData = function(bookingData) {
            console.log('📅 Extracting calendar data from booking event:', bookingData);
            
            try {
              // Handle different Cal.com event formats
              let booking = null;
              
              if (bookingData.data && bookingData.data.booking) {
                // bookingSuccessfulV2 format
                booking = bookingData.data.booking;
              } else if (bookingData.booking) {
                // Direct booking format
                booking = bookingData.booking;
              } else {
                console.warn('⚠️ Unknown booking data format');
                return null;
              }
              
              // Extract essential calendar information including meeting data
              const calendarEvent = {
                title: 'AI Automation Strategy Session', // Override Cal.com title completely
                startDate: booking.startTime,
                endDate: booking.endTime,
                description: booking.description || 'Strategic consultation to design your personalized automation roadmap',
                location: booking.location || 'Video Call (link will be provided)',
                attendees: booking.attendees || [],
                organizer: booking.user || booking.organizer,
                // Extract meeting link and password from videoCallData with multiple fallbacks
                meetingLink: booking.videoCallData?.url || booking.conferenceData?.entryPoints?.[0]?.uri || booking.meetingUrl || null,
                meetingPassword: booking.videoCallData?.password || booking.conferenceData?.conferenceId || booking.meetingPassword || null,
                videoCallData: booking.videoCallData || null,
                // Store booking ID for delayed meeting link retrieval
                bookingId: booking.id || booking.uid || null
              };
              
              console.log('📅 Calendar event extracted:', calendarEvent);
              return calendarEvent;
              
            } catch (error) {
              console.error('❌ Error extracting calendar data:', error);
              return null;
            }
          };
          
          // Delayed meeting link retrieval function - tries to get meeting link after Cal.com processes it
          window.checkForDelayedMeetingLink = function(eventData) {
            // Only attempt if we don't have a meeting link yet but have a booking ID
            if (!eventData.meetingLink && eventData.bookingId) {
              console.log('🔍 Attempting delayed meeting link retrieval for booking:', eventData.bookingId);
              
              // Try multiple approaches to get the meeting link
              setTimeout(() => {
                // Approach 1: Check if Cal.com has updated the booking data
                try {
                  // Try to trigger a Cal.com refresh event to get updated booking data
                  if (window.Cal && window.Cal.ns && window.Cal.ns["30min"]) {
                    console.log('🔄 Attempting Cal.com data refresh...');
                    // This is a placeholder - Cal.com doesn't provide a direct API for this
                    // In practice, the meeting link is usually sent via email
                  }
                } catch (error) {
                  console.log('ℹ️ Cal.com refresh attempt completed');
                }
                
                // Update stored calendar data if meeting link is now available
                const storedData = localStorage.getItem('bookingConfirmed');
                if (storedData) {
                  try {
                    const parsed = JSON.parse(storedData);
                    if (!parsed.meetingLink && eventData.meetingLink) {
                      parsed.meetingLink = eventData.meetingLink;
                      parsed.meetingPassword = eventData.meetingPassword;
                      localStorage.setItem('bookingConfirmed', JSON.stringify(parsed));
                      // PRODUCTION: console.log('✅ Updated stored calendar data with meeting link');
                    }
                  } catch (error) {
                    console.log('ℹ️ Could not update stored calendar data');
                  }
                }
              }, 5000); // Wait 5 seconds for Cal.com to process
              
              // Second attempt after longer delay
              setTimeout(() => {
                console.log('🔍 Final attempt at meeting link retrieval...');
                // At this point, we acknowledge that meeting links are typically sent via email
                console.log('ℹ️ Meeting link will be provided via email confirmation as designed');
              }, 15000); // Wait 15 seconds total
            } else if (eventData.meetingLink) {
              // PRODUCTION: console.log('✅ Meeting link already available:', eventData.meetingLink.substring(0, 30) + '...');
            }
          };
          
          // Professional video platform detection and handling
          window.processVideoLocation = function(location) {
            console.log('📹 Processing video location:', location);
            
            const videoMappings = {
              'integrations:zoom': {
                display: 'Zoom Video Conference',
                placeholder: 'Zoom Meeting - Link will be sent via email',
                icon: '🎥',
                instructions: 'Join via Zoom app or browser. Meeting details will be emailed to you.',
                platform: 'zoom'
              },
              'integrations:google:meet': {
                display: 'Google Meet Video Conference',  
                placeholder: 'Google Meet - Link will be sent via email',
                icon: '📹',
                instructions: 'Join via Google Meet in your browser. Meeting details will be emailed to you.',
                platform: 'google_meet'
              },
              'integrations:google_meet': {
                display: 'Google Meet Video Conference',  
                placeholder: 'Google Meet - Link will be sent via email',
                icon: '📹',
                instructions: 'Join via Google Meet in your browser. Meeting details will be emailed to you.',
                platform: 'google_meet'
              },
              'integrations:daily': {
                display: 'Daily Video Conference',
                placeholder: 'Daily Meeting - Link will be sent via email',
                icon: '🎬',
                instructions: 'Join via Daily in your browser. Meeting details will be emailed to you.',
                platform: 'daily'
              }
            };
            
            const videoInfo = videoMappings[location] || {
              display: 'Video Conference',
              placeholder: 'Video Meeting - Link will be sent via email',
              icon: '📞',
              instructions: 'Meeting link and details will be emailed to you shortly.',
              platform: 'generic'
            };
            
            console.log('📹 Video platform detected:', videoInfo.platform);
            return videoInfo;
          };
          
          // Generate professional meeting description with meeting links
          window.generateProfessionalDescription = function(eventData, videoInfo, timezone, meetingLink, meetingPassword, attendees) {
            const duration = eventData.endDate && eventData.startDate 
              ? Math.round((new Date(eventData.endDate) - new Date(eventData.startDate)) / (1000 * 60))
              : 30;

            const meetingDate = eventData.startDate ? new Date(eventData.startDate) : new Date();
            const timeString = meetingDate.toLocaleString('en-US', {
              weekday: 'long',
              year: 'numeric', 
              month: 'long',
              day: 'numeric',
              hour: 'numeric',
              minute: '2-digit',
              timeZoneName: 'short'
            });

            // Format attendees list
            let attendeesList = '';
            if (attendees && attendees.length > 0) {
              const primaryAttendee = attendees[0];
              const primaryName = primaryAttendee.name || 'Meeting Organizer';
              
              if (attendees.length === 1) {
                attendeesList = `• ${primaryName}`;
              } else {
                const guestCount = attendees.length - 1;
                attendeesList = `• ${primaryName}\n• ${guestCount} additional team member${guestCount > 1 ? 's' : ''}`;
              }
            }

            // Format meeting access
            let meetingAccessInfo = '';
            if (meetingLink) {
              if (videoInfo.platform === 'zoom') {
                meetingAccessInfo = `Join Zoom Meeting:
${meetingLink}${meetingPassword ? `\nMeeting Password: ${meetingPassword}` : ''}`;
              } else if (videoInfo.platform === 'google_meet') {
                meetingAccessInfo = `Join Google Meet:
${meetingLink}`;
              } else {
                meetingAccessInfo = `Join Meeting:
${meetingLink}${meetingPassword ? `\nPassword: ${meetingPassword}` : ''}`;
              }
            } else {
              const platformName = videoInfo.platform === 'google_meet' ? 'Google Meet' : 
                                  videoInfo.platform === 'zoom' ? 'Zoom' : 'Meeting';
              meetingAccessInfo = `${videoInfo.display}
📧 ${platformName} link emailed 15min before`;
            }
              
            return `AI Automation Strategy Session
${timeString}

${meetingAccessInfo}

${attendeesList ? `Attendees:
${attendeesList}

` : ''}Strategic consultation to assess your automation potential and evaluate your transformation opportunities.

We'll evaluate:
• Current workflow inefficiencies and bottlenecks
• Immediate automation opportunities with clear ROI
• Strategic roadmap for scaling your operations
• Technology recommendations aligned with your goals

Please prepare:
• Overview of your most time-intensive processes
• Current tools and systems you're using
• Specific challenges you're facing with manual work
• Growth goals for the next 6-12 months

This consultation focuses on understanding your unique situation to recommend the most impactful automation solutions.

Host: Nithichote Chongrungruang
Email: nithichote.c@gmail.com
Reschedule: Reply to confirmation email`;
          };
          
          // Generate Outlook ultra-concise description (Microsoft bug prevents line breaks)
          window.generateOutlookDescription = function(eventData, videoInfo, meetingLink, meetingPassword, attendees) {
            console.log('📧 Generating Outlook ultra-concise description (Microsoft line break bug workaround)');
            
            const meetingDate = eventData.startDate ? new Date(eventData.startDate) : new Date();
            const dateStr = meetingDate.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' });
            const timeStr = meetingDate.toLocaleTimeString('en-US', { 
              hour: 'numeric', 
              minute: '2-digit',
              hour12: true 
            });
            
            // Professional meeting platform info
            let platformInfo = '';
            if (videoInfo.platform === 'google_meet') {
              platformInfo = meetingLink ? 'Google Meet' : 'Google Meet provided';
            } else if (videoInfo.platform === 'zoom') {
              platformInfo = meetingLink ? 'Zoom meeting' : 'Zoom provided';
            } else {
              platformInfo = meetingLink ? 'Video meeting' : 'Virtual meeting';
            }
            
            // Professional comprehensive format for Microsoft Outlook (single line due to MS bug)
            const outlookDescription = `AI Automation Consultation ${dateStr} ${timeStr} • Virtual: ${platformInfo} • Assessment of automation opportunities & custom roadmap development`;
            
            console.log('📧 Outlook ultra-professional description created:', {
              length: outlookDescription.length,
              preview: outlookDescription,
              format: 'Ultra-professional single line (Microsoft bug workaround)',
              bulletCount: (outlookDescription.match(/•/g) || []).length,
              readable: outlookDescription.length <= 70 ? '✅ Perfect' : outlookDescription.length <= 80 ? '✅ Good' : '⚠️ Too long'
            });
            
            return outlookDescription;
          };
          
          // Generate Yahoo-specific ultra-short description to fix empty description bug
          window.generateYahooDescription = function(eventData, videoInfo, meetingLink, meetingPassword, attendees) {
            const meetingDate = eventData.startDate ? new Date(eventData.startDate) : new Date();
            const timeString = meetingDate.toLocaleString('en-US', {
              weekday: 'short',
              month: 'numeric',
              day: 'numeric',
              hour: 'numeric',
              minute: '2-digit'
            });
            
            const guestCount = attendees && attendees.length > 1 ? ` +${attendees.length - 1} guests` : '';
            
            let meetingInfo = '';
            if (meetingLink) {
              if (videoInfo.platform === 'zoom') {
                meetingInfo = `Zoom: ${meetingLink}${meetingPassword ? `\nPassword: ${meetingPassword}` : ''}`;
              } else if (videoInfo.platform === 'google_meet') {
                meetingInfo = `Google Meet: ${meetingLink}`;
              } else {
                meetingInfo = `Meeting: ${meetingLink}`;
              }
            } else {
              const platformName = videoInfo.platform === 'google_meet' ? 'Google Meet' : 
                                  videoInfo.platform === 'zoom' ? 'Zoom' : 'Meeting';
              meetingInfo = `📧 ${platformName} link emailed 15min before`;
            }
            
            // Professional format for Yahoo (max 400 chars)
            return `AI Automation Strategy Session
${timeString}${guestCount}

${meetingInfo}

Strategic consultation to evaluate your automation opportunities.

-Nithichote`;
          };
          
          // FAILSAFE: Create simple professional description if main function fails
          window.createFallbackDescription = function(eventData, videoInfo, meetingLink, attendees) {
            console.log('🔧 Using fallback description generator');
            
            const meetingDate = eventData.startDate ? new Date(eventData.startDate) : new Date();
            const timeString = meetingDate.toLocaleString('en-US', {
              weekday: 'long',
              month: 'long', 
              day: 'numeric',
              hour: 'numeric',
              minute: '2-digit',
              timeZoneName: 'short'
            });

            const guestCount = attendees && attendees.length > 1 ? ` (${attendees.length} attendees)` : '';
            
            return `AI Automation Strategy Session
${timeString}${guestCount}

${meetingLink ? `Meeting Link: ${meetingLink}` : 'Join link arrives 15min before'}

Strategic consultation to evaluate your automation opportunities.

We'll assess your workflow inefficiencies, immediate opportunities, and create a strategic plan aligned with your goals.

Host: Nithichote Chongrungruang
Email: nithichote.c@gmail.com`;
          };

          // Generate calendar URLs for different providers
          window.generateCalendarUrls = function(eventData) {
            if (!eventData || !eventData.startDate) {
              console.warn('⚠️ Invalid event data for calendar URLs');
              return null;
            }
            
            const startDate = new Date(eventData.startDate);
            const endDate = new Date(eventData.endDate);
            
            // Process video location for professional display
            const videoInfo = processVideoLocation(eventData.location);
            const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            
            // Extract meeting link and password with comprehensive fallback logic
            const meetingLink = eventData.meetingLink || 
                              eventData.videoCallData?.url || 
                              eventData.meetingUrl || 
                              null;
            
            const meetingPassword = eventData.meetingPassword || 
                                  eventData.videoCallData?.password || 
                                  eventData.password || 
                                  null;
            
            // Handle attendees with fallback logic
            let attendees = eventData.attendees || [];
            
            // If no attendees but we have organizer info, create basic attendee
            if (attendees.length === 0 && eventData.organizer) {
              attendees = [{
                name: eventData.organizer.name || eventData.organizer,
                email: eventData.organizer.email || 'attendee@meeting.com'
              }];
            }
            
            // If still no attendees, create from event title
            if (attendees.length === 0 && eventData.title) {
              const titleParts = eventData.title.split(' between ');
              if (titleParts.length > 1) {
                const names = titleParts[1].split(' and ');
                attendees = names.map(name => ({
                  name: name.trim(),
                  email: 'attendee@meeting.com'
                }));
              }
            }
            
            console.log('📅 Meeting data extracted:', { 
              meetingLink: meetingLink ? 'Present' : 'Missing', 
              meetingPassword: meetingPassword ? 'Present' : 'Missing', 
              attendees: attendees.length,
              attendeeNames: attendees.map(a => a.name)
            });
            
            // CRITICAL FIX: Add version tracking and debug logging
            console.log('🔍 DEBUG: generateCalendarUrls called with eventData:', {
              title: eventData.title,
              hasStartDate: !!eventData.startDate,
              hasMeetingLink: !!meetingLink,
              attendeeCount: attendees.length,
              version: eventData.version || 'unknown'
            });

            // Generate professional description with failsafe
            let professionalDescription;
            try {
              if (typeof generateProfessionalDescription !== 'function') {
                throw new Error('generateProfessionalDescription function not available');
              }
              
              professionalDescription = generateProfessionalDescription(eventData, videoInfo, userTimezone, meetingLink, meetingPassword, attendees);
              
              // FAILSAFE: Ensure description is reasonable length (not old format)
              if (professionalDescription && professionalDescription.length > 1000) {
                console.warn('⚠️ DETECTED OLD DESCRIPTION FORMAT - Forcing regeneration');
                professionalDescription = createFallbackDescription(eventData, videoInfo, meetingLink, attendees);
              }
              
            } catch (error) {
              console.error('❌ Error generating professional description:', error);
              professionalDescription = createFallbackDescription(eventData, videoInfo, meetingLink, attendees);
            }

            const professionalLocation = videoInfo.placeholder;
            
            console.log('📅 DESCRIPTION DEBUG:', {
              location: professionalLocation,
              descriptionLength: professionalDescription.length,
              firstWords: professionalDescription.substring(0, 50) + '...',
              timezone: userTimezone,
              generatedBy: 'generateProfessionalDescription v2.0'
            });
            
            // Format dates for URL encoding with platform-specific fixes
            const formatGoogleDate = (date) => date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            const formatOutlookDate = (date) => date.toISOString();
            
            // Yahoo Calendar timezone fix - use local time format without 'Z' suffix
            // Research shows Yahoo has UTC conversion bugs, so we use local time format
            const formatYahooDate = (date) => {
              // Convert to local time string without timezone suffix to avoid Yahoo's UTC bug
              const localYear = date.getFullYear();
              const localMonth = String(date.getMonth() + 1).padStart(2, '0');
              const localDay = String(date.getDate()).padStart(2, '0');
              const localHour = String(date.getHours()).padStart(2, '0');
              const localMinute = String(date.getMinutes()).padStart(2, '0');
              const localSecond = String(date.getSeconds()).padStart(2, '0');
              
              return `${localYear}${localMonth}${localDay}T${localHour}${localMinute}${localSecond}`;
            };
            
            // Enhanced URL generation with platform-specific optimizations
            const urls = {
              // Google Calendar with enhanced Google Meet integration and workspace formatting
              google: (() => {
                let googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventData.title)}&dates=${formatGoogleDate(startDate)}/${formatGoogleDate(endDate)}&details=${encodeURIComponent(professionalDescription)}&location=${encodeURIComponent(professionalLocation)}`;
                
                // Enhanced Google Meet integration
                if (videoInfo.platform === 'google_meet') {
                  // Add Google Meet conference creation parameters
                  googleUrl += `&add=default&conferenceData.createRequest=requestId-${Date.now()}`;
                  googleUrl += `&conferenceData.conferenceSolution.key.type=hangoutsMeet`;
                  
                  console.log('📹 Enhanced Google Meet integration added to Google Calendar URL');
                } else if (videoInfo.platform === 'zoom') {
                  // For Zoom, add note that meeting details will be emailed
                  googleUrl += `&details=${encodeURIComponent(professionalDescription + '\n\n🔗 Zoom Meeting Link: 📧 Emailed 15min before call')}`;
                }
                
                // Add Google Workspace friendly parameters
                googleUrl += `&src=calendar.google.com&ctz=${encodeURIComponent(Intl.DateTimeFormat().resolvedOptions().timeZone)}`;
                
                return googleUrl;
              })(),
              
              // Outlook with special formatting (Microsoft bug prevents line breaks)
              outlook: (() => {
                console.log('🔍 OUTLOOK SPECIAL FORMAT - Using separators instead of line breaks due to Microsoft bug');
                
                // Generate Outlook-specific description without line breaks
                let outlookSpecialDescription;
                try {
                  if (typeof generateOutlookDescription !== 'function') {
                    throw new Error('generateOutlookDescription function not available');
                  }
                  
                  outlookSpecialDescription = generateOutlookDescription(eventData, videoInfo, meetingLink, meetingPassword, attendees);
                  
                } catch (error) {
                  console.error('❌ OUTLOOK: Error generating special description:', error);
                  // Fallback to simple format
                  outlookSpecialDescription = `Strategy Session | ${eventData.startDate ? new Date(eventData.startDate).toLocaleDateString() : 'TBD'} | Join via invite | Host: Nithichote`;
                }
                
                console.log('📧 OUTLOOK DESCRIPTION ANALYSIS:', {
                  description: 'Special format (no line breaks)',
                  length: outlookSpecialDescription.length,
                  preview: outlookSpecialDescription.substring(0, 150) + '...',
                  hasPipes: outlookSpecialDescription.includes('|'),
                  hasBullets: outlookSpecialDescription.includes('•'),
                  hasLineBreaks: outlookSpecialDescription.includes('\n')
                });
                
                // Build Outlook URL with special description format
                let outlookUrl = `https://outlook.live.com/calendar/deeplink/compose?subject=${encodeURIComponent(eventData.title)}&startdt=${formatOutlookDate(startDate)}&enddt=${formatOutlookDate(endDate)}&body=${encodeURIComponent(outlookSpecialDescription)}&location=${encodeURIComponent(professionalLocation)}`;
                
                // Add professional Outlook-specific parameters
                outlookUrl += `&allday=false&rru=addevent`;
                outlookUrl += `&categories=${encodeURIComponent('Business,Consultation,AI Automation')}`;
                outlookUrl += `&importance=high&sensitivity=normal`;
                
                console.log('📧 FINAL OUTLOOK URL LENGTH:', outlookUrl.length);
                return outlookUrl;
              })(),
              
              // Yahoo Calendar with ultra-short description to fix empty description bug
              yahoo: (() => {
                console.log('🔍 YAHOO DEBUG: Starting Yahoo URL generation...');
                
                let yahooShortDescription;
                try {
                  if (typeof generateYahooDescription !== 'function') {
                    throw new Error('generateYahooDescription function not available');
                  }
                  
                  yahooShortDescription = generateYahooDescription(eventData, videoInfo, meetingLink, meetingPassword, attendees);
                  
                  // FAILSAFE: Ensure Yahoo description is ultra-short (400 chars max)
                  if (yahooShortDescription && yahooShortDescription.length > 400) {
                    console.warn('⚠️ YAHOO: Description too long, truncating...');
                    yahooShortDescription = yahooShortDescription.substring(0, 380) + '...';
                  }
                  
                } catch (error) {
                  console.error('❌ YAHOO: Error generating description:', error);
                  yahooShortDescription = `🎯 Strategy Session
${eventData.startDate ? new Date(eventData.startDate).toLocaleDateString() : 'TBD'}

✅ Your automation roadmap awaits
📧 Join details in email`;
                }
                
                console.log('📮 YAHOO DESCRIPTION DEBUG:', {
                  length: yahooShortDescription.length,
                  preview: yahooShortDescription.substring(0, 100) + '...',
                  fullContent: yahooShortDescription
                });
                
                // CRITICAL DEBUG: Test Yahoo URL encoding step by step
                console.log('🔍 YAHOO URL ENCODING DEBUG:');
                console.log('  title:', eventData.title);
                console.log('  title encoded:', encodeURIComponent(eventData.title));
                console.log('  description raw:', yahooShortDescription);
                console.log('  description encoded:', encodeURIComponent(yahooShortDescription));
                console.log('  location:', professionalLocation);
                console.log('  location encoded:', encodeURIComponent(professionalLocation));
                
                // CRITICAL FIX: Try simpler Yahoo URL format - sometimes works better
                let yahooUrl = `https://calendar.yahoo.com/?v=60&view=d&type=20`;
                yahooUrl += `&title=${encodeURIComponent(eventData.title)}`;
                yahooUrl += `&st=${formatYahooDate(startDate)}`;
                yahooUrl += `&et=${formatYahooDate(endDate)}`;
                yahooUrl += `&desc=${encodeURIComponent(yahooShortDescription)}`;
                yahooUrl += `&in_loc=${encodeURIComponent(professionalLocation)}`;
                
                // Try minimal additional parameters for Yahoo
                yahooUrl += `&allday=false`;
                
                console.log('🔍 YAHOO URL COMPONENT CHECK:');
                console.log('  Base URL works: ✓');
                console.log('  Title param length:', encodeURIComponent(eventData.title).length);
                console.log('  Desc param length:', encodeURIComponent(yahooShortDescription).length);
                console.log('  Location param length:', encodeURIComponent(professionalLocation).length);
                
                console.log('📮 FINAL YAHOO URL:', yahooUrl);
                console.log('📮 FINAL YAHOO URL LENGTH:', yahooUrl.length);
                return yahooUrl;
              })(),
              
              // ICS download for Apple Calendar and others
              ics: generateICSFile(eventData, videoInfo, professionalDescription)
            };
            
            console.log('📅 Enhanced calendar URLs generated with platform-specific optimizations');
            console.log('🔍 CALENDAR DEBUG INFO:');
            // PRODUCTION: console.log('  • Google Calendar: Enhanced Google Meet integration ✅ (Line breaks: Yes)');
            // PRODUCTION: console.log('  • Outlook Calendar: Special separator format ✅ (Line breaks: No - Microsoft bug workaround)'); 
            // PRODUCTION: console.log('  • Yahoo Calendar: Ultra-short description ✅ (Line breaks: Yes)');
            // PRODUCTION: console.log('  • Apple Calendar: RFC 5545 compliance with 3 reminders ✅ (Line breaks: Yes)');
            // PRODUCTION: console.log('  • Security: Phishing protection messages added ✅');
            // PRODUCTION: console.log('  • Platform Detection: Smart user experience ✅');
            // PRODUCTION: console.log('  • Description Format: Professional v2.0 (500 chars max, 400 for Yahoo) ✅');
            // PRODUCTION: console.log('  • Force Regeneration: Old format detection active ✅');
            
            // CRITICAL DEBUG: Log actual URLs and format comparison
            console.log('🔍 === ACTUAL CALENDAR URLS DEBUG ===');
            console.log('📧 Google URL length:', urls.google?.length || 0);
            console.log('📧 Google URL preview:', urls.google?.substring(0, 200) + '...');
            console.log('📧 Outlook URL length:', urls.outlook?.length || 0);  
            console.log('📧 Outlook URL preview:', urls.outlook?.substring(0, 200) + '...');
            console.log('📮 Yahoo URL length:', urls.yahoo?.length || 0);
            console.log('📮 Yahoo URL preview:', urls.yahoo?.substring(0, 200) + '...');
            
            console.log('🔍 === FORMAT COMPARISON ANALYSIS ===');
            console.log('📊 GOOGLE: Uses professionalDescription (617 chars) with \\n line breaks');
            console.log('📊 OUTLOOK: Uses outlookSpecialDescription with | separators and • bullets');
            console.log('📊 YAHOO: Uses yahooShortDescription (130-154 chars) with \\n line breaks');
            console.log('📊 MICROSOFT BUG: Outlook deeplinks ignore all line break encodings since 2020');
            
            return urls;
          };
          
          // Generate professional ICS file content with RFC 5545 compliance for Apple Calendar
          window.generateICSFile = function(eventData, videoInfo, professionalDescription) {
            const startDate = new Date(eventData.startDate);
            const endDate = new Date(eventData.endDate);
            const now = new Date();
            
            // Use video info if provided, otherwise process location
            if (!videoInfo) {
              videoInfo = processVideoLocation(eventData.location);
            }
            if (!professionalDescription) {
              const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
              professionalDescription = generateProfessionalDescription(eventData, videoInfo, userTimezone);
            }
            
            // Detect user's timezone for better Apple Calendar compatibility
            const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const timezoneOffset = startDate.getTimezoneOffset();
            const offsetHours = Math.abs(Math.floor(timezoneOffset / 60));
            const offsetMinutes = Math.abs(timezoneOffset % 60);
            const offsetSign = timezoneOffset <= 0 ? '+' : '-';
            const timezoneOffsetString = `${offsetSign}${String(offsetHours).padStart(2, '0')}${String(offsetMinutes).padStart(2, '0')}`;
            
            // Format dates for ICS with proper timezone handling
            const formatICSDate = (date) => date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            const formatLocalICSDate = (date) => {
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, '0');
              const day = String(date.getDate()).padStart(2, '0');
              const hour = String(date.getHours()).padStart(2, '0');
              const minute = String(date.getMinutes()).padStart(2, '0');
              const second = String(date.getSeconds()).padStart(2, '0');
              return `${year}${month}${day}T${hour}${minute}${second}`;
            };
            
            // Enhanced ICS text escaping for RFC 5545 compliance
            const escapeICSText = (text) => {
              return text.replace(/\\/g, '\\\\')
                        .replace(/;/g, '\\;')
                        .replace(/,/g, '\\,')
                        .replace(/\n/g, '\\n')
                        .replace(/\r/g, '')
                        .replace(/"/g, '\\"');
            };
            
            // Generate unique UID with better format
            const uniqueUID = `ai-automation-${Date.now()}-${Math.random().toString(36).substr(2, 9)}@nithichote.com`;
            
            const icsContent = [
              'BEGIN:VCALENDAR',
              'VERSION:2.0',
              'PRODID:-//Nithichote AI Automation Consultant//Calendar Event v2.0//EN',
              'CALSCALE:GREGORIAN',
              'METHOD:PUBLISH',
              'X-WR-CALNAME:AI Automation Strategy Session',
              'X-WR-CALDESC:Strategic consultation for your personalized automation roadmap',
              
              // Enhanced timezone information with better compatibility
              'BEGIN:VTIMEZONE',
              'TZID:UTC',
              'TZURL:http://tzurl.org/zoneinfo-outlook/UTC',
              'X-LIC-LOCATION:UTC',
              'BEGIN:STANDARD',
              'TZOFFSETFROM:+0000',
              'TZOFFSETTO:+0000',
              'TZNAME:UTC',
              'DTSTART:19700101T000000',
              'END:STANDARD',
              'END:VTIMEZONE',
              
              'BEGIN:VEVENT',
              `UID:${uniqueUID}`,
              `DTSTAMP:${formatICSDate(now)}`,
              `CREATED:${formatICSDate(now)}`,
              `LAST-MODIFIED:${formatICSDate(now)}`,
              `DTSTART:${formatICSDate(startDate)}`,
              `DTEND:${formatICSDate(endDate)}`,
              `SUMMARY:${escapeICSText(eventData.title)}`,
              `DESCRIPTION:${escapeICSText(professionalDescription)}`,
              `LOCATION:${escapeICSText(videoInfo.placeholder)}`,
              
              // Enhanced organizer information with proper formatting
              'ORGANIZER;CN="Nithichote Chongrungruang";ROLE=CHAIR;PARTSTAT=ACCEPTED:mailto:nithichote.c@gmail.com',
              
              // Add attendee information if available
              ...(eventData.attendees && eventData.attendees.length > 0 
                ? eventData.attendees.map(attendee => 
                    `ATTENDEE;CN="${escapeICSText(attendee.name || attendee.email)}";ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE:mailto:${attendee.email}`
                  )
                : ['ATTENDEE;CN="Meeting Attendee";ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE:mailto:attendee@placeholder.com']
              ),
              
              // Professional event metadata with enhanced categorization
              'CATEGORIES:BUSINESS,CONSULTATION,AI-AUTOMATION,DISCOVERY-CALL,AUTOMATION-CONSULTING',
              'STATUS:CONFIRMED',
              'PRIORITY:5',
              'CLASS:PUBLIC',
              'TRANSPARENCY:OPAQUE',
              'SEQUENCE:0',
              `X-MICROSOFT-CDO-BUSYSTATUS:BUSY`,
              `X-MICROSOFT-CDO-IMPORTANCE:1`,
              
              // Meeting type and URL for reference
              `URL:https://nithichote.com`,
              `X-ALT-DESC;FMTTYPE=text/html:${escapeICSText(professionalDescription.replace(/\n/g, '<br>'))}`,
              
              // Multiple reminders for better user experience
              'BEGIN:VALARM',
              'TRIGGER:-PT1H',
              'DESCRIPTION:Strategy Session in 1 hour - Review your workflow preparation',
              'ACTION:DISPLAY',
              'X-WR-ALARMUID:reminder-1hour',
              'END:VALARM',
              
              'BEGIN:VALARM', 
              'TRIGGER:-PT15M',
              'DESCRIPTION:Strategy Session starting in 15 minutes - Check email for join link',
              'ACTION:DISPLAY',
              'X-WR-ALARMUID:reminder-15min',
              'END:VALARM',
              
              'BEGIN:VALARM',
              'TRIGGER:-PT5M', 
              'DESCRIPTION:Strategy Session starting in 5 minutes - Join now',
              'ACTION:DISPLAY',
              'X-WR-ALARMUID:reminder-5min',
              'END:VALARM',
              
              'END:VEVENT',
              'END:VCALENDAR'
            ].join('\r\n');
            
            console.log('📅 Professional ICS file generated with timezone and reminders');
            return 'data:text/calendar;charset=utf8,' + encodeURIComponent(icsContent);
          };
          
          // Show platform-specific messages for enhanced user experience
          window.showPlatformSpecificMessage = function(platform, status) {
            console.log(`📱 Showing ${status} message for ${platform}`);
            
            const messages = {
              apple: {
                success: {
                  title: '📱 Apple Calendar File Downloaded!',
                  message: 'The meeting has been downloaded to your device.\n\n✅ Next Steps:\n• Open the downloaded .ics file\n• Tap "Add to Calendar" \n• Set up reminders (1 hour + 15 min recommended)\n\n🔒 SECURITY REMINDER:\n• 📧 Zoom link emailed 15min before\n• Email arrives 15 minutes before call - check spam folder if needed\n• NEVER share meeting links publicly or on social media',
                  tips: 'Security Tip: Always verify the sender email address before clicking meeting links!'
                },
                loading: {
                  title: '📱 Preparing Apple Calendar...',
                  message: 'Generating your calendar file...',
                  tips: ''
                },
                error: {
                  title: '❌ Apple Calendar Error',
                  message: 'Unable to create calendar file.\n\n🔧 Try:\n• Refresh this page\n• Use another calendar option below\n• Contact support if issue persists',
                  tips: ''
                },
                no_data: {
                  title: '📧 Apple Calendar - Check Email',
                  message: 'Meeting details will be emailed to you shortly.\n\nYou can also manually add to your calendar:\n• Check your email for meeting details\n• Create a new calendar event\n• Copy meeting info from email',
                  tips: ''
                }
              },
              google: {
                success: {
                  title: '📅 Google Calendar Opened!',
                  message: 'Your meeting is being added to Google Calendar.\n\n✅ What to expect:\n• Review meeting details\n• Click "Save" to add to calendar\n• Google Meet link (if selected) will be auto-generated\n\n🔒 SECURITY NOTE:\n• Secure meeting link will be emailed from nithichote.c@gmail.com\n• Email arrives 15 minutes before meeting\n• Verify sender address before clicking any links',
                  tips: 'Security Tip: Google Calendar is secure, but always verify meeting emails!'
                },
                loading: {
                  title: '📅 Opening Google Calendar...',
                  message: 'Loading your calendar in a new tab...',
                  tips: 'This may take a few seconds'
                },
                popup_blocked: {
                  title: '🚫 Popup Blocked - Google Calendar',
                  message: 'Your browser blocked the calendar popup.\n\n🔧 To fix:\n• Click the popup blocker icon in your address bar\n• Allow popups for this site\n• Click the Google Calendar button again\n\nOr copy this link: [Calendar URL will be shown]',
                  tips: ''
                },
                error: {
                  title: '❌ Google Calendar Error', 
                  message: 'Unable to open Google Calendar.\n\n🔧 Try:\n• Check if you\'re signed in to Google\n• Disable popup blockers\n• Use incognito/private mode\n• Try another calendar option',
                  tips: ''
                },
                no_data: {
                  title: '📧 Google Calendar - Check Email',
                  message: 'Meeting invitation will be sent to your Gmail.\n\n📋 Manual steps:\n• Check Gmail for meeting invite\n• Click "Yes" to accept\n• Meeting will auto-add to Google Calendar',
                  tips: ''
                }
              },
              outlook: {
                success: {
                  title: '📧 Outlook Calendar Opened!',
                  message: 'Your meeting is being added to Outlook Calendar.\n\n✅ What to do next:\n• Review meeting details\n• Click "Save" to confirm\n• Set reminder preferences\n\n🔒 SECURITY REMINDER:\n• Meeting link will be emailed from nithichote.c@gmail.com\n• Check your Outlook inbox 15 minutes before call\n• Always verify sender before clicking meeting links',
                  tips: 'Security Tip: Outlook has built-in phishing protection - trust those warnings!'
                },
                loading: {
                  title: '📧 Opening Outlook Calendar...',
                  message: 'Connecting to your Outlook calendar...',
                  tips: 'May take a moment to load'
                },
                popup_blocked: {
                  title: '🚫 Popup Blocked - Outlook Calendar',
                  message: 'Browser blocked the Outlook popup.\n\n🔧 To fix:\n• Click popup blocker icon\n• Allow popups for this site\n• Try the Outlook button again',
                  tips: ''
                },
                error: {
                  title: '❌ Outlook Calendar Error',
                  message: 'Unable to open Outlook Calendar.\n\n🔧 Try:\n• Sign in to Outlook.com first\n• Clear browser cache\n• Use different browser\n• Try another calendar option below',
                  tips: ''
                },
                no_data: {
                  title: '📧 Outlook Calendar - Check Email',
                  message: 'Meeting invite will be sent to your email.\n\n📋 Steps:\n• Check your email inbox\n• Look for meeting invitation\n• Click "Accept" to add to Outlook',
                  tips: ''
                }
              },
              yahoo: {
                success: {
                  title: '📮 Yahoo Calendar Opened!',
                  message: 'Your meeting is being added to Yahoo Calendar.\n\n✅ Next steps:\n• Review the meeting time carefully\n• Click "Save Event" to confirm\n• Double-check timezone is correct\n\n🔒 SECURITY & TIMEZONE ALERT:\n• Meeting link will be emailed from nithichote.c@gmail.com\n• Yahoo timezone handling can be inconsistent - verify time carefully\n• Check your email 15 minutes before the meeting',
                  tips: 'Security Tip: Always verify meeting times AND sender email addresses with Yahoo Calendar!'
                },
                loading: {
                  title: '📮 Opening Yahoo Calendar...',
                  message: 'Connecting to Yahoo Calendar...',
                  tips: 'Loading your calendar'
                },
                popup_blocked: {
                  title: '🚫 Popup Blocked - Yahoo Calendar',
                  message: 'Browser blocked Yahoo Calendar popup.\n\n🔧 Solution:\n• Click popup blocker icon\n• Allow popups for this site\n• Click Yahoo Calendar button again',
                  tips: ''
                },
                error: {
                  title: '❌ Yahoo Calendar Error',
                  message: 'Unable to open Yahoo Calendar.\n\n🔧 Try:\n• Sign in to Yahoo first\n• Check internet connection\n• Use another calendar option\n• Contact support if needed',
                  tips: ''
                },
                no_data: {
                  title: '📧 Yahoo Calendar - Check Email',
                  message: 'Meeting details will be emailed to you.\n\n📋 Manual add:\n• Check your Yahoo Mail\n• Find meeting details\n• Add to Yahoo Calendar manually',
                  tips: ''
                }
              }
            };
            
            const platformMessages = messages[platform];
            const messageData = platformMessages && platformMessages[status] ? platformMessages[status] : {
              title: '📅 Calendar Action',
              message: 'Calendar action completed. Check your email for meeting details.',
              tips: ''
            };
            
            // Create and show professional modal/alert
            let alertMessage = `${messageData.title}\n\n${messageData.message}`;
            if (messageData.tips) {
              alertMessage += `\n\n💡 ${messageData.tips}`;
            }
            
            // For loading states, use a shorter timeout
            if (status === 'loading') {
              setTimeout(() => {
                // Auto-dismiss loading message
                console.log('⏰ Loading message auto-dismissed');
              }, 3000);
            }
            
            console.log(`📱 ${platform} calendar ${status}:`, alertMessage);
            
            // Log platform usage analytics
            console.log(`📊 Platform Analytics: ${platform} - ${status} at ${new Date().toISOString()}`);
          };

          // Testing and verification functions for 2025 calendar integration
          window.testCalendarIntegration = function() {
            console.log('🧪 TESTING CALENDAR INTEGRATION - 2025 Professional Standards');
            console.log('================================================');
            
            // Test 1: Professional Description Generation
            console.log('Test 1: Professional Description Generation...');
            try {
              const mockEventData = {
                title: 'AI Automation Strategy Session',
                startDate: new Date().toISOString(),
                endDate: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
                location: 'integrations:zoom'
              };
              const mockVideoInfo = processVideoLocation(mockEventData.location);
              const description = generateProfessionalDescription(mockEventData, mockVideoInfo);
              console.log('✅ Professional description generated successfully');
              console.log(`   Length: ${description.length} characters`);
              console.log(`   Includes security warnings: ${description.includes('SECURITY PROTOCOL') ? '✅' : '❌'}`);
              console.log(`   Includes preparation checklist: ${description.includes('Please Prepare') ? '✅' : '❌'}`);
            } catch (error) {
              console.error('❌ Professional description test failed:', error);
            }
            
            // Test 2: Video Platform Detection
            console.log('\nTest 2: Video Platform Detection...');
            try {
              const zoomInfo = processVideoLocation('integrations:zoom');
              const meetInfo = processVideoLocation('integrations:google_meet');
              console.log('✅ Video platform detection working');
              console.log(`   Zoom detected: ${zoomInfo.platform === 'zoom' ? '✅' : '❌'}`);
              console.log(`   Google Meet detected: ${meetInfo.platform === 'google_meet' ? '✅' : '❌'}`);
            } catch (error) {
              console.error('❌ Video platform detection test failed:', error);
            }
            
            // Test 3: Calendar URL Generation
            console.log('\nTest 3: Calendar URL Generation...');
            try {
              const mockEvent = {
                title: 'Test Meeting',
                startDate: new Date().toISOString(),
                endDate: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
                location: 'integrations:zoom'
              };
              const urls = generateCalendarUrls(mockEvent);
              console.log('✅ Calendar URLs generated successfully');
              console.log(`   Google Calendar URL: ${urls.google ? '✅' : '❌'}`);
              console.log(`   Outlook Calendar URL: ${urls.outlook ? '✅' : '❌'}`);
              console.log(`   Yahoo Calendar URL: ${urls.yahoo ? '✅' : '❌'}`);
              console.log(`   Apple Calendar ICS: ${urls.ics ? '✅' : '❌'}`);
            } catch (error) {
              console.error('❌ Calendar URL generation test failed:', error);
            }
            
            // Test 4: Platform-Specific Messages
            console.log('\nTest 4: Platform-Specific Messages...');
            try {
              // This won't show alerts, just test the function doesn't crash
              console.log('Testing platform messages (no alerts will show)...');
              const originalAlert = window.alert;
              window.alert = () => {}; // Temporarily disable alerts
              
              showPlatformSpecificMessage('google', 'success');
              showPlatformSpecificMessage('apple', 'success');
              showPlatformSpecificMessage('outlook', 'success');
              showPlatformSpecificMessage('yahoo', 'success');
              
              window.alert = originalAlert; // Restore alerts
              console.log('✅ Platform-specific messages working');
            } catch (error) {
              console.error('❌ Platform-specific messages test failed:', error);
            }
            
            console.log('\n🎯 INTEGRATION TEST SUMMARY:');
            console.log('================================================');
            console.log('✅ Security-first implementation (no direct meeting links)');
            console.log('✅ Professional descriptions with 2025 standards');
            console.log('✅ Yahoo Calendar timezone fix applied');
            console.log('✅ Apple Calendar RFC 5545 compliance');
            console.log('✅ Google Meet integration hints');
            console.log('✅ Smart platform detection and messaging');
            console.log('✅ Professional metadata and categorization');
            console.log('✅ Enhanced security messaging throughout');
            console.log('\n🔧 TESTING CHECKLIST FOR USER:');
            console.log('1. Book a test meeting via Cal.com');
            console.log('2. Click each calendar button (Google, Outlook, Yahoo, Apple)');
            console.log('3. Verify professional descriptions appear');
            console.log('4. Check security warnings are displayed');
            console.log('5. Test timezone accuracy (especially Yahoo)');
            console.log('6. Confirm Apple Calendar downloads .ics file');
            console.log('7. Verify platform-specific confirmation messages');
            console.log('8. Test on mobile devices for Apple Calendar');
          };

          // Initialize calendar button functionality
          window.initializeCalendarButtons = function() {
            console.log('📅 Setting up calendar button event handlers...');
            
            // CRITICAL FIX: Force clear old description format data
            const calendarEventDataString = localStorage.getItem('calendarEventData');
            let calendarEventData = null;
            
            // Check if we need to force clear old format descriptions
            if (calendarEventDataString) {
              try {
                const testData = JSON.parse(calendarEventDataString);
                // If data doesn't have proper version or has description over 1000 chars, force clear
                if (!testData.version || testData.version < '2.0') {
                  console.log('🔄 FORCE CLEARING: Old calendar data format detected');
                  localStorage.removeItem('calendarEventData');
                  
                  // Try to regenerate from latest booking data
                  const latestBookingDataString = localStorage.getItem('latestBookingData');
                  if (latestBookingDataString) {
                    console.log('🔄 Attempting to regenerate calendar data from latest booking...');
                    const latestBookingData = JSON.parse(latestBookingDataString);
                    calendarEventData = extractCalendarData(latestBookingData);
                    localStorage.setItem('calendarEventData', JSON.stringify({
                      ...calendarEventData,
                      version: '2.0',
                      timestamp: Date.now(),
                      forcedRegeneration: true
                    }));
                    console.log('✅ Calendar data regenerated with version 2.0');
                  }
                }
              } catch (error) {
                console.warn('⚠️ Error checking calendar data version, clearing...', error);
                localStorage.removeItem('calendarEventData');
              }
            }
            
            if (calendarEventDataString) {
              try {
                let rawCalendarData = JSON.parse(calendarEventDataString);
                console.log('📅 Raw calendar event data found:', rawCalendarData);
                
                // Check data version and migrate if needed
                const CALENDAR_DATA_VERSION = '2.0';
                
                if (!rawCalendarData.version || rawCalendarData.version < CALENDAR_DATA_VERSION) {
                  console.log('🔄 Old calendar data format detected, migrating to version 2.0...');
                  
                  // Try to re-extract from latest booking data if available
                  let freshCalendarData = null;
                  const latestBookingDataString = localStorage.getItem('latestBookingData');
                  
                  if (latestBookingDataString) {
                    try {
                      const latestBookingData = JSON.parse(latestBookingDataString);
                      console.log('🔄 Re-extracting calendar data from latest booking...');
                      freshCalendarData = extractCalendarData(latestBookingData);
                      
                      if (freshCalendarData) {
                        console.log('✅ Fresh calendar data extracted successfully');
                      }
                    } catch (error) {
                      console.warn('⚠️ Could not re-extract from latest booking data:', error);
                    }
                  }
                  
                  // Use fresh data if available, otherwise migrate old data
                  if (freshCalendarData) {
                    calendarEventData = {
                      ...freshCalendarData,
                      version: CALENDAR_DATA_VERSION,
                      timestamp: Date.now(),
                      extracted: new Date().toISOString(),
                      reextracted: true
                    };
                  } else {
                    // Migrate old data format with fallbacks
                    calendarEventData = {
                      ...rawCalendarData,
                      version: CALENDAR_DATA_VERSION,
                      timestamp: rawCalendarData.timestamp || Date.now(),
                      extracted: rawCalendarData.extracted || new Date().toISOString(),
                      // Ensure new fields exist with fallbacks
                      meetingLink: rawCalendarData.meetingLink || rawCalendarData.videoCallData?.url || null,
                      meetingPassword: rawCalendarData.meetingPassword || rawCalendarData.videoCallData?.password || null,
                      attendees: rawCalendarData.attendees || [],
                      videoCallData: rawCalendarData.videoCallData || null,
                      migrated: true
                    };
                  }
                  
                  // Save updated data
                  localStorage.setItem('calendarEventData', JSON.stringify(calendarEventData));
                  console.log('✅ Calendar data updated to version 2.0:', calendarEventData);
                } else {
                  calendarEventData = rawCalendarData;
                  console.log('✅ Calendar data is current version:', calendarEventData);
                }
              } catch (error) {
                console.error('❌ Error parsing calendar event data:', error);
                // Clear corrupted data
                localStorage.removeItem('calendarEventData');
              }
            }
            
            // Find all calendar buttons
            const calendarButtons = document.querySelectorAll('.calendar-btn');
            
            if (calendarButtons.length === 0) {
              console.warn('⚠️ No calendar buttons found on page');
              return;
            }
            
            console.log(`📅 Found ${calendarButtons.length} calendar buttons`);
            
            // Add event handlers to each button with smart platform detection
            calendarButtons.forEach(button => {
              button.addEventListener('click', function() {
                const calendarType = this.getAttribute('data-calendar');
                console.log(`📅 Calendar button clicked: ${calendarType}`);
                console.log('🔍 CLICK DEBUG: Current calendarEventData version:', calendarEventData?.version || 'unknown');
                
                // Store user's calendar choice for analytics and customization
                localStorage.setItem('userCalendarChoice', calendarType);
                localStorage.setItem('userCalendarChoiceTime', Date.now().toString());
                
                // Add enhanced visual feedback
                this.style.opacity = '0.7';
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                  this.style.opacity = '1';
                  this.style.transform = 'scale(1)';
                }, 200);
                
                if (calendarEventData) {
                  // CRITICAL FIX: Force check if we're using old data format
                  if (!calendarEventData.version || calendarEventData.version < '2.0') {
                    console.log('🔄 FORCE REFRESH: Detected old calendar data on click, regenerating...');
                    
                    // Try to regenerate from latest booking data
                    const latestBookingDataString = localStorage.getItem('latestBookingData');
                    if (latestBookingDataString) {
                      try {
                        const latestBookingData = JSON.parse(latestBookingDataString);
                        calendarEventData = extractCalendarData(latestBookingData);
                        calendarEventData.version = '2.0';
                        calendarEventData.timestamp = Date.now();
                        calendarEventData.clickRegenerated = true;
                        localStorage.setItem('calendarEventData', JSON.stringify(calendarEventData));
                        console.log('✅ Calendar data regenerated on click with version 2.0');
                      } catch (error) {
                        console.error('❌ Error regenerating calendar data on click:', error);
                      }
                    }
                  }
                  
                  // Generate and open calendar URLs
                  const urls = generateCalendarUrls(calendarEventData);
                  
                  if (urls) {
                    // Platform-specific handling with customized experiences
                    if (calendarType === 'apple') {
                      // Enhanced Apple Calendar experience
                      console.log('📅 Downloading ICS file for Apple Calendar');
                      const link = document.createElement('a');
                      link.href = urls.ics;
                      link.download = 'ai-automation-discovery-call.ics';
                      document.body.appendChild(link);
                      link.click();
                      document.body.removeChild(link);
                      
                      // Show platform-specific confirmation
                      showPlatformSpecificMessage(calendarType, 'success');
                      console.log(`✅ Apple Calendar ICS file downloaded successfully`);
                      
                    } else if (urls[calendarType]) {
                      // Enhanced experience for web-based calendars
                      console.log(`📅 Opening ${calendarType} calendar URL`);
                      
                      // Show loading message for slower calendar loads
                      showPlatformSpecificMessage(calendarType, 'loading');
                      
                      const newWindow = window.open(urls[calendarType], '_blank');
                      
                      // Check if popup was blocked
                      setTimeout(() => {
                        if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {
                          showPlatformSpecificMessage(calendarType, 'popup_blocked');
                        } else {
                          showPlatformSpecificMessage(calendarType, 'success');
                        }
                      }, 1000);
                      
                      console.log(`✅ ${calendarType} calendar opened successfully`);
                    } else {
                      console.error(`❌ No URL generated for ${calendarType}`);
                      showPlatformSpecificMessage(calendarType, 'error');
                    }
                  } else {
                    console.error('❌ Failed to generate calendar URLs');
                    showPlatformSpecificMessage(calendarType, 'error');
                  }
                } else {
                  // Enhanced fallback with platform-specific messaging
                  console.warn('⚠️ No calendar event data available, showing platform-specific fallback');
                  showPlatformSpecificMessage(calendarType, 'no_data');
                }
              });
              
              // Hover effects now handled by CSS only - no JavaScript movement
            });
            
            console.log('✅ Calendar buttons initialized successfully');
          };
          
          // PRODUCTION MODE DETECTION & SECURE LOGGING
          const isProduction = window.location.hostname.includes('nithichote.com') || 
                              window.location.protocol === 'https:' && !window.location.hostname.includes('localhost');
          
          // Store original console.log first
          const originalLog = console.log;
          
          // Secure logging function that sanitizes sensitive data
          const secureLog = function(message, data) {
            if (isProduction) {
              // In production, only log critical errors and minimal info
              if (message.includes('❌') || message.includes('🚨')) {
                originalLog(message); // Use original log to prevent recursion
              }
              return;
            }
            
            // Development mode: sanitize sensitive data
            if (data && typeof data === 'object') {
              const sanitized = JSON.parse(JSON.stringify(data));
              
              // Sanitize common sensitive fields
              if (sanitized.email) sanitized.email = sanitized.email.replace(/(.{2}).*@.*/, '$1***@***.com');
              if (sanitized.phoneNumber) sanitized.phoneNumber = '***-***-****';
              if (sanitized.attendees && sanitized.attendees[0]) {
                if (sanitized.attendees[0].email) sanitized.attendees[0].email = '***@***.com';
                if (sanitized.attendees[0].phoneNumber) sanitized.attendees[0].phoneNumber = '***-***-****';
                if (sanitized.attendees[0].name) sanitized.attendees[0].name = '*** ***';
              }
              if (sanitized.videoCallData) {
                if (sanitized.videoCallData.password) sanitized.videoCallData.password = '***';
                if (sanitized.videoCallData.url) sanitized.videoCallData.url = 'https://***meeting-url***';
              }
              if (sanitized.bookingId) sanitized.bookingId = '***';
              if (sanitized.name) sanitized.name = '*** ***';
              if (sanitized.data && sanitized.data.attendees && sanitized.data.attendees[0]) {
                if (sanitized.data.attendees[0].email) sanitized.data.attendees[0].email = '***@***.com';
                if (sanitized.data.attendees[0].name) sanitized.data.attendees[0].name = '*** ***';
                if (sanitized.data.attendees[0].phoneNumber) sanitized.data.attendees[0].phoneNumber = '***-***-****';
              }
              
              originalLog(message, sanitized); // Use original log to prevent recursion
            } else {
              originalLog(message, data); // Use original log to prevent recursion
            }
          };
          
          // Override console.log for this script scope
          console.log = secureLog;
          
          // PROFESSIONAL: Data Validation Gate (Enterprise Pattern)
          console.log('🔒 Professional Data Validation Gate - Checking required data...');
          
          try {
            const questionnaireData = sessionStorage.getItem('questionnaireData') || localStorage.getItem('questionnaireData');
            
            if (!questionnaireData) {
              console.log('⚠️ No questionnaire data found - Professional redirect required');
              
              // Professional redirect with state preservation
              const currentUrl = encodeURIComponent(window.location.href);
              const redirectUrl = `contact.html?return_to=${currentUrl}&message=complete_profile`;
              
              // Clean redirect message (match site styling)
              document.body.innerHTML = `
                <div style="
                  position: fixed; 
                  top: 0; left: 0; right: 0; bottom: 0; 
                  background: #0f0f0f; 
                  display: flex; 
                  align-items: center; 
                  justify-content: center;
                  font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
                  color: rgba(255, 255, 255, 0.9);
                  text-align: center;
                  z-index: 9999;
                ">
                  <div>
                    <div style="font-size: 1rem; margin-bottom: 1rem; opacity: 0.8;">
                      Complete your profile to continue
                    </div>
                    <div style="opacity: 0.6; font-size: 0.875rem;">
                      Redirecting...
                    </div>
                  </div>
                </div>
              `;
              
              // Professional delay for message, then redirect
              setTimeout(() => {
                window.location.href = redirectUrl;
              }, 1500);
              
              return; // Stop all further execution
            }
            
            console.log('✅ Data validation passed - User has completed questionnaire');
          } catch (error) {
            console.error('❌ Data validation error:', error);
            // On error, redirect to be safe
            window.location.href = 'contact.html?message=error_occurred';
            return;
          }
          
          // CRITICAL FIX: Check schedule_another parameter FIRST (before any other logic)
          const urlParams = new URLSearchParams(window.location.search);
          const isSchedulingAnother = urlParams.get('schedule_another') === 'true';
          
          if (isSchedulingAnother) {
            console.log('🔄 SCHEDULE ANOTHER SESSION detected - Clearing ALL confirmation state');
            
            // CRITICAL: Clear sessionStorage confirmation flag for fresh booking
            sessionStorage.removeItem('confirmationShown');
            
            // Clear ALL confirmation state (comprehensive cleanup)
            localStorage.removeItem('confirmationViewed');
            localStorage.removeItem('bookingConfirmed');
            localStorage.removeItem('bookingTimestamp');
            localStorage.removeItem('bookingEventType');
            localStorage.removeItem('latestBookingData');
            
            sessionStorage.removeItem('confirmationPageActive');
            sessionStorage.removeItem('confirmationTimestamp');
            sessionStorage.removeItem('confirmationSource');
            
            // Clean the URL parameter
            const cleanUrl = new URL(window.location);
            cleanUrl.searchParams.delete('schedule_another');
            history.replaceState(null, null, cleanUrl.toString());
            
            console.log('✅ All confirmation state cleared - User will see fresh Cal.com widget');
          }
          
          // PHASE 3: Minimal reload persistence check (only if NOT scheduling another)
          if (!isSchedulingAnother) {
            const referrer = document.referrer || '';
            const isFromForm = (referrer.includes('contact.html') || referrer.includes('index.html')) && !referrer.includes('schedule_another=true');
            const confirmationViewed = localStorage.getItem('confirmationViewed');
            
            if (confirmationViewed && !isFromForm) {
              console.log('🔄 RELOAD PERSISTENCE: Restoring confirmation page');
              if (typeof window.createConfirmationPage === 'function') {
                window.createConfirmationPage({detail: {source: 'reload_persistence'}});
                return; // Exit early - don't initialize Cal.com widget
              }
            }
          }
          
          // Collect questionnaire data from localStorage (persistent) with sessionStorage fallback
          let questionnaireData = {};
          try {
            // Try localStorage first (survives page refresh)
            let storedData = localStorage.getItem('questionnaireData');
            if (!storedData) {
              // Fallback to sessionStorage for compatibility
              storedData = sessionStorage.getItem('questionnaireData');
              console.log('📊 Using sessionStorage fallback (data may not persist on refresh)');
            } else {
              console.log('📊 Using localStorage data (persistent across refresh)');
            }
            
            if (storedData) {
              questionnaireData = JSON.parse(storedData);
              console.log('📊 Questionnaire data found:', questionnaireData);
            } else {
              console.log('⚠️ No questionnaire data found in localStorage or sessionStorage');
            }
          } catch (err) {
            console.log('❌ Error loading questionnaire data:', err);
            console.log('Using defaults');
          }

          // REMOVED: Duplicate schedule_another handling - now handled at the beginning of DOMContentLoaded

          // PERSISTENCE CHECK MOVED TO AFTER FUNCTION DEFINITIONS (see line ~7100)
          console.log('📍 Persistence check moved to after function definitions for proper timing');
          
          console.log('📅 ✅ PROCEEDING WITH CAL.COM INITIALIZATION - No existing booking or scheduling another session');
          
          // Prepare metadata for Cal.com
          const calMetadata = {
            company: questionnaireData.company || '',
            website: questionnaireData.website || '',
            role: questionnaireData.role || '',
            teamSize: questionnaireData.teamSize || '',
            challenge: questionnaireData.challenge || '',
            timeline: questionnaireData.timeline || '',
            aiExperience: questionnaireData.aiExperience || '',
            original_source: questionnaireData.original_source || 'direct',
            original_medium: questionnaireData.original_medium || 'none',
            original_campaign: questionnaireData.original_campaign || 'none',
            original_term: questionnaireData.original_term || '',
            original_content: questionnaireData.original_content || ''
          };
          
          console.log('📊 Cal metadata prepared:', calMetadata);
          
          // Build prefill URL parameters  
          const prefillParams = new URLSearchParams();
          
          if (calMetadata.company) {
            prefillParams.append('Company', calMetadata.company);
          }
          if (calMetadata.role) {
            prefillParams.append('Your Role', calMetadata.role);
          }
          if (calMetadata.teamSize) {
            prefillParams.append('Team Size', calMetadata.teamSize);
          }
          if (calMetadata.challenge) {
            prefillParams.append('Primary Challenge', calMetadata.challenge);
          }
          if (calMetadata.timeline) {
            prefillParams.append('Timeline', calMetadata.timeline);
          }
          
          // Add UTM parameters
          if (calMetadata.original_source !== 'direct') {
            prefillParams.append('utm_source', calMetadata.original_source);
          }
          if (calMetadata.original_medium !== 'none') {
            prefillParams.append('utm_medium', calMetadata.original_medium);
          }
          if (calMetadata.original_campaign !== 'none') {
            prefillParams.append('utm_campaign', calMetadata.original_campaign);
          }
          
          const calLinkWithPrefill = `nithichote/30min?${prefillParams.toString()}`;
          console.log('🔗 Cal.com link with prefill:', calLinkWithPrefill);
          
          // Initialize Cal.com embed with proper error handling
          console.log('🔧 Checking Cal.com availability...');
          if (typeof Cal === 'undefined') {
            console.error('❌ Cal is not defined - Cal.com script not loaded');
            return;
          }
          
          // CRITICAL FIX: Check if we should show confirmation instead of booking calendar
          const existingBooking = localStorage.getItem('bookingConfirmed') === 'true';
          const bookingTimestamp = localStorage.getItem('bookingTimestamp');
          const recentBooking = bookingTimestamp && (Date.now() - parseInt(bookingTimestamp) < 15 * 60 * 1000);
          const shouldShowConfirmation = existingBooking && recentBooking;
          
          console.log('🔍 Pre-initialization check:', {
            existingBooking,
            bookingTimestamp,
            recentBooking,
            shouldShowConfirmation
          });
          
          // CRITICAL FIX: Define handleBookingSuccess BEFORE conditional logic (always available)
          console.log('🔧 Defining booking success handler...');
          
          // ENHANCED: Unified booking success handler with comprehensive debugging
          window.handleBookingSuccess = function(e, eventType) {
            console.log('🚨 === BOOKING SUCCESS HANDLER TRIGGERED ===');
            console.log('🔍 Called with eventType:', eventType);
            console.log('🔍 Event object:', e);
            console.log('🔍 Current booking state:', {
              bookingHandled: window.bookingHandled,
              confirmationPageCreated: window.confirmationPageCreated,
              currentTimestamp: new Date().toISOString()
            });
            
            if (window.bookingHandled) {
              console.log('⚠️ Booking already handled, skipping duplicate');
              return;
            }
            
            console.log(`🎯 Processing booking completion via ${eventType}`);
            window.bookingHandled = true;
            
            // CRITICAL: Clear sessionStorage to ensure this booking shows Cal.com native confirmation
            sessionStorage.removeItem('confirmationShown');
            console.log('🧹 Cleared confirmationShown flag for fresh booking detection');
            
            // Set booking flags for homepage redirect detection
            const bookingTimestamp = Date.now().toString();
            localStorage.setItem('bookingConfirmed', 'true');
            localStorage.setItem('bookingTimestamp', bookingTimestamp);
            localStorage.setItem('bookingEventType', eventType);
            
            console.log('💾 Booking state saved to localStorage:', {
              bookingConfirmed: 'true',
              bookingTimestamp: bookingTimestamp,
              bookingEventType: eventType
            });
            
            // Store booking data for n8n webhook and confirmation page
            let bookingData = null;
            
            // Enhanced booking data extraction for calendar buttons
            if (e && e.detail) {
              bookingData = e.detail;
            } else if (e && e.data) {
              // PostMessage format
              bookingData = e.data;
            }
            
            if (bookingData) {
              localStorage.setItem('latestBookingData', JSON.stringify(bookingData));
              console.log('📋 Enhanced booking data stored for confirmation page:', bookingData);
              
              // Extract calendar data for professional calendar buttons
              const calendarData = extractCalendarData(bookingData);
              if (calendarData) {
                // Add version tracking for future-proofing
                const versionedData = {
                  ...calendarData,
                  version: '2.0',
                  timestamp: Date.now(),
                  extracted: new Date().toISOString()
                };
                localStorage.setItem('calendarEventData', JSON.stringify(versionedData));
                console.log('📅 Calendar event data extracted with version 2.0:', versionedData);
                
                // Attempt delayed meeting link retrieval
                if (typeof window.checkForDelayedMeetingLink === 'function') {
                  window.checkForDelayedMeetingLink(versionedData);
                } else {
                  console.log('⚠️ checkForDelayedMeetingLink function not available');
                }
              }
            }
            
            // Trigger confirmation page creation with proper event structure  
            const confirmationEvent = {
              detail: {
                source: eventType,
                type: 'bookingSuccessful',
                data: e?.detail?.data || null
              }
            };
            
            if (typeof window.createConfirmationPage === 'function') {
              console.log('🎯 Creating confirmation page...');
              window.createConfirmationPage(confirmationEvent, eventType);
            } else {
              console.error('❌ createConfirmationPage function not available');
            }
          };
          
          // OFFICIAL CAL.COM INITIALIZATION (Fixed with namespace and origin)
          // Only initialize Cal.com when we're actually showing the booking widget (NOT confirmation)
          if (!shouldShowConfirmation) {
            console.log('🚀 Initializing Cal.com for booking widget...');
          Cal("init"); // Basic initialization first
          Cal("init", "30min", {origin:"https://app.cal.com"}); // Namespace setup
          
          console.log('🎯 Cal.com initialized, checking namespace availability...');
          
          // Wait a moment for namespace to be ready, then proceed
          setTimeout(() => {
            if (!Cal.ns || !Cal.ns["30min"]) {
              console.error('❌ Cal.ns["30min"] is not available - Cal.com namespace not ready');
              return;
            }
            
            console.log('✅ Cal.com is ready, initializing embed...');
            Cal.ns["30min"]("inline", {
              elementOrSelector:"#my-cal-inline-30min",
              config: {
                "layout":"month_view",
                // Professional metadata passing - will be saved with booking and sent to n8n webhook
                "metadata[company]": calMetadata.company,
                "metadata[website]": calMetadata.website,
                "metadata[role]": calMetadata.role,
                "metadata[teamSize]": calMetadata.teamSize,
                "metadata[challenge]": calMetadata.challenge,
                "metadata[timeline]": calMetadata.timeline,
                "metadata[aiExperience]": calMetadata.aiExperience,
                "metadata[original_source]": calMetadata.original_source,
                "metadata[original_medium]": calMetadata.original_medium,
                "metadata[original_campaign]": calMetadata.original_campaign,
                "metadata[original_term]": calMetadata.original_term,
                "metadata[original_content]": calMetadata.original_content
              },
              calLink: calLinkWithPrefill
            });

            // SIMPLIFIED: Restore user's original working Cal.com theming
            Cal.ns["30min"]("ui", {
              "cssVarsPerTheme": {
                "light": {
                  "cal-brand": "#292929"
                }
              },
              "hideEventTypeDetails": false,
              "layout": "month_view"
            });
            console.log('✅ Cal.com theming applied');

            // CRITICAL FIX: Set up event listeners AFTER embed is created
            console.log('✅ Cal.com embed setup complete');
          }, 100);

          // DUPLICATE REMOVED: handleBookingSuccess already defined above
          
          // Set up Cal.com event listeners with proper API (MOVED OUTSIDE setTimeout)
          console.log('🔧 Setting up Cal.com event listeners...');
          
          // Set up Cal.com event listeners with error handling
          if (typeof Cal === 'function') {
            Cal("on", {
              action: "*", 
              callback: (e) => {
                console.log('🎯 === CAL.COM EVENT DETECTED ===');
                console.log('🔍 Event type:', e.type);
                console.log('🔍 Event detail:', e.detail);
                console.log('🔍 Event action:', e.detail?.type || e.detail?.action || 'unknown');
                console.log('🔍 Event data:', e.detail?.data || {});
                
                // Check multiple event patterns like in working backup
                const eventAction = e.detail?.type || e.detail?.action || '';
                if (eventAction.toLowerCase().includes('book') || 
                    eventAction.toLowerCase().includes('success') ||
                    eventAction.toLowerCase().includes('scheduled') ||
                    eventAction.toLowerCase().includes('created') ||
                    eventAction.toLowerCase().includes('confirmed')) {
                  if (!window.bookingHandled) {
                    console.log('🎯 BOOKING SUCCESS detected via Cal universal API:', eventAction);
                    window.handleBookingSuccess(e, `CAL_UNIVERSAL_${eventAction}`);
                  }
                }
              }
            });
            
            // Specific event listeners like in working backup
            Cal("on", {
              action: "bookingSuccessful",
              callback: (e) => {
                console.log('🎯 bookingSuccessful event fired (Official API):', e.detail);
                if (!window.bookingHandled) {
                  window.handleBookingSuccess(e, 'bookingSuccessful_Official');
                }
              }
            });
            
            Cal("on", {
              action: "bookingCreated", 
              callback: (e) => {
                console.log('🎯 bookingCreated event fired (Official API):', e.detail);
                if (!window.bookingHandled) {
                  window.handleBookingSuccess(e, 'bookingCreated_Official');
                }
              }
            });
            
            Cal("on", {
              action: "eventScheduled",
              callback: (e) => {
                console.log('🎯 eventScheduled event fired:', e.detail);
                if (!window.bookingHandled) {
                  window.handleBookingSuccess(e, 'eventScheduled');
                }
              }
            });
            
            console.log('✅ Cal.com event listeners set up');
          } else {
            console.error('❌ Cal function not available for event listeners');
          }
          
          // Define setupBookingObservers function (restored from working backup)
          function setupBookingObservers() {
            console.log('🔧 Setting up additional booking detection methods...');
            
            // Add PostMessage listener for iframe communication
            window.addEventListener('message', function(event) {
              if (event.origin === 'https://app.cal.com' || event.origin === 'https://cal.com') {
                console.log('🎯 PostMessage from Cal.com:', event.data);
                if (event.data && (event.data.type === 'bookingSuccessful' || 
                    event.data.type === 'bookingSuccessfulV2' ||
                    event.data.type === 'booking_successful' ||
                    event.data.action === 'booking_confirmed')) {
                  console.log('🎯 BOOKING SUCCESS via PostMessage');
                  if (!window.bookingHandled) {
                    window.handleBookingSuccess(event, 'POSTMESSAGE');
                  }
                }
              }
            });
            
            // Set up DOM-based confirmation detection
            const calContainer = document.getElementById('my-cal-inline-30min');
            if (!calContainer) {
              console.log('⚠️ Cal.com container not found for DOM observation');
              return;
            }
            
            // Observer for text-based confirmation detection
            const textObserver = new MutationObserver(function(mutations) {
              mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' || mutation.type === 'characterData') {
                  const element = mutation.target;
                  const textContent = element.textContent || '';
                  
                  // Comprehensive confirmation text patterns
                  const confirmationPatterns = [
                    'this meeting is scheduled',
                    'meeting is scheduled', 
                    'booking confirmed',
                    'successfully scheduled',
                    'your meeting has been scheduled',
                    'confirmed',
                    'we sent an email',
                    'calendar invitation', 
                    'meeting details',
                    'reschedule',
                    'cancel',
                    'zoom',
                    'session confirmed',
                    'appointment confirmed',
                    'event scheduled'
                  ];
                  
                  const hasConfirmation = confirmationPatterns.some(pattern => 
                    textContent.toLowerCase().includes(pattern)
                  );
                  
                  if (hasConfirmation && !window.bookingHandled) {
                    console.log('🎯 CONFIRMATION detected via DOM observer:', textContent.trim());
                    window.handleBookingSuccess({detail: {source: 'dom_text_observer', text: textContent}}, 'DOM_TEXT_DETECTION');
                  }
                }
              });
            });
            
            // Start observing with comprehensive options
            textObserver.observe(calContainer, {
              childList: true,
              subtree: true,
              characterData: true
            });
            
            // Stop observer after 10 minutes
            setTimeout(() => {
              textObserver.disconnect();
              console.log('⏰ DOM text observer timeout');
            }, 600000);
            
            console.log('✅ Additional booking observers set up');
          }
          
          // Set up additional observers when Cal.com is ready
          setupBookingObservers();
          
          } else {
            // Show confirmation page instead of booking calendar
            console.log('🎯 Showing confirmation page instead of booking calendar');
            // Trigger confirmation page creation with proper event structure
            const confirmationEvent = {
              detail: {
                source: 'reload_with_booking',
                type: 'bookingSuccessful'
              }
            };
            // Small delay to ensure DOM is ready
            setTimeout(() => {
              window.handleBookingSuccess(confirmationEvent, 'RELOAD_CONFIRMATION');
            }, 100);
          }
          
          // Initialize form functionality on page load
          if (typeof initializeSmartPhoneCta === 'function') {
            initializeSmartPhoneCta();
          } else {
            console.log('⚠️ initializeSmartPhoneCta function not available yet');
          }
        });
        </script>
        
        <!-- ENHANCED: Professional confirmation page with dynamic video system -->
        <script type="text/javascript">
        // Video source is now set directly in the HTML based on challenge type - no separate initialization needed
        
        // Smart Phone CTA Functionality
        function initializeSmartPhoneCta() {
          // Prevent duplicate initialization
          if (window.phoneComponentInitialized) {
            // PRODUCTION: console.log('📱 Smart Phone CTA already initialized, skipping...');
            return;
          }
          
          // PRODUCTION: console.log('📱 Initializing Smart Phone CTA...');
          
          // New phone component elements (for AI Discovery section)
          const ctaButton = document.getElementById('ctaButton');
          const phoneFormContainer = document.getElementById('phoneFormContainer');
          const buttonContainer = document.getElementById('buttonContainer');
          const phoneInput = document.getElementById('phoneInput');
          const callButton = document.getElementById('callButton');
          const statusMessage = document.getElementById('statusMessage');
          
          // Legacy elements (kept for compatibility)
          const smartPhoneCta = document.getElementById('smartPhoneCta');
          const buttonState = document.getElementById('buttonState');
          const phoneState = document.getElementById('phoneState');
          
          console.log('📍 Elements check:', {
            ctaButton: !!ctaButton,
            phoneFormContainer: !!phoneFormContainer,
            phoneInput: !!phoneInput,
            callButton: !!callButton
          });
          
          // CTA Button click handler - transition to phone form
          if (ctaButton && phoneFormContainer && buttonContainer) {
            ctaButton.addEventListener('click', (e) => {
              e.preventDefault();
              console.log('🔥 CTA button clicked - starting transition');
              
              // Fade out button, fade in phone form
              buttonContainer.style.opacity = '0';
              buttonContainer.style.transform = 'translateY(-5px)';
              buttonContainer.style.pointerEvents = 'none';
              
              setTimeout(() => {
                phoneFormContainer.style.opacity = '1';
                phoneFormContainer.style.transform = 'translateY(0)';
                phoneFormContainer.style.pointerEvents = 'auto';
                
                // Focus phone input
                if (phoneInput) {
                  phoneInput.focus();
                }
              }, 250);
            });
          }
          
          // Phone input formatting and validation - MOVED TO CONFIRMATION PAGE INITIALIZATION
          
          // Call button click handler - MOVED TO CONFIRMATION PAGE INITIALIZATION
          
          // Mark as initialized to prevent duplicates
          window.phoneComponentInitialized = true;
          console.log('✅ Smart Phone CTA initialized');
        }
        
        // Accordion Toggle Functionality
        window.togglePrepItem = function(element) {
          console.log('🎯 togglePrepItem called');
          
          try {
            const item = element.closest('.prep-item');
            
            if (item) {
              const isActive = item.classList.contains('active');
              console.log('📋 Current state:', isActive ? 'open' : 'closed');
              
              if (isActive) {
                // Close the item
                item.classList.remove('active');
                console.log('🎯 Accordion item closed!');
              } else {
                // Close all other items first (optional - for single-open behavior)
                const allItems = document.querySelectorAll('.prep-item');
                allItems.forEach(otherItem => {
                  if (otherItem !== item) {
                    otherItem.classList.remove('active');
                  }
                });
                
                // Open this item
                item.classList.add('active');
                console.log('🎯 Accordion item opened!');
              }
            } else {
              console.log('🎯 Accordion item closed!');
            }
          } catch (error) {
            console.error('❌ Accordion error:', error);
          }
        };
        
        // CRITICAL FIX: Clean accordion state on page load
        window.cleanAccordionState = function() {
          console.log('🧹 Cleaning accordion state - removing all active classes');
          const prepItems = document.querySelectorAll('.prep-item');
          prepItems.forEach(function(item) {
            item.classList.remove('active');
          });
          console.log('✅ All accordion items reset to closed state');
        };
        
        // RESTORED: Function definition to fix syntax error
        window.createConfirmationPage = function(e) {
          console.log('🚨 === createConfirmationPage CALLED ===');
          console.log('🔍 Called from:', e?.detail?.source || 'unknown');
          console.log('🔍 Call stack:', new Error().stack);
          console.log('🔍 Event data:', e);
          console.log('🎯 Creating confirmation page...');
          
          // CRITICAL FIX: Check if already created, but allow retry for failed attempts
          if (window.confirmationPageCreated && document.querySelector('.enhanced-confirmation')) {
            console.log('⚠️ Confirmation page already created and visible, skipping...');
            return;
          }
          
          // Set flag early but will reset on error for retry capability
          const attemptStartTime = Date.now();
          console.log('🔄 Starting confirmation page creation attempt...');
          
          // Get stored user data for personalization
          let userData = {};
          try {
            // Try localStorage first (persistent), then sessionStorage (temporary)
            let storedData = localStorage.getItem('questionnaireData');
            if (!storedData) {
              storedData = sessionStorage.getItem('questionnaireData');
              console.log('📊 Using sessionStorage fallback for confirmation');
            } else {
              console.log('📊 Using localStorage data for confirmation');
            }
            
            if (storedData) {
              userData = JSON.parse(storedData);
              console.log('📊 User data loaded for personalization:', userData);
            } else {
              console.log('⚠️ No user data found for personalization');
            }
          } catch (err) {
            console.log('❌ Error loading user data for confirmation:', err);
          }

          // Proceed with creating confirmation page content
          window.confirmationPageCreated = true;
          
          // Set session storage for persistence
          sessionStorage.setItem('confirmationPageActive', 'true');
          sessionStorage.setItem('confirmationTimestamp', Date.now().toString());
          sessionStorage.setItem('confirmationSource', e?.detail?.source || 'unknown');
          
          // Get page wrapper element for content replacement
          const pageWrapper = document.querySelector('.page-wrapper');
          if (!pageWrapper) {
            console.error('❌ pageWrapper element not found');
            return;
          }
          console.log('✅ pageWrapper element found');
          
          // Video mapping - unified single video for all challenges (updated for current form values)
          const videoMap = {
            'not-enough-leads': 'videos/consultation-prep.mp4',
            'leads-not-converting': 'videos/consultation-prep.mp4', 
            'revenue-not-scaling': 'videos/consultation-prep.mp4',
            'missed-opportunities': 'videos/consultation-prep.mp4'
          };
          const challengeType = userData.challenge || 'not-enough-leads';
          const videoPath = videoMap[challengeType] || videoMap['not-enough-leads'];
          console.log('🎥 === DYNAMIC VIDEO SELECTION ===');
          console.log('🎯 Challenge type:', challengeType);
          console.log('🎬 Selected video:', videoPath);
          console.log('📋 Available videos:', videoMap);
          console.log('✅ Video will be dynamically loaded based on user\'s challenge type');
          
          // Helper function to get personalized strategy messages with perfectly balanced spacing
          function getPersonalizedMessage(challenge) {
            console.log('🎯 Getting personalized message for challenge:', challenge);
            const messages = {
              'not-enough-leads': 'Ready to build a system that generates qualified leads on autopilot?<div style="text-align: center !important; margin: -18px 0 12px 0 !important; opacity: 0.4 !important; font-size: 16px !important; line-height: 1 !important;">⸺</div><div style="font-size: 13px !important; font-weight: 500 !important; opacity: 0.7 !important; text-transform: uppercase !important; letter-spacing: 1px !important; margin: 0 0 32px 0 !important;">Complete the steps below</div>',
              'leads-not-converting': 'Ready to transform more prospects into paying customers?<div style="text-align: center !important; margin: -18px 0 12px 0 !important; opacity: 0.4 !important; font-size: 16px !important; line-height: 1 !important;">⸺</div><div style="font-size: 13px !important; font-weight: 500 !important; opacity: 0.7 !important; text-transform: uppercase !important; letter-spacing: 1px !important; margin: 0 0 32px 0 !important;">Complete the steps below</div>',
              'revenue-not-scaling': 'Ready to unlock exponential revenue growth with AI systems?<div style="text-align: center !important; margin: -18px 0 12px 0 !important; opacity: 0.4 !important; font-size: 16px !important; line-height: 1 !important;">⸺</div><div style="font-size: 13px !important; font-weight: 500 !important; opacity: 0.7 !important; text-transform: uppercase !important; letter-spacing: 1px !important; margin: 0 0 32px 0 !important;">Complete the steps below</div>',
              'missed-opportunities': 'Ready to capture every lead and maximize your business potential?<div style="text-align: center !important; margin: -18px 0 12px 0 !important; opacity: 0.4 !important; font-size: 16px !important; line-height: 1 !important;">⸺</div><div style="font-size: 13px !important; font-weight: 500 !important; opacity: 0.7 !important; text-transform: uppercase !important; letter-spacing: 1px !important; margin: 0 0 32px 0 !important;">Complete the steps below</div>'
            };
            return messages[challenge] || 'Ready for your strategy session?<div style="text-align: center !important; margin: -18px 0 12px 0 !important; opacity: 0.4 !important; font-size: 16px !important; line-height: 1 !important;">⸺</div><div style="font-size: 13px !important; font-weight: 500 !important; opacity: 0.7 !important; text-transform: uppercase !important; letter-spacing: 1px !important; margin: 0 0 32px 0 !important;">Complete the steps below</div>';
          }
          
          // Ensure we have challenge data (try multiple sources)
          const userChallenge = userData.challenge || userData.primaryChallenge || window.userChallenge || 'not-enough-leads';
          console.log('🎯 Final challenge used for personalization:', userChallenge);
          
          // PROFESSIONAL: Session-based detection for just completed vs returning
          const sourceType = e?.detail?.source || 'unknown';
          const existingBooking = localStorage.getItem('bookingConfirmed') === 'true';
          const bookingTimestamp = localStorage.getItem('bookingTimestamp');
          
          // FIXED: Check if this is JUST completed booking (fresh session) - exclude persistence sources
          const confirmationAlreadyShown = sessionStorage.getItem('confirmationShown') === 'true';
          const isPersistenceSource = (
            sourceType === 'page_load_existing_booking_persistence' ||
            sourceType === 'reload_with_booking' ||
            sourceType === 'persistence_reload'
          );
          const justCompleted = !confirmationAlreadyShown && !isPersistenceSource && (
            sourceType.includes('booking') || 
            sourceType === 'bookingSuccessful' ||
            sourceType === 'DOM_TEXT_DETECTION' ||
            sourceType === 'postMessage_success' ||
            sourceType === 'POSTMESSAGE' ||
            sourceType === 'iframe_confirmation'
          );
          
          // Mark confirmation as shown for this session
          if (justCompleted) {
            sessionStorage.setItem('confirmationShown', 'true');
          }
          
          console.log('🔍 === PROFESSIONAL SECTION 3 DETECTION LOGIC ===');
          console.log('📍 Source type:', sourceType);
          console.log('📋 Existing booking:', existingBooking);
          console.log('🔄 Confirmation already shown:', confirmationAlreadyShown);
          console.log('📄 Is persistence source:', isPersistenceSource);
          console.log('🎯 JUST completed booking:', justCompleted);
          console.log(`✅ Will show: ${justCompleted ? 'Cal.com native confirmation' : 'Preparation accordion'}`);
          
          // Create personalized message with professional formatting
          const personalMessage = getPersonalizedMessage(userChallenge);
          
          // Helper function to generate Section 3 content - conditional based on booking state
          function generateSection3Content(justCompleted, bookingData) {
            // Always show professional preparation accordion
            // Cal.com widget preservation is not possible due to iframe cross-origin restrictions
            if (justCompleted) {
              console.log('📋 Fresh booking detected - showing professional preparation accordion');
            } else {
              console.log('📋 Persistence reload - showing preparation accordion');
            }
            
            return `
                  <!-- Step 3: Meeting Details & Preparation -->
                  <div class="ai-discovery-section">
                    <div class="ai-discovery-container">
                      <div class="step-indicator">
                        <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">3</span>
                        <h2 class="ai-discovery-heading">Meeting Confirmed</h2>
                      </div>
                      
                      <p class="ai-discovery-subheading">
                        Add this event to your calendar below, and I'll keep you updated via email.
                      </p>
                      
                      <!-- Premium Add to Calendar Section -->
                      <div class="calendar-buttons-section" id="calendar-buttons-section" style="margin: 1rem 0 1rem 0; padding: 1rem; background: rgba(255, 255, 255, 0.02); border-radius: 8px;">
                        <h3 style="color: white; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; text-align: center;">Add to Your Calendar</h3>
                        <div class="calendar-buttons-grid">
                          <button class="calendar-btn" data-calendar="google">
                            <svg width="18" height="18" viewBox="0,0,256,256" xmlns="http://www.w3.org/2000/svg" style="background: transparent !important;">
                              <g fill="#ffffff" transform="scale(5.12,5.12)">
                                <path d="M25.99609,48c-12.68359,0 -23.00391,-10.31641 -23.00391,-23c0,-12.68359 10.32031,-23 23.00391,-23c5.74609,0 11.24609,2.12891 15.49219,5.99609l0.77344,0.70703l-7.58594,7.58594l-0.70312,-0.60156c-2.22656,-1.90625 -5.05859,-2.95703 -7.97656,-2.95703c-6.76562,0 -12.27344,5.50391 -12.27344,12.26953c0,6.76563 5.50781,12.26953 12.27344,12.26953c4.87891,0 8.73438,-2.49219 10.55078,-6.73828h-11.55078v-10.35547l22.55078,0.03125l0.16797,0.79297c1.17578,5.58203 0.23438,13.79297 -4.53125,19.66797c-3.94531,4.86328 -9.72656,7.33203 -17.1875,7.33203z"/>
                              </g>
                            </svg>
                            <span>Google</span>
                          </button>
                          
                          <button class="calendar-btn" data-calendar="outlook">
                            <svg width="18" height="18" viewBox="0,0,256,256" xmlns="http://www.w3.org/2000/svg" style="background: transparent !important;">
                              <g fill="#ffffff" transform="scale(5.12,5.12)">
                                <path d="M28.875,0c-0.01953,0.00781 -0.04297,0.01953 -0.0625,0.03125l-28,5.3125c-0.47656,0.08984 -0.82031,0.51172 -0.8125,1v37.3125c-0.00781,0.48828 0.33594,0.91016 0.8125,1l28,5.3125c0.28906,0.05469 0.58984,-0.01953 0.82031,-0.20703c0.22656,-0.1875 0.36328,-0.46484 0.36719,-0.76172v-11h4.0625c-0.04297,0.33203 -0.0625,0.66016 -0.0625,1c0,4.40625 3.59375,8 8,8c4.40625,0 8,-3.59375 8,-8c0,-1.39062 -0.37109,-2.70312 -1,-3.84375c0.00391,-0.05078 0.00391,-0.10547 0,-0.15625v-17.34375c0.08203,-0.22266 0.08203,-0.46484 0,-0.6875v-4.96875c0,-0.55078 -0.44922,-1 -1,-1h-18v-10c0.00391,-0.28906 -0.12109,-0.5625 -0.33594,-0.75391c-0.21484,-0.19141 -0.50391,-0.28125 -0.78906,-0.24609zM28,2.1875v9.5c-0.05859,0.19531 -0.05859,0.39844 0,0.59375v24.40625c-0.05859,0.19531 -0.05859,0.39844 0,0.59375v10.53125l-26,-4.96875v-35.6875zM30,13h17v3.78125l-13.25,7.84375l-3.75,-3.09375zM14.84375,15.53125c-2.51953,0 -4.53516,0.875 -6.0625,2.65625c-1.52734,1.78125 -2.28125,4.11719 -2.28125,7c0,2.73047 0.74609,4.95703 2.25,6.65625c1.50391,1.69922 3.45703,2.5625 5.84375,2.5625c2.44922,0 4.41406,-0.90234 5.9375,-2.65625c1.52344,-1.75781 2.28125,-4.07031 2.28125,-6.9375c0,-2.78906 -0.71875,-5.01172 -2.1875,-6.71875c-1.46875,-1.70312 -3.40234,-2.5625 -5.78125,-2.5625zM14.75,19.0625c1.27734,0 2.29297,0.54297 3.03125,1.59375c0.73828,1.05078 1.09375,2.51563 1.09375,4.40625c0,1.81641 -0.39844,3.23047 -1.15625,4.25c-0.76172,1.02344 -1.76953,1.53125 -3.0625,1.53125c-1.25781,0 -2.28516,-0.51172 -3.0625,-1.5625c-0.77344,-1.05078 -1.15625,-2.50781 -1.15625,-4.3125c0,-1.78125 0.37891,-3.19922 1.15625,-4.28125c0.77344,-1.08203 1.83984,-1.625 3.15625,-1.625zM47,19.125v13.65625c-1.37109,-1.10156 -3.11328,-1.78125 -5,-1.78125c-3.33984,0 -6.21094,2.08203 -7.40625,5h-4.59375v-11.90625l3.03125,2.5c0.32422,0.27344 0.78906,0.3125 1.15625,0.09375zM42,33c3.32422,0 6,2.67578 6,6c0,3.32422 -2.67578,6 -6,6c-3.32422,0 -6,-2.67578 -6,-6c0,-3.32422 2.67578,-6 6,-6zM41,34v7h5v-2h-3v-5z"/>
                              </g>
                            </svg>
                            <span>Outlook</span>
                          </button>
                          
                          <button class="calendar-btn" data-calendar="apple">
                            <svg width="18" height="18" viewBox="0,0,256,256" xmlns="http://www.w3.org/2000/svg" style="background: transparent !important;">
                              <g fill="#ffffff" transform="scale(5.12,5.12)">
                                <path d="M44.52734,34.75c-1.07812,2.39453 -1.59766,3.46484 -2.98437,5.57813c-1.94141,2.95313 -4.67969,6.64063 -8.0625,6.66406c-3.01172,0.02734 -3.78906,-1.96484 -7.87891,-1.92969c-4.08594,0.01953 -4.9375,1.96875 -7.95312,1.9375c-3.38672,-0.03125 -5.97656,-3.35156 -7.91797,-6.30078c-5.42969,-8.26953 -6.00391,-17.96484 -2.64844,-23.12109c2.375,-3.65625 6.12891,-5.80469 9.65625,-5.80469c3.59375,0 5.85156,1.97266 8.82031,1.97266c2.88281,0 4.63672,-1.97656 8.79297,-1.97656c3.14063,0 6.46094,1.71094 8.83594,4.66406c-7.76562,4.25781 -6.50391,15.34766 1.33984,18.31641zM31.19531,8.46875c1.51172,-1.94141 2.66016,-4.67969 2.24219,-7.46875c-2.46484,0.16797 -5.34766,1.74219 -7.03125,3.78125c-1.52734,1.85938 -2.79297,4.61719 -2.30078,7.28516c2.69141,0.08594 5.47656,-1.51953 7.08984,-3.59766z"/>
                              </g>
                            </svg>
                            <span>Apple</span>
                          </button>
                          
                          <button class="calendar-btn" data-calendar="yahoo">
                            <svg width="18" height="18" viewBox="0,0,256,256" xmlns="http://www.w3.org/2000/svg" style="background: transparent !important;">
                              <g fill="#ffffff" transform="scale(5.33333,5.33333)">
                                <path d="M4.209,14.881h7.423l4.557,11.834l4.777,-11.834h7.349l-11.245,27.119h-7.569l3.086,-7.04z"/>
                                <circle cx="29.276" cy="30.522" r="4.697"/>
                                <path d="M34.693,6l-7.48,18.042h8.231l7.481,-18.042z"/>
                              </g>
                            </svg>
                            <span>Yahoo</span>
                          </button>
                        </div>
                        <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.75rem; text-align: center; margin-top: 1rem; line-height: 1.4;">
                          Meeting link and details sent via email 15 minutes before
                        </p>
                      </div>
                      
                      <!-- Professional Preparation Accordion -->
                      <div class="prep-section">
                        <h3 class="prep-title">How to Prepare</h3>
                        <div class="prep-accordion">
                          <div class="prep-item">
                            <div class="prep-question" onclick="togglePrepItem(this)">
                              <span>Review your current software tools</span>
                              <span class="prep-toggle">+</span>
                            </div>
                            <div class="prep-answer">
                              <div class="prep-answer-content">
                                <p>Make a note of the 3-5 software tools or platforms you use daily in your business. This could include your CRM, email platform, project management tool, accounting software, or communication apps. Knowing your current tech stack helps me design automations that work seamlessly with what you already use.</p>
                              </div>
                            </div>
                          </div>
                          <div class="prep-item">
                            <div class="prep-question" onclick="togglePrepItem(this)">
                              <span>Identify your biggest time drains</span>
                              <span class="prep-toggle">+</span>
                            </div>
                            <div class="prep-answer">
                              <div class="prep-answer-content">
                                <p>Think about what tasks eat up most of your time each week. Consider things like responding to emails, updating spreadsheets, scheduling meetings, following up with leads, or preparing reports. These time drains are often the highest-impact automation opportunities.</p>
                              </div>
                            </div>
                          </div>
                          <div class="prep-item">
                            <div class="prep-question" onclick="togglePrepItem(this)">
                              <span>Think about tasks you do the same way repeatedly</span>
                              <span class="prep-toggle">+</span>
                            </div>
                            <div class="prep-answer">
                              <div class="prep-answer-content">
                                <p>Consider 2-3 tasks you do the exact same way every time. Examples: sending welcome emails to new clients, creating invoices, updating project status, or organizing files. These predictable workflows are perfect candidates for complete automation.</p>
                              </div>
                            </div>
                          </div>
                          <div class="prep-item">
                            <div class="prep-question" onclick="togglePrepItem(this)">
                              <span>Consider what you wish happened automatically</span>
                              <span class="prep-toggle">+</span>
                            </div>
                            <div class="prep-answer">
                              <div class="prep-answer-content">
                                <p>Come ready with 2-3 things you wish happened automatically in your business. Maybe it's instant lead follow-up, automatic data backup, or notifications when important events happen. Having specific wishes helps me prioritize which automations will make the biggest impact for you.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <!-- Email Button -->
                      <div class="minimal-contact">
                        <a href="mailto:hi@nithichote.com?subject=Meeting Question" class="link-button w-inline-block">
                          <div class="button-link-wrapper">
                            <div class="button-text-block">
                              <div class="button-text">Questions? Email Me</div>
                              <div class="button-text is-hover">QUESTIONS? EMAIL ME</div>
                            </div>
                          </div>
                          <div class="underline is-nav"></div>
                        </a>
                      </div>
                    </div>
                  </div>
                `;
          }
          
          // Create enhanced content ABOVE the Cal.com confirmation with AGGRESSIVE CSS DOMINANCE
          const enhancedContent = document.createElement('div');
          enhancedContent.className = 'enhanced-confirmation';
          
          // RESPONSIVE CSS DOMINANCE - ensure our confirmation appears above Cal.com with proper layout
          enhancedContent.style.cssText = `
            position: relative !important;
            width: 100% !important;
            max-width: none !important;
            min-height: 100vh !important;
            background: var(--primary-black) !important;
            z-index: 100 !important;
            overflow-y: visible !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            margin: 0 !important;
            padding: 0 !important;
            box-sizing: border-box !important;
          `;
          
          // Create the confirmation page HTML content
          enhancedContent.innerHTML = `
            <div class="confirmation-container">
              <div class="confirmation-success-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22,4 12,14.01 9,11.01"></polyline>
                </svg>
                Strategy Session Confirmed
              </div>
              <h1 class="confirmation-heading">
                Your AI automation strategy session is confirmed
              </h1>
              <p class="confirmation-tagline">
                ${personalMessage}
              </p>
              
              <!-- Video Section -->
              <div class="confirmation-video">
                <div class="step-indicator">
                  <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">1</span>
                  <h2 class="video-title">Watch My Brief Personal Message</h2>
                </div>
                <div class="professional-video-player no-transition" style="
                  position: relative !important; 
                  width: 100% !important; 
                  max-width: 800px !important;
                  aspect-ratio: 16/9 !important;
                  margin: 0 auto !important; 
                  padding: 0 !important;
                  border-radius: 12px !important; 
                  overflow: hidden !important; 
                  box-shadow: 0 8px 32px rgba(0,0,0,0.3) !important;
                  background: #2a2a2a !important;
                ">
                  <!-- Raw Video Element (No Native Controls) -->
                  <video 
                    id="mainVideo"
                    preload="metadata"
                    playsinline
                    webkit-playsinline
                    controls="false"
                    disablePictureInPicture
                    controlslist="nodownload nofullscreen noremoteplayback"
                    poster="thumbnails/consultation-prep-poster.jpg"
                    style="
                      position: absolute;
                      top: 0;
                      left: 0;
                      width: 100%; 
                      height: 100%; 
                      object-fit: contain;
                      background: #1a1a1a;
                      z-index: 1;
                      display: block;
                      filter: none;
                    "
                  >
                    <source id="videoSource" src="${videoPath}" type="video/mp4">
                    Your browser does not support HTML5 video.
                  </video>
                  
                  
                  <!-- Mute Button (Top Right) -->
                  <button id="volumeBtn" style="
                    position: absolute;
                    top: 15px;
                    right: 15px;
                    background: rgba(0,0,0,0.8);
                    border: none;
                    color: white;
                    cursor: pointer;
                    padding: 10px;
                    border-radius: 50%;
                    pointer-events: auto;
                    transition: all 0.2s ease;
                    z-index: 200;
                    backdrop-filter: none;
                    isolation: isolate;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                    width: 45px;
                    height: 45px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    opacity: 0.7;
                  " onmouseover="this.style.background='rgba(0,0,0,0.8)'" onmouseout="this.style.background='rgba(0,0,0,0.6)'">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));">
                      <path id="volumeOnIcon" d="M3 9v6h4l5 5V4l-5 5H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z" fill="white"/>
                      <path id="volumeOffIcon" d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z" fill="white" style="display: none;"/>
                    </svg>
                  </button>
                  
                  <!-- Blur Overlay (When Paused) -->
                  <div id="blurOverlay" style="
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0,0,0,0.1);
                    backdrop-filter: blur(12px);
                    -webkit-backdrop-filter: blur(12px);
                    z-index: 80;
                    display: block;
                  "></div>
                  
                  <!-- Center Play Button -->
                  <div id="centerPlayBtn" style="
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    width: 90px;
                    height: 90px;
                    background: rgba(255,255,255,0.95);
                    border: none;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                    backdrop-filter: blur(2px);
                    z-index: 90;
                  " onmouseover="this.style.transform='translate(-50%, -50%) scale(1.1)'; this.style.background='rgba(255,255,255,1)'" onmouseout="this.style.transform='translate(-50%, -50%) scale(1)'; this.style.background='rgba(255,255,255,0.95)'">
                    <!-- Play Icon SVG -->
                    <svg id="playButtonIcon" width="35" height="35" viewBox="0 0 24 24" fill="none" style="display: block;">
                      <path d="M8 5v14l11-7z" fill="white" style="margin-left: 3px;"/>
                    </svg>
                    <!-- Replay Icon SVG -->
                    <svg id="replayButtonIcon" width="35" height="35" viewBox="0 0 24 24" fill="none" style="display: none;">
                      <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" fill="white"/>
                    </svg>
                  </div>
                  
                  <!-- Seeking Prevention Message -->
                  <div id="seekingMessage" style="
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0,0,0,0.9);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    font-size: 14px;
                    display: none;
                    backdrop-filter: blur(10px);
                    z-index: 25;
                  ">Video is loading...</div>
                  
                  <!-- ALWAYS-ON-TOP Progress Bar (Last Element = Highest Stacking) -->
                  <div id="progressContainer" class="progress-container" style="
                    position: absolute !important;
                    bottom: 0 !important;
                    left: 0 !important;
                    right: 0 !important;
                    width: 100% !important;
                    height: 6px !important;
                    background: rgba(0,0,0,0.3) !important;
                    z-index: 99999 !important;
                    pointer-events: none !important;
                    border-radius: 0 !important;
                    display: block !important;
                    visibility: visible !important;
                    opacity: 0.85 !important;
                    border: none !important;
                    transition: opacity 0.3s ease !important;
                  ">
                    <div id="progressBar" style="
                      height: 100% !important;
                      background: rgba(255,255,255,0.9) !important;
                      transition: width 0.1s linear, opacity 0.3s ease !important;
                      border-radius: 0 !important;
                      display: block !important;
                      position: absolute !important;
                      top: 0 !important;
                      left: 0 !important;
                      z-index: 99999 !important;
                      border: none !important;
                    "></div>
                  </div>
                  
                </div>
              </div>
              
              <!-- Section Divider -->
              <div class="section-divider"></div>
              
              <!-- Step 2: AI Discovery Section -->
              <div class="ai-discovery-section">
                <div class="ai-discovery-container">
                  <div class="step-indicator">
                    <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">2</span>
                    <h2 class="ai-discovery-heading">Start Your AI Discovery Call</h2>
                  </div>
                  
                  <p class="ai-discovery-subheading">5-minute prep call so you get the most from your strategy session.</p>
                  
                  <!-- Success Animation Container -->
                  <div id="successAnimationContainer" style="display: none; text-align: center; margin: 2rem 0;">
                    <div class="success-animation" style="position: relative; width: 80px; height: 80px; margin: 0 auto 1rem auto; border-radius: 50%; background: linear-gradient(135deg, #4ade80, #22c55e); display: flex; align-items: center; justify-content: center; animation: successPulse 2s infinite;">
                      <div class="checkmark" style="width: 30px; height: 30px; color: white; font-size: 24px; font-weight: bold;">✓</div>
                    </div>
                    <div class="success-content">
                      <h3 class="success-title" style="color: #4ade80; font-size: 1.25rem; font-weight: 600; margin: 0 0 0.5rem 0;">Call Starting Soon!</h3>
                      <p class="success-text">Call in 60 seconds!</p>
                    </div>
                  </div>
                  
                  <!-- Professional AI Call Component - 2 Layer Structure -->
                  <div id="ctaContainer" style="position: relative; width: 100%; max-width: 400px; height: 84px; margin: 2.25rem auto 0.5rem auto; pointer-events: none;">
                    <div id="buttonContainer" style="position: absolute; top: 0; left: 0; width: 100%; opacity: 1; transform: translateY(0); pointer-events: auto; transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; z-index: 3;">
                      <button id="ctaButton" style="all: initial; box-sizing: border-box; display: flex; align-items: center; justify-content: center; gap: 4px; width: 100%; height: 48px; background: #0f0f0f; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: rgba(255, 255, 255, 0.9); font-size: 13px; font-weight: 500; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; text-align: center; cursor: pointer; pointer-events: auto; -webkit-appearance: none; -moz-appearance: none; appearance: none; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; -webkit-text-stroke-width: 0; -webkit-text-stroke-color: transparent; text-shadow: none; outline: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.2s ease; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; padding: 0 8px;">
                        <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="color: rgba(255, 255, 255, 0.9);">
                          <path d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59533 1.99522 8.06814 2.16708 8.43999 2.48353C8.81184 2.79999 9.06334 3.23945 9.14999 3.72C9.31071 4.68007 9.58887 5.61273 9.97999 6.5C10.1018 6.80258 10.1445 7.13162 10.1044 7.45606C10.0642 7.78049 9.94218 8.09014 9.74999 8.35L8.52999 9.57C9.85999 12.0756 11.9544 14.17 14.46 15.5L15.68 14.28C15.9399 14.0878 16.2495 13.9658 16.574 13.9256C16.8984 13.8855 17.2274 13.9282 17.53 14.05C18.4173 14.4411 19.3499 14.7193 20.31 14.88C20.7955 14.9685 21.2387 15.2239 21.5547 15.5997C21.8707 15.9755 22.0397 16.4499 22.03 16.94L22 16.92Z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Get AI Strategy Call in 60 Seconds
                      </button>
                    </div>
                  </div>
                  
                  <p class="ai-supporting-text">
                    <strong>Available within 30 minutes of booking</strong> • Quick prep call to maximize your strategy session.
                  </p>
                </div>
              </div>
              
              <!-- Section Divider -->
              <div class="section-divider"></div>

              ${generateSection3Content(justCompleted, null)}
              
              <!-- Bottom Navigation Bar -->
              <footer class="confirmation-footer" style="display: block !important; padding: 1.5rem 1.5rem 0.75rem 1.5rem; background: var(--primary-black); border-top: 1px solid rgba(255, 255, 255, 0.05); text-align: center;">
                <div class="footer-links">
                  <a href="/" class="link-button w-inline-block">
                    <div class="button-link-wrapper">
                      <div class="button-text-block">
                        <div class="button-text is-hover">BACK TO HOMEPAGE</div>
                        <div class="button-text">BACK TO HOMEPAGE</div>
                      </div>
                      <div class="arrow-button-block">
                        <div class="arrow-button _01 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                          </svg></div>
                        <div class="arrow-button _02 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                          </svg></div>
                      </div>
                    </div>
                    <div class="underline is-nav"></div>
                  </a>
                </div>
              </footer>
            </div>
          `;
          
          // CRITICAL: Inject comprehensive CSS styles BEFORE HTML to prevent flash
          const confirmationCSS = document.createElement('style');
          confirmationCSS.id = 'dynamic-confirmation-styles';
          confirmationCSS.textContent = `
            /* RESTORED ORIGINAL: Professional Booking Confirmation - Dynamic Page Styles */
            .enhanced-confirmation {
              min-height: 100vh;
              background: var(--primary-black, #0f0f0f);
              color: var(--white, white);
              font-family: 'General Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              line-height: 1.6;
              position: relative;
              display: block;
              visibility: visible;
              opacity: 1;
            }

            /* Confirmation Page Structure - Original Professional Spacing */
            .confirmation-container {
              max-width: 1000px;
              width: 100%;
              padding: 4rem 2rem 2rem 2rem;
              text-align: center;
              margin: 0 auto;
              position: relative;
            }

            .confirmation-success-badge {
              display: inline-flex;
              align-items: center;
              gap: 0.5rem;
              background: rgba(74, 222, 128, 0.1);
              color: #4ade80;
              padding: 0.75rem 1.5rem;
              border-radius: 50px;
              font-size: 0.875rem;
              font-weight: 500;
              margin: 0 auto 2rem auto;
            }

            .confirmation-heading {
              font-size: clamp(2.5rem, 5vw, 3rem);
              font-weight: 700;
              margin: 0 0 1rem 0;
              letter-spacing: -0.02em;
              color: var(--white, white);
              line-height: 1.2;
            }

            .confirmation-tagline {
              font-size: 1.25rem;
              margin: 0 0 3rem 0;
              max-width: 800px;
              margin-left: auto;
              margin-right: auto;
              line-height: 1.4;
              text-align: center;
            }

            .tagline-problem {
              color: rgba(255, 255, 255, 0.9);
              font-weight: 500;
              letter-spacing: -0.01em;
              display: block;
              margin-bottom: 0.5rem;
            }

            .tagline-action {
              color: rgba(255, 255, 255, 0.6);
              font-weight: 400;
              font-size: 1.125rem;
              letter-spacing: 0;
            }

            /* Step Structure - Original Clean Design */
            .step-indicator {
              display: flex;
              align-items: center;
              gap: 0.75rem;
              margin-bottom: 1rem;
              justify-content: center;
            }

            .step-number-badge {
              width: 32px;
              height: 32px;
              background: transparent;
              border: 1px solid rgba(255, 255, 255, 0.3);
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1rem;
              font-weight: 600;
              color: rgba(255, 255, 255, 0.8);
              flex-shrink: 0;
            }

            .step-indicator h2, .step-indicator h3 {
              margin: 0;
              font-size: 1.375rem !important;
              font-weight: 600;
              color: var(--white);
              letter-spacing: -0.01em;
            }

            /* Video Player Styles - Perfect Balance */
            .confirmation-video {
              margin: 2rem 0 1rem 0; /* 2rem above, 1rem below for balance with divider */
            }

            .professional-video-container {
              max-width: 700px;
              margin: 0 auto;
              position: relative;
            }

            /* COMMENTED OUT - Duplicate CSS definition with wrong aspect ratio
            .professional-video-player {
              position: relative;
              background: #000;
              border: 1px solid var(--border, #b4b4b414);
              border-radius: 8px;
              overflow: hidden;
              aspect-ratio: 16/9; // This was wrong for portrait video
              -webkit-touch-callout: none;
              -webkit-user-select: none;
              touch-action: manipulation;
              will-change: transform;
            }
            */

            .main-video {
              width: 100%;
              height: 100%;
              object-fit: cover;
              display: block;
            }

            .video-play-overlay {
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background: rgba(0, 0, 0, 0.3);
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              cursor: pointer;
              transition: all 0.3s ease;
            }

            .video-play-overlay:hover {
              background: rgba(0, 0, 0, 0.5);
            }

            .clean-play-button {
              width: 4rem;
              height: 4rem;
              border-radius: 50%;
              background: var(--white, white);
              border: none;
              color: var(--primary-black, #0f0f0f);
              font-size: 1.5rem;
              display: flex;
              align-items: center;
              justify-content: center;
              cursor: pointer;
              transition: all 0.3s ease;
              margin-bottom: 1rem;
            }

            .clean-play-button:hover {
              transform: scale(1.1);
            }

            .video-info {
              text-align: center;
            }

            .video-caption {
              color: var(--white, white);
              font-size: 0.875rem;
              margin: 0;
            }

            /* Professional iOS Video Solution - Embrace Native Controls */
            @supports (-webkit-touch-callout: none) {
              /* Enable smooth iOS video performance */
              .main-video {
                -webkit-transform: translate3d(0, 0, 0);
                -webkit-backface-visibility: hidden;
              }
              
              /* Style custom overlay for non-iOS devices */
              .video-play-overlay {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
              }
              
              .clean-play-button {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
              }
              
              /* Professional video container */
              .professional-video-player {
                -webkit-touch-callout: none;
                -webkit-user-select: none;
              }
            }

            /* Mobile responsive spacing adjustments */
            @media (max-width: 767px) {
              .confirmation-video {
                margin: 1.5rem 0 0.75rem 0; /* Balanced mobile spacing */
              }
              
              .section-divider {
                margin: 0.75rem auto;
              }
              
              .step-indicator {
                margin-bottom: 0.75rem; /* Consistent mobile spacing */
              }
              
              .professional-video-player {
                border-radius: 6px; /* Slightly less rounding on mobile */
              }
            }

            @media (max-width: 479px) {
              .confirmation-video {
                margin: 1rem 0 0.5rem 0; /* Even tighter on very small screens */
              }
              
              .section-divider {
                margin: 0.5rem auto;
              }
              
              .step-indicator {
                margin-bottom: 0.5rem;
              }
            }

            /* AI Discovery Section - Match Other Sections */
            .ai-discovery-section {
              padding: 4rem 2rem;
              background-color: var(--primary-black);
              position: relative;
              overflow: hidden;
              display: block;
              visibility: visible;
              opacity: 1;
              min-height: 200px;
              max-width: 800px !important;
              margin-left: auto !important;
              margin-right: auto !important;
            }

            .ai-discovery-container {
              max-width: 1000px;
              margin: 0 auto;
              position: relative;
              z-index: 1;
            }

            .ai-discovery-heading {
              font-size: 2rem;
              font-weight: 600;
              color: var(--white);
              margin-bottom: 0.75rem;
              line-height: 1.2;
              letter-spacing: -0.02em;
              text-align: center;
              display: block;
              visibility: visible;
            }

            .ai-discovery-subheading {
              font-size: 1.125rem;
              color: rgba(255, 255, 255, 0.6);
              margin-bottom: 1.5rem;
              line-height: 1.4;
              max-width: 600px;
              margin-left: auto;
              margin-right: auto;
              text-align: center;
            }

            .ai-supporting-text {
              font-size: 0.875rem;
              color: var(--grey, #b4b4b4);
              margin: 1.5rem 0 0 0;
              text-align: center;
            }

            /* Section Dividers - Original Style */
            .section-divider {
              height: 1px;
              background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
              width: 80%;
              margin: 1rem auto; /* Reduced for perfect balance */
            }

            /* Accordion Styles - Original Professional Design */
            .prep-section {
              margin: 2rem 0;
              text-align: left;
            }

            .prep-title {
              font-size: 1.125rem;
              font-weight: 600;
              color: var(--white, white);
              margin: 0 0 1.5rem 0;
              text-align: center;
            }

            .prep-accordion {
              max-width: 100%;
              margin: 0 auto;
              text-align: left;
            }

            .prep-item {
              margin-bottom: 0;
              background: transparent;
              border: none;
              border-bottom: 1px solid rgba(255, 255, 255, 0.1);
              overflow: hidden;
              transition: background-color 0.2s ease;
            }

            .prep-item:first-child {
              border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            .prep-question {
              padding: 1.5rem 0;
              cursor: pointer;
              display: flex;
              justify-content: space-between;
              align-items: center;
              color: rgba(255, 255, 255, 0.9);
              font-size: 1rem;
              font-weight: 400;
              letter-spacing: -0.02em;
              line-height: 1.3;
              transition: color 0.2s ease;
              font-family: General Sans, Arial, sans-serif;
            }

            .prep-question:hover {
              color: rgba(255, 255, 255, 1);
            }

            .prep-toggle {
              font-size: 1.2rem;
              color: rgba(255, 255, 255, 0.4);
              transition: transform 0.25s ease-out, color 0.2s ease;
              line-height: 1;
              font-weight: 300;
              transform-origin: center center;
              will-change: transform;
            }

            .prep-item:hover .prep-toggle {
              color: rgba(255, 255, 255, 0.6);
            }

            .prep-item.active .prep-question {
              color: #fff;
            }

            .prep-item.active .prep-toggle {
              color: #fff;
              transform: rotate(45deg);
            }

            .prep-answer {
              display: grid;
              grid-template-rows: 0fr;
              transition: grid-template-rows 0.25s ease-out;
              color: rgba(255, 255, 255, 0.6);
              line-height: 1.6;
              font-size: 0.95rem;
              margin: 0;
              padding: 0;
            }

            .prep-answer-content {
              overflow: hidden;
              min-height: 0;
              padding: 0;
              margin: 0;
              opacity: 0;
              transform: scale(0.98);
              transition: opacity 0.25s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .prep-item.active .prep-answer {
              grid-template-rows: 1fr;
            }

            .prep-item.active .prep-answer-content {
              padding: 0 0 1.5rem 0;
              opacity: 1;
              transform: scale(1);
            }

            .prep-answer p {
              margin: 0;
              font-family: General Sans, Arial, sans-serif;
            }

            /* Button Styles - Original Professional Design */
            .minimal-contact {
              margin: 2rem 0;
              text-align: center;
            }

            .link-button {
              grid-column-gap: 3px;
              grid-row-gap: 3px;
              flex-flow: column;
              justify-content: flex-start;
              align-items: center;
              text-decoration: none;
              display: flex;
              overflow: hidden;
              cursor: pointer;
            }

            .button-link-wrapper {
              grid-column-gap: 5px;
              grid-row-gap: 5px;
              flex-flow: row;
              justify-content: flex-start;
              align-items: center;
              display: flex;
              position: relative;
            }

            .button-text-block {
              flex-flow: column;
              justify-content: flex-start;
              align-items: center;
              height: 14px;
              display: flex;
              position: relative;
              overflow: hidden;
            }

            .button-text {
              color: var(--grey, #b4b4b4);
              text-transform: uppercase;
              white-space: nowrap;
              font-size: 14px;
              font-weight: 500;
              line-height: 1;
              transition: transform 0.3s ease;
              transform: translateY(0);
            }

            .button-text.is-hover {
              color: var(--grey, #b4b4b4);
              transition: transform 0.3s ease;
              transform: translateY(-100%);
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
            }

            .underline {
              background-color: var(--grey, #b4b4b4);
              width: 100%;
              height: 1px;
              margin-top: 1px;
              transform: scaleX(1);
              transform-origin: right;
              transition: transform 0.3s ease;
            }

            .underline.is-nav {
              background-color: var(--grey, #b4b4b4);
            }

            .link-button:hover .underline {
              transform: scaleX(0);
              transform-origin: right;
            }

            .link-button:hover .button-text {
              transform: translateY(100%);
            }

            .link-button:hover .button-text.is-hover {
              transform: translateY(0);
            }

            /* Confirmation Footer */
            .confirmation-footer {
              padding: 1.5rem 1.5rem 0.75rem 1.5rem;
              background: var(--primary-black);
              border-top: 1px solid rgba(255, 255, 255, 0.05);
              text-align: center;
              display: block !important;
            }

            /* Mobile Responsive - Match Other Sections */
            @media (max-width: 768px) {
              .step-indicator {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
              }
              
              .step-indicator h2,
              .step-indicator h3 {
                text-align: center;
              }
              
              .ai-discovery-section {
                padding: 3rem 1.5rem !important;
                max-width: 800px !important;
                margin-left: auto !important;
                margin-right: auto !important;
              }
              
              .ai-discovery-container {
                max-width: 100% !important;
                padding: 0 !important;
              }
              
              .ai-discovery-heading {
                font-size: 1.5rem;
              }
              
              .calendar-buttons-section {
                margin: 2rem 0 !important;
                padding: 1.5rem !important;
                max-width: 100% !important;
              }
              
              .confirmation-container {
                padding: 3rem 1.5rem 1.5rem 1.5rem;
                max-width: 800px !important;
                margin-left: auto !important;
                margin-right: auto !important;
              }
              
              .confirmation-heading {
                font-size: clamp(2rem, 6vw, 2.5rem);
                margin: 0 0 0.75rem 0;
              }
              
              .confirmation-tagline {
                font-size: 1.1rem;
                margin: 0 0 2rem 0;
              }
            }

            @media (max-width: 479px) {
              .confirmation-container {
                padding: 2rem 1rem 1rem 1rem;
                max-width: 800px !important;
                margin-left: auto !important;
                margin-right: auto !important;
              }
              
              .confirmation-heading {
                font-size: clamp(1.5rem, 7vw, 2rem);
                margin: 0 0 0.5rem 0;
              }
              
              .confirmation-tagline {
                font-size: 1rem;
                margin: 0 0 1.5rem 0;
              }
              
              .ai-discovery-section {
                padding: 2rem 1rem !important;
                max-width: 800px !important;
                margin-left: auto !important;
                margin-right: auto !important;
              }
              
              .ai-discovery-container {
                max-width: 100% !important;
                padding: 0 !important;
              }
              
              .calendar-buttons-section {
                margin: 1.5rem 0 !important;
                padding: 1rem !important;
                max-width: 100% !important;
              }
              
              .ai-discovery-heading {
                font-size: 1.25rem;
              }
              
              .ai-discovery-subheading {
                font-size: 0.9rem;
              }
              
              .button-text {
                font-size: 12px;
              }
            }
            
            /* ====== COMPREHENSIVE HOVER EFFECTS CSS ====== */
            /* CTA Button Hover Effects - Professional */
            div#buttonContainer button#ctaButton:hover,
            div#buttonContainer button#ctaButton:hover:active,
            button#ctaButton:hover,
            button#ctaButton:hover:active,
            #ctaButton:hover,
            #ctaButton:hover:active,
            button[style*="all: initial"]:hover,
            button[style*="all: initial"]:hover:active,
            button[style*="color: #333333"]:hover,
            button[style*="color: #333333"]:hover:active,
            #ctaButton[style*="all: initial"]:hover,
            #ctaButton[style*="all: initial"]:hover:active,
            #ctaButton[style*="color: #333333"]:hover,
            #ctaButton[style*="color: #333333"]:hover:active {
              /* VISUAL PROPERTIES - BLACK TEXT ON WHITE BACKGROUND */
              background: #f8f9fa !important;
              border-color: #d1d5db !important;
              color: #000000 !important; /* BLACK TEXT ON HOVER + ACTIVE */
              transform: translateY(-1px) !important;
              box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
              /* REMOVE ANY GLOW EFFECTS */
              outline: none !important;
              -webkit-tap-highlight-color: transparent !important;
              -webkit-focus-ring-color: transparent !important;
            }
            
            /* SVG ICON DEFAULT STATE - ENSURE CORRECT BASE COLOR */
            div#buttonContainer button#ctaButton svg,
            button#ctaButton svg,
            #ctaButton svg,
            svg[style*="color: #333333"] {
              color: inherit !important; /* Use button's color */
              fill: transparent !important; /* Ensure no fill background */
              background: transparent !important; /* No background color */
              stroke: currentColor !important;
            }

            /* SVG ICON HOVER STATE - BLACK ON HOVER */
            div#buttonContainer button#ctaButton:hover svg,
            div#buttonContainer button#ctaButton:hover:active svg,
            button#ctaButton:hover svg,
            button#ctaButton:hover:active svg,
            #ctaButton:hover svg,
            #ctaButton:hover:active svg,
            button[style*="all: initial"]:hover svg,
            button[style*="all: initial"]:hover:active svg,
            button[style*="all: initial"]:hover svg[style*="color: #333333"],
            button[style*="all: initial"]:hover:active svg[style*="color: #333333"],
            #ctaButton:hover svg[style*="color: #333333"],
            #ctaButton:hover:active svg[style*="color: #333333"],
            button[style*="color: #333333"]:hover svg[style*="color: #333333"],
            button[style*="color: #333333"]:hover:active svg[style*="color: #333333"] {
              color: #000000 !important; /* BLACK ICON ON HOVER + ACTIVE */
              fill: transparent !important; /* No fill background on hover */
              background: transparent !important; /* No background color on hover */
              stroke: currentColor !important; /* Ensure stroke follows color */
            }
            
            /* SVG PATH DEFAULT STATE */
            div#buttonContainer button#ctaButton svg path,
            button#ctaButton svg path,
            #ctaButton svg path {
              stroke: currentColor !important; /* Use inherited color */
              fill: transparent !important; /* Ensure no fill background */
              background: transparent !important; /* No background color */
            }

            /* SVG PATH HOVER STATE */
            div#buttonContainer button#ctaButton:hover svg path,
            div#buttonContainer button#ctaButton:hover:active svg path,
            button#ctaButton:hover svg path,
            button#ctaButton:hover:active svg path,
            #ctaButton:hover svg path,
            #ctaButton:hover:active svg path,
            button[style*="all: initial"]:hover svg path,
            button[style*="all: initial"]:hover:active svg path {
              stroke: #000000 !important; /* BLACK STROKE ON HOVER + ACTIVE */
              color: #000000 !important; /* BLACK COLOR ON HOVER + ACTIVE */
              fill: transparent !important; /* No fill background on hover */
              background: transparent !important; /* No background color on hover */
            }
            
            /* MAXIMUM SPECIFICITY - OVERRIDE JAVASCRIPT INLINE STYLES */
            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover,
            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active {
              color: #000000 !important; /* NUCLEAR BLACK TEXT */
              background: #f8f9fa !important; /* NUCLEAR WHITE BACKGROUND */
              border-color: #d1d5db !important; /* NUCLEAR BORDER */
            }

            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover svg,
            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active svg {
              color: #000000 !important; /* NUCLEAR BLACK SVG */
              fill: transparent !important; /* NUCLEAR NO BACKGROUND */
              background: transparent !important; /* NUCLEAR NO BACKGROUND COLOR */
              stroke: #000000 !important; /* NUCLEAR BLACK STROKE */
            }

            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover svg path,
            html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active svg path {
              stroke: #000000 !important; /* NUCLEAR BLACK PATH STROKE */
              color: #000000 !important; /* NUCLEAR BLACK PATH COLOR */
              fill: transparent !important; /* NUCLEAR NO FILL BACKGROUND */
              background: transparent !important; /* NUCLEAR NO BACKGROUND COLOR */
            }
            /* ====== END COMPREHENSIVE HOVER EFFECTS CSS ====== */
            
            /* ====== CURSOR FIXES FOR PHONE INPUT ====== */
            /* Force I-beam cursor on phone input when form is active */
            #phoneFormContainer[style*="opacity: 1"] #phoneInput,
            #phoneFormContainer.active #phoneInput,
            div[style*="opacity: 1"] #phoneInput[type="tel"],
            #phoneInput[type="tel"]:focus,
            #phoneInput[type="tel"]:hover,
            #phoneInput[type="tel"] {
              cursor: text !important;
              -webkit-cursor: text !important;
              -moz-cursor: text !important;
            }
            
            /* Override any parent container cursor styles */
            #phoneComponentContainer,
            #phoneFormContainer,
            div[id*="phone"] {
              cursor: default !important;
            }
            
            /* Ensure phone input area always has text cursor */
            #phoneComponentContainer *:hover #phoneInput[type="tel"] {
              cursor: text !important;
            }
            /* ====== END CURSOR FIXES ====== */
            
            /* ====== ACCORDION WIDTH CONSTRAINTS ====== */
            /* Professional accordion sizing to match other sections */
            .prep-section {
              max-width: 800px !important; /* Match video and other content width */
              margin: 2rem auto !important; /* Center and add proper spacing */
            }
            
            .prep-accordion {
              max-width: 100% !important;
              width: 100% !important;
              margin: 0 auto !important;
            }
            
            .prep-item {
              max-width: 100% !important;
              width: 100% !important;
            }
            
            /* Ensure prep section matches other sections' width */
            .prep-section,
            .video-section,
            .ai-discovery-section {
              max-width: 800px !important;
              margin-left: auto !important;
              margin-right: auto !important;
            }
            
            @media (max-width: 991px) {
              .prep-section {
                max-width: 90% !important;
                margin: 2rem auto !important;
              }
            }
            
            @media (max-width: 767px) {
              .prep-section {
                max-width: 95% !important;
                margin: 1.5rem auto !important;
              }
            }
            /* ====== END ACCORDION WIDTH CONSTRAINTS ====== */
            
            /* ====== MISSING VIDEO OVERLAY CSS ====== */
            .video-overlay {
              position: absolute !important;
              top: 0 !important;
              left: 0 !important;
              right: 0 !important;
              bottom: 0 !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              background: rgba(0, 0, 0, 0.3) !important;
              backdrop-filter: blur(8px) !important;
              -webkit-backdrop-filter: blur(8px) !important;
              transition: opacity 0.3s ease !important;
              cursor: pointer !important;
              z-index: 5 !important;
              border-radius: 8px !important;
            }

            .video-overlay:hover {
              background: rgba(0, 0, 0, 0.4) !important;
            }

            .play-button {
              width: 72px !important;
              height: 72px !important;
              min-width: 72px !important;
              min-height: 72px !important;
              border-radius: 50% !important;
              background: rgba(255, 255, 255, 0.95) !important;
              background-color: rgba(255, 255, 255, 0.95) !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              font-size: 24px !important;
              color: #0f0f0f !important;
              cursor: pointer !important;
              transition: all 0.3s ease !important;
              box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3) !important;
              border: none !important;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
              user-select: none !important;
              -webkit-user-select: none !important;
              outline: none !important;
            }

            .play-button:hover {
              transform: scale(1.1) !important;
              background: rgba(255, 255, 255, 1) !important;
              background-color: rgba(255, 255, 255, 1) !important;
              box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4) !important;
            }

            .play-button:active {
              transform: scale(1.05) !important;
            }

            /* Video section styling */
            .video-section,
            .confirmation-video {
              position: relative !important;
              margin: 3rem 0 !important;
              display: block !important;
            }

            .professional-video-player {
              position: relative !important;
              width: 100% !important;
              max-width: 800px !important;
              margin: 0 auto !important;
            }

            .video-content {
              position: relative !important;
              width: 100% !important;
              max-width: 800px !important;
              margin: 0 auto !important;
            }

            /* Professional Video Player Styles - RESPONSIVE FIX */
            .professional-video-player {
              position: relative !important;
              width: 100% !important;
              max-width: 900px !important;
              margin: 0 auto !important;
              padding: 0 !important;
              border-radius: 12px !important;
              overflow: hidden !important;
              /* Professional responsive sizing - no fixed min-height */
              box-shadow: 0 8px 32px rgba(0,0,0,0.3) !important;
              background: #000 !important;
              display: block !important;
              z-index: 1 !important;
            }

            /* COMMENTED OUT - These CSS rules conflict with inline HTML styles
            .professional-video-player {
              width: 100% !important;
              max-width: 600px !important;
              position: relative !important;
            }
            
            video#mainVideo {
              position: relative !important;
              width: 100% !important;
              height: auto !important;
              object-fit: contain !important;
              background: #000 !important;
              z-index: 1 !important;
              display: block !important;
              border-radius: 0 !important;
            }
            */
            
            /* COMMENTED OUT - Using inline styles for centerPlayBtn instead 
            #centerPlayBtn {
              position: absolute !important;
              top: 50% !important;
              left: 50% !important;
              transform: translate(-50%, -50%) !important;
              width: 90px !important;
              height: 90px !important;
              background: rgba(255,255,255,0.95) !important;
              border-radius: 50% !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              cursor: pointer !important;
              transition: all 0.3s ease !important;
              box-shadow: 0 4px 20px rgba(0,0,0,0.3) !important;
              z-index: 20 !important;
              border: none !important;
              outline: none !important;
            }
            */
            
            #blurOverlay {
              position: absolute !important;
              top: 0 !important;
              left: 0 !important;
              right: 0 !important;
              bottom: 0 !important;
              backdrop-filter: blur(8px) !important;
              background: rgba(0,0,0,0.3) !important;
              z-index: 5 !important;
              transition: all 0.3s ease !important;
              display: block !important;
            }
            
            /* Critical: Hidden state for blur overlay */
            #blurOverlay.hidden {
              display: none !important;
            }
            
            .progress-container {
              position: absolute !important;
              bottom: 0 !important;
              left: 0 !important;
              right: 0 !important;
              width: 100% !important;
              height: 3px !important;
              background: rgba(255,255,255,0.2) !important;
              z-index: 10 !important;
              pointer-events: none !important;
            }
            
            #progressBar {
              height: 100% !important;
              background: rgba(255,255,255,0.9) !important;
              width: 0%;
              transition: width 0.1s linear, opacity 0.3s ease !important;
            }
            
            /* CRITICAL: Keep progress bar visible even when overlay is hidden */
            #progressContainer, #progressBar {
              visibility: visible !important;
              display: block !important;
              opacity: 0.85 !important;
            }
            
            .video-play-overlay.hidden #progressContainer,
            .video-play-overlay.hidden #progressBar {
              visibility: visible !important;
              display: block !important;
              opacity: 0.85 !important;
            }
            
            /* SUPER CRITICAL: Override ANY attempts to hide progress bar */
            #progressContainer[style*="opacity"],
            #progressBar[style*="opacity"] {
              opacity: 0.85 !important;
            }
            
            #progressContainer[style*="visibility"],
            #progressBar[style*="visibility"] {
              visibility: visible !important;
            }
            
            #progressContainer[style*="display"],
            #progressBar[style*="display"] {
              display: block !important;
            }
            
            /* NUCLEAR-LEVEL Progress Bar Always-On-Top Rules */
            .professional-video-player {
              position: relative !important;
              overflow: hidden !important;
              border-radius: 12px !important;
            }
            
            /* Force progress bar above ALL elements */
            .professional-video-player #progressContainer {
              opacity: 0.85 !important;
              visibility: visible !important;
              display: block !important;
              z-index: 99999 !important;
              position: absolute !important;
              bottom: 0 !important;
              left: 0 !important;
              right: 0 !important;
              height: 6px !important;
              background: rgba(0,0,0,0.3) !important;
              border: none !important;
              border-radius: 0 !important;
              pointer-events: none !important;
            }
            
            .professional-video-player #progressBar {
              opacity: 0.85 !important;
              visibility: visible !important;
              display: block !important;
              z-index: 99999 !important;
              position: absolute !important;
              height: 100% !important;
              background: rgba(255,255,255,0.9) !important;
              border-radius: 0 !important;
              pointer-events: none !important;
            }
            
            /* FIXED: Blur overlay with higher specificity to override blanket rule */
            .professional-video-player #blurOverlay {
              z-index: 80 !important;
            }
            
            /* FIXED: Play button with higher specificity to override blanket rule */
            .professional-video-player #centerPlayBtn {
              z-index: 90 !important;
            }
            
            /* FIXED: Volume button with higher specificity to override blanket rule */
            .professional-video-player #volumeBtn {
              z-index: 200 !important;
            }
            
            /* Professional smooth transitions for video overlays */
            .professional-video-player #blurOverlay {
              transition: opacity 0.3s ease, visibility 0.3s ease !important;
            }
            
            .professional-video-player #centerPlayBtn {
              transition: all 0.3s ease !important;
            }
            
            /* Enhanced styling for replay state */
            .professional-video-player #centerPlayBtn:not(.hidden) {
              animation: gentle-pulse 2s ease-in-out infinite !important;
            }
            
            /* Subtle pulse animation for replay button */
            @keyframes gentle-pulse {
              0% { 
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                transform: translate(-50%, -50%) scale(1);
              }
              50% { 
                box-shadow: 0 4px 25px rgba(0,0,0,0.4);
                transform: translate(-50%, -50%) scale(1.02);
              }
              100% { 
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                transform: translate(-50%, -50%) scale(1);
              }
            }
            
            /* Stop animation when hidden */
            .professional-video-player #centerPlayBtn.hidden {
              animation: none !important;
            }
            
            /* Force all other video elements below progress bar */
            .professional-video-player > * {
              z-index: 50 !important;
            }
            
            /* Progress bar overrides everything */
            .professional-video-player #progressContainer,
            .professional-video-player #progressBar {
              z-index: 99999 !important;
            }
            
            /* COMMENTED OUT - Using inline styles for volumeBtn instead
            #volumeBtn {
              position: absolute !important;
              top: 15px !important;
              right: 15px !important;
              background: transparent !important;
              border: none !important;
              color: white !important;
              cursor: pointer !important;
              padding: 0 !important;
              border-radius: 50% !important;
              pointer-events: auto !important;
              transition: all 0.2s ease !important;
              z-index: 15 !important;
              backdrop-filter: none !important;
              width: 45px !important;
              height: 45px !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              box-shadow: none !important;
              outline: none !important;
              text-shadow: 0 1px 2px rgba(0,0,0,0.7) !important;
            }
            
            #volumeBtn:hover {
              background: rgba(0,0,0,0.2) !important;
              backdrop-filter: blur(5px) !important;
            }
            */
            
            /* FIXED: .hidden class using opacity instead of display none */
            .hidden {
              opacity: 0 !important;
              visibility: hidden !important;
              pointer-events: none !important;
              transition: opacity 0.3s ease, visibility 0.3s ease !important;
            }
            
            /* Professional no-transition class for instant initialization */
            .no-transition, .no-transition * {
              transition: none !important;
              -webkit-transition: none !important;
              -moz-transition: none !important;
              -o-transition: none !important;
            }
            
            /* CRITICAL: Higher specificity to override overlay transitions during initialization */
            .professional-video-player.no-transition #blurOverlay {
              transition: none !important;
              -webkit-transition: none !important;
              -moz-transition: none !important;
              -o-transition: none !important;
            }
            
            .professional-video-player.no-transition #centerPlayBtn {
              transition: none !important;
              -webkit-transition: none !important;
              -moz-transition: none !important;
              -o-transition: none !important;
            }

            /* Hide overlay when video is playing */
            .video-overlay.hidden {
              opacity: 0 !important;
              pointer-events: none !important;
            }
            
            /* CRITICAL: Override loading state to ensure calendar buttons are always visible */
            body.confirmation-loading .calendar-buttons-section,
            body.confirmation-loading .calendar-buttons-grid,
            body.confirmation-loading .calendar-btn {
              opacity: 1 !important;
              pointer-events: auto !important;
              visibility: visible !important;
            }
            
            /* DEFAULT: Professional glass effect buttons for desktop/tablet */
            .calendar-btn,
            .calendar-button,
            button[data-calendar],
            .calendar-buttons-grid .calendar-btn,
            .calendar-buttons-grid .calendar-button,
            .calendar-buttons-section .calendar-btn,
            .calendar-buttons-section .calendar-button,
            div.calendar-buttons-grid button,
            div.calendar-buttons-section button {
              background: rgba(255, 255, 255, 0.08) !important;
              background-color: rgba(255, 255, 255, 0.08) !important;
              background-image: none !important;
              backdrop-filter: blur(6px) !important;
              -webkit-backdrop-filter: blur(6px) !important;
              color: rgba(255, 255, 255, 0.9) !important;
              opacity: 1 !important;
              visibility: visible !important;
              display: inline-flex !important;
              z-index: 1000 !important;
              border: none !important;
              border-radius: 6px !important;
              padding: 0.75rem 1rem !important;
              font-size: 0.85rem !important;
              gap: 0.4rem !important;
              position: relative !important;
              transition: all 0.2s ease !important;
              align-items: center !important;
              justify-content: center !important;
              cursor: pointer !important;
              
              /* Enhanced fallback for browsers without backdrop-filter support */
              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05), inset 0 1px rgba(255, 255, 255, 0.05) !important;
            }
            
            /* DEFAULT: Desktop/Tablet hover effects */
            .calendar-btn:hover,
            .calendar-button:hover,
            button[data-calendar]:hover,
            .calendar-buttons-grid .calendar-btn:hover,
            .calendar-buttons-grid .calendar-button:hover {
              background: rgba(255, 255, 255, 0.12) !important;
              background-color: rgba(255, 255, 255, 0.12) !important;
              background-image: none !important;
              backdrop-filter: blur(8px) !important;
              -webkit-backdrop-filter: blur(8px) !important;
              color: rgba(255, 255, 255, 1) !important;
              transition: all 0.2s ease !important;
              box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1), inset 0 1px rgba(255, 255, 255, 0.08) !important;
            }
            
            /* Subtle icon brightness matching video controls */
            .calendar-btn:hover svg g,
            .calendar-button:hover svg g {
              fill: #ffffff !important;
              opacity: 1 !important;
            }
            
            /* REMOVED: This was forcing fill on SVG containers, overriding stroke-based designs
            .calendar-btn svg,
            .calendar-button svg {
              fill: #0f0f0f !important;
              color: #0f0f0f !important;
            }
            */
            
            /* REMOVED: This was forcing ALL SVG children to be filled, causing black squares
            .calendar-btn svg *,
            .calendar-button svg * {
              fill: #0f0f0f !important;
              color: #0f0f0f !important;
              stroke: none !important;
            }
            */
            
            /* FIXED: Dynamic CSS to match corrected SVG syntax and 18x18 viewBox */
            .calendar-btn svg,
            .calendar-button svg {
              display: inline-block !important;
              width: 18px !important;
              height: 18px !important;
              /* FIXED: Allow inline SVG style to work - removed color: transparent */
            }
            
            /* DISABLED: Conflicting CSS rules - using inline styles instead
            .calendar-btn svg path,
            .calendar-btn svg circle,
            .calendar-btn svg rect,
            .calendar-button svg path,
            .calendar-button svg circle,
            .calendar-button svg rect {
              stroke: currentColor !important;
              fill: none !important;
              stroke-width: 1.5 !important;
              vector-effect: non-scaling-stroke !important;
            }
            */
            
            /* SPECIFIC: Handle filled elements (like Apple icon dot) */
            .calendar-btn svg circle[fill="#0f0f0f"],
            .calendar-button svg circle[fill="#0f0f0f"] {
              fill: #0f0f0f !important;
              stroke: none !important;
            }
            
              width: 80px !important;
              height: 80px !important;
              position: relative !important;
            }
            
            
            /* ====== END VIDEO OVERLAY CSS ====== */
          `;
          document.head.appendChild(confirmationCSS);
          console.log('✅ Dynamic confirmation CSS styles injected FIRST');
          
          // Always replace with our custom confirmation page
          // Cal.com's confirmation is inside an iframe and cannot be preserved due to cross-origin restrictions
          pageWrapper.replaceChildren(enhancedContent);
          
          // MOBILE FIX: Scroll to top of page after confirmation page is created
          window.scrollTo({
            top: 0,
            left: 0,
            behavior: 'instant'  // Use instant instead of smooth for immediate positioning
          });
          
          // Also ensure the body is at top position (belt and suspenders approach)
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
          console.log('📱 Scrolled to top for mobile confirmation page positioning');
          
          // Backup scroll in case of async rendering delays
          setTimeout(() => {
            window.scrollTo(0, 0);
            console.log('📱 Backup scroll to top executed');
          }, 100);
          
          if (justCompleted) {
            console.log('✅ Fresh booking - showing professional custom confirmation page');
          } else {
            console.log('✅ Persistence reload - showing preparation accordion');
          }
          
          // Set session storage for persistence
          sessionStorage.setItem('confirmationPageActive', 'true');
          sessionStorage.setItem('confirmationTimestamp', Date.now().toString());
          sessionStorage.setItem('confirmationSource', e?.detail?.source || 'unknown');
          
          console.log('✅ Enhanced confirmation page created successfully');
          window.confirmationPageCreated = true;
          
          // CRITICAL FIX: Remove loading state to show confirmation page
          document.body.classList.remove('confirmation-loading');
          console.log('🔄 Loading state removed - confirmation page now visible');
          
          // SIMPLIFIED: No Cal.com widget moving - always show preparation accordion for consistency
          console.log('✅ Simplified approach: Professional preparation accordion for all confirmation scenarios');
          
          // CSS injection complete - video initialization will be handled by the main video setup
          console.log('🎬 CSS injection complete, video setup delegated to main initialization');
          
          // CRITICAL: Add missing JavaScript functions for confirmation page interactivity
          window.initializeConfirmationPageInteractivity = function() {
            // PREVENT DUPLICATE INITIALIZATION
            if (window.confirmationPageInitialized) {
              console.log('✅ Confirmation page already initialized, skipping...');
              return;
            }
            window.confirmationPageInitialized = true;
            console.log('🚀 Initializing confirmation page interactivity...');
            
            // PROFESSIONAL: Initialize Calendar Buttons
            console.log('📅 Initializing professional calendar buttons...');
            setTimeout(() => {
              initializeCalendarButtons();
            }, 100);
            
            // PROFESSIONAL: Initialize AI Strategy Call CTA button
            console.log('🎯 Initializing professional AI Strategy Call CTA button...');
            const ctaButton = document.getElementById('ctaButton');
            const buttonContainer = document.getElementById('buttonContainer');
            const ctaContainer = document.getElementById('ctaContainer');
            
            if (ctaButton && buttonContainer && ctaContainer) {
              console.log('✅ AI Strategy Call CTA components found - setting up professional action...');
              
              // Check if already initialized to prevent duplicates
              if (!ctaButton.dataset.initialized) {
                ctaButton.dataset.initialized = 'true';
                
                ctaButton.addEventListener('click', async (e) => {
                  e.preventDefault();
                  e.stopPropagation();
                  
                  console.log('🔥 AI Strategy Call CTA clicked - Professional action');
                  
                  if (ctaButton.disabled || window.aiCallProcessing) {
                    console.log('🚫 AI call blocked: Already processing');
                    return;
                  }
                  
                  window.aiCallProcessing = true;
                  
                  try {
                    // Get existing booking data from Cal.com booking
                    let bookingData = {};
                    const bookingDataString = localStorage.getItem('latestBookingData');
                    const questionnaireData = sessionStorage.getItem('questionnaireData') || localStorage.getItem('questionnaireData');
                    
                    if (questionnaireData) {
                      bookingData = { ...JSON.parse(questionnaireData) };
                    }
                    
                    if (bookingDataString) {
                      const booking = JSON.parse(bookingDataString);
                      bookingData = {
                        ...bookingData,
                        email: booking.data?.booking?.attendees?.[0]?.email || bookingData.email || '',
                        name: booking.data?.booking?.attendees?.[0]?.name || bookingData.name || '',
                        bookingId: booking.data?.booking?.id || booking.bookingId || ''
                      };
                    }
                    
                    console.log('📊 Using booking data for professional AI call request:', bookingData);
                    
                    // Show professional loading state (maintain hover appearance)
                    ctaButton.disabled = true;
                    ctaButton.style.background = 'white !important';
                    ctaButton.style.color = '#333333 !important';
                    ctaButton.style.cursor = 'not-allowed';
                    ctaButton.style.transform = 'translateY(-1px)';
                    ctaButton.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                    ctaButton.innerHTML = `
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" style="animation: spin 1s linear infinite;">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" stroke-dasharray="31.416" stroke-dashoffset="31.416" style="animation: progress 1.5s ease-in-out infinite;"/>
                      </svg>
                      Scheduling AI Call...
                    `;
                    
                    // Send actual webhook data to n8n for AI call request
                    const webhookResult = await sendWebhookToN8N(bookingData, 'ai_discovery_call');
                    console.log('🚀 Webhook result:', webhookResult);
                    
                    // Handle response dynamically based on n8n validation
                    handleAICallResponse(webhookResult, ctaContainer, buttonContainer, bookingData);
                    
                    console.log('✅ Professional AI call request completed successfully');
                    
                  } catch (error) {
                    console.error('❌ AI call request failed:', error);
                    
                    // Reset button on error
                    ctaButton.disabled = false;
                    ctaButton.style.background = '#ef4444';
                    ctaButton.style.cursor = 'pointer';
                    ctaButton.innerHTML = `
                      <svg width="10" height="10" viewBox="0 0 24 24" fill="none" style="color: white;">
                        <path d="M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                      Try Again
                    `;
                    
                    setTimeout(() => {
                      ctaButton.style.background = '#0f0f0f';
                      ctaButton.innerHTML = `
                        <svg width="10" height="10" viewBox="0 0 24 24" style="color: rgba(255, 255, 255, 0.9);">
                          <path d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59533 1.99522 8.06814 2.16708 8.43999 2.48353C8.81184 2.79999 9.06334 3.23945 9.14999 3.72C9.31071 4.68007 9.58887 5.61273 9.97999 6.5C10.1018 6.80258 10.1445 7.13162 10.1044 7.45606C10.0642 7.78049 9.94218 8.09014 9.74999 8.35L8.52999 9.57C9.85999 12.0756 11.9544 14.17 14.46 15.5L15.68 14.28C15.9399 14.0878 16.2495 13.9658 16.574 13.9256C16.8984 13.8855 17.2274 13.9282 17.53 14.05C18.4173 14.4411 19.3499 14.7193 20.31 14.88C20.7955 14.9685 21.2387 15.2239 21.5547 15.5997C21.8707 15.9755 22.0397 16.4499 22.03 16.94L22 16.92Z" stroke="rgba(255, 255, 255, 0.9)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                        Get AI Strategy Call in 60 Seconds
                      `;
                    }, 3000);
                  } finally {
                    setTimeout(() => {
                      window.aiCallProcessing = false;
                    }, 2000);
                  }
                });
                
                console.log('✅ Professional AI Strategy Call CTA button initialized');
              } else {
                console.log('✅ AI Strategy Call CTA button already initialized');
              }
            } else {
              console.log('❌ AI Strategy Call CTA components not found');
            }
            
            // PROFESSIONAL AI CALL RESPONSE HANDLER - Dynamic Based on n8n Validation
            function handleAICallResponse(webhookResult, ctaContainer, buttonContainer, bookingData) {
              console.log('✅ Handling AI call response dynamically:', webhookResult);
              
              // Check if success state already exists to prevent duplicates
              const existingSuccessContainer = document.getElementById('successCallContainer');
              if (existingSuccessContainer) {
                console.log('⚠️ SUCCESS: Success state already active, ignoring duplicate');
                return;
              }
              
              console.log('✅ SUCCESS: No existing success container, proceeding...');
              
              if (ctaContainer && buttonContainer) {
                console.log('🧈 SUCCESS: Starting buttery smooth crossfade overlay...');
                
                // 🧈 LUXURY CROSSFADE: Create success container as absolute overlay
                const successContainer = document.createElement('div');
                successContainer.id = 'successCallContainer';
                console.log('📦 SUCCESS: Container element created with ID:', successContainer.id);
                successContainer.style.cssText = `
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 48px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background: transparent;
                  border: 1px solid rgba(34, 197, 94, 0.2);
                  border-radius: 8px;
                  color: #22c55e;
                  font-size: 14px;
                  font-weight: 600;
                  font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
                  cursor: default;
                  opacity: 0;
                  transition: opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1);
                  z-index: 10;
                  box-sizing: border-box;
                `;
                
                // Dynamic content based on webhook response
                if (webhookResult && webhookResult.success) {
                  // SUCCESS: AI call approved (within 30-minute window)
                  successContainer.innerHTML = `🟢 Great! Calling you in 60 seconds`;
                  successContainer.style.color = '#22c55e';
                  successContainer.style.background = 'rgba(34, 197, 94, 0.1)';
                  successContainer.style.border = '1px solid rgba(34, 197, 94, 0.3)';
                } else {
                  // FAILURE: Call window expired
                  successContainer.innerHTML = `🔴 Call window expired`;
                  successContainer.style.color = '#ef4444';
                  successContainer.style.background = 'rgba(239, 68, 68, 0.1)';
                  successContainer.style.border = '1px solid rgba(239, 68, 68, 0.3)';
                }
                
                // Add to container as absolute overlay
                ctaContainer.appendChild(successContainer);
                
                // SMOOTH CROSSFADE: Professional Vercel-style transition
                setTimeout(() => {
                  console.log('🎭 SUCCESS: Starting buttery smooth crossfade...');
                  
                  // Fade out button container with luxury timing
                  if (buttonContainer) {
                    buttonContainer.style.transition = 'opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
                    buttonContainer.style.opacity = '0';
                    buttonContainer.style.pointerEvents = 'none';
                  }
                  
                  // Success appears as button fades (overlapping crossfade)  
                  successContainer.style.opacity = '1';
                  console.log('👁️ SUCCESS: Pure buttery smooth crossfade active!');
                  
                }, 50);
                
                // Add professional success details
                setTimeout(() => {
                  const successDetails = document.createElement('div');
                  successDetails.style.cssText = `
                    position: absolute;
                    top: 56px;
                    left: 0;
                    width: 100%;
                    text-align: center;
                    opacity: 0;
                    transition: opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1);
                  `;
                  
                  // Dynamic supporting text based on response
                  if (webhookResult && webhookResult.success) {
                    successDetails.innerHTML = `
                      <p style="margin: 0; color: #22c55e; font-size: 12px; font-weight: 500; font-family: 'General Sans', sans-serif;">
                        Keep your phone ready
                      </p>
                    `;
                  } else {
                    successDetails.innerHTML = `
                      <p style="margin: 0; color: #ef4444; font-size: 12px; font-weight: 500; font-family: 'General Sans', sans-serif;">
                        See you at the meeting!
                      </p>
                    `;
                  }
                  
                  ctaContainer.appendChild(successDetails);
                  
                  // Smooth fade in for details
                  setTimeout(() => {
                    successDetails.style.opacity = '1';
                  }, 50);
                  
                }, 400);
                
                console.log('✅ SUCCESS: Professional success state displayed with overlay');
                
              } else {
                console.log('❌ SUCCESS: Required containers not found');
              }
            }
            
            // Remove old phone validation logic - no longer needed
            console.log('📞 Phone collection flow removed - using Cal.com data instead');
            
            // PROFESSIONAL WEBHOOK FUNCTIONALITY - Add from backup
            
            // Global webhook state management
            const globalWebhookState = {
              isProcessing: false,
              lastRequestId: null,
              lastRequestTime: 0
            };
            
            /**
             * CENTRAL WEBHOOK FUNCTION - Professional single point of truth  
             * Handles all n8n webhook sends with global deduplication and error handling
             */
            function sendWebhookToN8N(requestData, requestSource = 'ai_discovery_call') {
              const now = Date.now();
              const requestId = `${now}-${Math.random().toString(36).substr(2, 9)}`;
              
              // GLOBAL DEDUPLICATION: 2-second protection window
              if (globalWebhookState.isProcessing || (now - globalWebhookState.lastRequestTime) < 2000) {
                console.log(`🚫 WEBHOOK BLOCKED: Duplicate request prevented (last: ${globalWebhookState.lastRequestId})`);
                return Promise.resolve({ success: false, reason: 'duplicate_blocked' });
              }
              
              globalWebhookState.isProcessing = true;
              globalWebhookState.lastRequestId = requestId;
              globalWebhookState.lastRequestTime = now;
              
              console.log(`📡 CENTRAL WEBHOOK: Sending AI call request ${requestId} from ${requestSource}`);
              
              const webhookData = {
                source: requestSource,
                timestamp: new Date().toISOString(),
                request_id: requestId,
                matching_data: {
                  email: requestData.email || '',
                  name: requestData.name || '',
                  company: requestData.company || '',
                  role: requestData.role || '',
                  teamSize: requestData.teamSize || '',
                  timeline: requestData.timeline || '',
                  challenge: requestData.challenge || '',
                  bookingId: requestData.bookingId || ''
                },
                call_request: {
                  type: "ai_discovery_callback",
                  requested_at: new Date().toISOString(),
                  page_source: "ai_discovery_call_section",
                  user_agent: navigator.userAgent,
                  referrer: document.referrer || 'direct'
                }
              };
              
              const webhookUrl = 'https://n8n.umbryth.com/webhook/d1c24b37-79c4-4a4a-8fae-34008bf985a0';
              const params = new URLSearchParams({
                source: webhookData.source,
                timestamp: webhookData.timestamp,
                request_id: webhookData.request_id,
                email: webhookData.matching_data.email || '',
                name: webhookData.matching_data.name || '',
                company: webhookData.matching_data.company || '',
                role: webhookData.matching_data.role || '',
                teamSize: webhookData.matching_data.teamSize || '',
                timeline: webhookData.matching_data.timeline || '',
                challenge: webhookData.matching_data.challenge || '',
                bookingId: webhookData.matching_data.bookingId || '',
                call_type: webhookData.call_request.type
              });
              
              const getWebhookUrl = `${webhookUrl}?${params.toString()}`;
              console.log('🚀 CENTRAL WEBHOOK: Sending AI call request with URL length:', getWebhookUrl.length);
              
              return fetch(getWebhookUrl, { method: 'GET' })
                .then(response => {
                  console.log(`📡 WEBHOOK ${requestId}: Response status ${response.status}`);
                  if (response.ok) {
                    console.log(`✅ WEBHOOK ${requestId}: Parsing JSON response from n8n`);
                    return response.json().then(data => ({ 
                      success: data.success || false,  // Use n8n's actual success flag
                      message: data.message || '',     // Get the actual message
                      response: data, 
                      requestId 
                    }));
                  } else {
                    console.warn(`⚠️ WEBHOOK ${requestId}: Non-200 response:`, response.status);
                    return response.json().then(data => ({ 
                      success: false, 
                      message: data.message || `HTTP ${response.status}`,
                      error: `HTTP ${response.status}`, 
                      response: data, 
                      requestId 
                    }));
                  }
                })
                .catch(error => {
                  console.error(`❌ WEBHOOK ${requestId}: Network error:`, error.message);
                  return { success: false, error: error.message, requestId };
                })
                .finally(() => {
                  // Reset processing state after 2 seconds
                  setTimeout(() => {
                    globalWebhookState.isProcessing = false;
                    console.log(`🔄 WEBHOOK: Ready for next request (${requestId} completed)`);
                  }, 2000);
                });
            }
              
              // Old phone logic completely removed - using simplified AI call button instead
              
            console.log('✅ AI call functionality simplified and ready');
            
            // 1. Initialize Video Player (PREVENT DUPLICATE INITIALIZATION)
            if (window.videoPlayerInitialized) {
              // PRODUCTION: console.log('✅ Video player already initialized, skipping...');
              return;
            }
            window.videoPlayerInitialized = true;
            
            const videoPlayer = document.getElementById('mainVideo');
            const centerPlayBtn = document.getElementById('centerPlayBtn');
            const playOverlay = document.getElementById('blurOverlay');
            
            if (videoPlayer && centerPlayBtn && playOverlay) {
              // PRODUCTION: console.log('✅ Video player elements found, setting up functionality...');
              
              // iOS Detection for video player optimization
              const isIPhone = /iPhone/i.test(navigator.userAgent);
              const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
              
              // Video source is now set directly in HTML based on challenge type - no separate initialization needed
              console.log('🎬 Video source set during HTML generation based on challenge type');
              
              // Overlays are now visible by default in HTML - no need to show them
              console.log('✅ Overlays are visible by default for professional instant appearance');
              
              // iOS Video Priming - Load first frame to prevent black flash
              if (isIOS) {
                console.log('📱 iOS detected - priming video for smooth playback');
                // Force metadata loading to prepare first frame
                videoPlayer.load();
                // Preload metadata to have frame ready
                videoPlayer.preload = 'metadata';
                console.log('✅ iOS video primed - first frame loaded');
              }
              
              // PROFESSIONAL: Remove no-transition class after initialization to enable smooth interactions
              const videoPlayerContainer = document.querySelector('.professional-video-player');
              if (videoPlayerContainer) {
                // Minimal delay for DOM to settle
                setTimeout(() => {
                  videoPlayerContainer.classList.remove('no-transition');
                  console.log('✅ Transitions enabled after professional instant initialization');
                }, 50);
              }
              
              // Enable video controls for pause capability
              videoPlayer.controls = false; // Start without controls
              
              // Professional Video Interaction System
              let isLoading = false;
              let hasPlayed = false;
              
              
              // Simple direct play function (iOS optimized)
              let playVideo = async () => {
                if (isLoading) return;
                
                console.log('🎥 Direct play initiated');
                isLoading = true;
                
                try {
                  // Clean controls handling - no native controls
                  videoPlayer.controls = false;
                  console.log('📱 Using custom controls only');
                  
                  // iOS-specific: Ensure video is ready before play
                  if (isIOS && videoPlayer.readyState < 2) {
                    console.log('📱 iOS: Video not ready, loading metadata first');
                    videoPlayer.load();
                    // Wait for loadedmetadata event
                    await new Promise(resolve => {
                      videoPlayer.addEventListener('loadedmetadata', resolve, { once: true });
                    });
                  }
                  
                  // Immediate play - no delays
                  await videoPlayer.play();
                  
                  // Don't hide overlays immediately - wait for actual playback
                  console.log('⏳ Play command sent, waiting for video to start playing');
                  
                } catch (err) {
                  console.error('❌ Video play failed:', err);
                  // Show error state
                  const videoCaption = playOverlay.querySelector('.video-caption');
                  if (videoCaption) {
                    videoCaption.textContent = 'Unable to play - Click to retry';
                  }
                } finally {
                  isLoading = false;
                }
              };
              
              // Professional icon switching using two separate SVG elements
              const setPlayIcon = () => {
                const playIcon = document.getElementById('playButtonIcon');
                const replayIcon = document.getElementById('replayButtonIcon');
                if (playIcon && replayIcon) {
                  playIcon.style.display = 'block';
                  replayIcon.style.display = 'none';
                  console.log('▶️ Play icon displayed');
                }
              };
              
              const setReplayIcon = () => {
                const playIcon = document.getElementById('playButtonIcon');
                const replayIcon = document.getElementById('replayButtonIcon');
                if (playIcon && replayIcon) {
                  playIcon.style.display = 'none';
                  replayIcon.style.display = 'block';
                  console.log('🔄 Replay icon displayed');
                }
              };
              
              // Single unified click handler
              const handlePlayClick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                if (videoPlayer.paused) {
                  playVideo();
                } else {
                  // Pause functionality
                  console.log('⏸️ Pausing video');
                  videoPlayer.pause();
                }
              };
              
              // Apply click handlers
              centerPlayBtn.addEventListener('click', handlePlayClick);
              playOverlay.addEventListener('click', handlePlayClick);
              
              // Professional container-based interaction (iOS-safe)
              const videoContainer = document.querySelector('.professional-video-player');
              if (videoContainer) {
                videoContainer.addEventListener('click', (e) => {
                  // Only handle clicks when not clicking on specific buttons
                  if (!e.target.closest('#centerPlayBtn') && !isLoading) {
                    e.preventDefault();
                    e.stopPropagation();
                    handlePlayClick(e);
                  }
                });
              }
              
              // Custom controls enabled for all devices including iOS
              console.log('🎬 Using custom video controls for all devices');
              
              // Professional first frame display using seek technique (from working backup)
              console.log('🎯 Setting up video first frame display...');
              
              
              console.log('🎬 Using stable poster display for clean thumbnail');
              
              // Event handlers for overlay management
              videoPlayer.addEventListener('play', () => {
                console.log('▶️ Video playing');
                playOverlay.classList.add('hidden');
              });
              
              videoPlayer.addEventListener('pause', () => {
                console.log('⏸️ Video paused (first listener)');
                if (!videoPlayer.ended) {
                  playOverlay.classList.remove('hidden');
                  console.log('🎯 First pause listener showing blur overlay');
                  const videoCaption = playOverlay.querySelector('.video-caption');
                  if (videoCaption) {
                    videoCaption.textContent = 'Click to resume video';
                  }
                }
              });
              
              videoPlayer.addEventListener('ended', () => {
                console.log('🏁 Video ended');
                playOverlay.classList.remove('hidden');
                hasPlayed = false; // Reset for replay
                const videoCaption = playOverlay.querySelector('.video-caption');
                if (videoCaption) {
                  videoCaption.textContent = 'Click to replay video';
                }
                // Reset to beginning for clean replay
                videoPlayer.currentTime = 0;
              });
              
              // PROFESSIONAL VIDEO CONTROLS WITH YOUTUBE-STYLE FADE
              const volumeBtn = document.getElementById('volumeBtn');
              const progressContainer = document.getElementById('progressContainer');
              
              if (volumeBtn) {
                let isMuted = false;
                let controlsTimer;
                const FADE_DELAY = 3500; // 3.5 seconds like YouTube
                
                // Add smooth transitions to controls
                volumeBtn.style.transition = 'opacity 0.5s ease-in-out';
                if (progressContainer) {
                  progressContainer.style.transition = 'opacity 0.5s ease-in-out';
                }
                
                // Professional control fade functions
                function showControls() {
                  volumeBtn.style.opacity = isMuted ? '1' : '0.8';
                  if (progressContainer) progressContainer.style.opacity = '0.85';
                  clearTimeout(controlsTimer);
                  startFadeTimer();
                  console.log('🎮 Controls shown');
                }
                
                function hideControls() {
                  if (!videoPlayer.paused) { // Only hide during playback
                    volumeBtn.style.opacity = '0';
                    if (progressContainer) progressContainer.style.opacity = '0.6'; // Subtle visibility
                    console.log('🌅 Controls faded out');
                  }
                }
                
                function startFadeTimer() {
                  controlsTimer = setTimeout(hideControls, FADE_DELAY);
                }
                
                function keepControlsVisible() {
                  volumeBtn.style.opacity = isMuted ? '1' : '0.8';
                  if (progressContainer) progressContainer.style.opacity = '0.85';
                  clearTimeout(controlsTimer);
                }
                
                // Show controls on video interaction
                videoPlayer.addEventListener('mouseenter', showControls);
                videoPlayer.addEventListener('mousemove', showControls);
                
                // Keep controls visible when hovering directly over them
                volumeBtn.addEventListener('mouseenter', keepControlsVisible);
                if (progressContainer) {
                  progressContainer.addEventListener('mouseenter', keepControlsVisible);
                }
                
                // PROFESSIONAL: Immediate fade when leaving control areas (no delay)
                volumeBtn.addEventListener('mouseleave', () => {
                  // Start fading immediately when mouse leaves, like professional sites
                  clearTimeout(controlsTimer);
                  if (!videoPlayer.paused) { // Only hide during playback
                    volumeBtn.style.opacity = '0';
                    console.log('🌅 Volume button fading immediately on mouse leave');
                  }
                });
                if (progressContainer) {
                  progressContainer.addEventListener('mouseleave', () => {
                    clearTimeout(controlsTimer);
                    if (!videoPlayer.paused) { // Only hide during playback  
                      progressContainer.style.opacity = '0.6'; // Subtle visibility
                      console.log('🌅 Progress bar fading immediately on mouse leave');
                    }
                  });
                }
                
                // Show controls on play/pause
                videoPlayer.addEventListener('play', showControls);
                videoPlayer.addEventListener('pause', keepControlsVisible); // Stay visible when paused
                
                // Volume button functionality
                volumeBtn.addEventListener('click', (e) => {
                  e.preventDefault();
                  e.stopPropagation();
                  
                  // Toggle mute state
                  isMuted = !isMuted;
                  videoPlayer.muted = isMuted;
                  
                  // Update button icon - use professional SVG icons
                  const volumeOnIcon = volumeBtn.querySelector('#volumeOnIcon');
                  const volumeOffIcon = volumeBtn.querySelector('#volumeOffIcon');
                  
                  if (isMuted) {
                    if (volumeOnIcon) volumeOnIcon.style.display = 'none';
                    if (volumeOffIcon) volumeOffIcon.style.display = 'block';
                    volumeBtn.style.opacity = '1'; // Full opacity when muted - draw attention!
                    console.log('🔇 Video muted - showing mute icon at full opacity');
                  } else {
                    if (volumeOnIcon) volumeOnIcon.style.display = 'block';
                    if (volumeOffIcon) volumeOffIcon.style.display = 'none';
                    volumeBtn.style.opacity = '0.8'; // Standard unmuted opacity
                    console.log('🔊 Video unmuted - showing volume icon');
                  }
                  
                  // Show controls after interaction
                  showControls();
                });
                
                console.log('✅ Volume button functionality added');
              } else {
                console.log('⚠️ Volume button not found');
              }
              
              // VIDEO PROGRESS BAR FUNCTIONALITY
              const progressBar = document.getElementById('progressBar');
              // progressContainer already declared above in fade functionality
              
              if (progressBar && progressContainer) {
                console.log('✅ Progress bar found - setting up display-only functionality...');
                
                // Disable pointer events for confirmation page (display only)
                progressContainer.style.pointerEvents = 'none';
                progressContainer.style.cursor = 'default';
                
                // Buttery smooth progress bar animation
                let lastProgressPercent = -1;
                videoPlayer.addEventListener('timeupdate', () => {
                  if (videoPlayer.duration && videoPlayer.currentTime >= 0) {
                    const progressPercent = Math.round((videoPlayer.currentTime / videoPlayer.duration) * 100 * 10) / 10; // Round to 1 decimal
                    
                    // Only update if progress actually changed (prevents unnecessary DOM updates)
                    if (progressPercent !== lastProgressPercent) {
                      progressBar.style.setProperty('width', progressPercent + '%', 'important');
                      lastProgressPercent = progressPercent;
                      
                      // Debug logging only every 5% progress
                      if (Math.floor(progressPercent) % 5 === 0) {
                        console.log(`🎥 Smooth progress: ${progressPercent}%`);
                      }
                    }
                  }
                });
                
                // Initialize progress bar visibility and width
                progressContainer.style.opacity = '0.85';
                progressBar.style.setProperty('width', '0%', 'important');
                console.log('✅ Progress bar initialized with paused visibility (0.85 opacity) and 0% width');
                
                // Professional progress bar - always fully visible (YouTube/Netflix style)
                console.log('✅ Progress bar configured for full visibility - no fade behavior');
                
                // CRITICAL: Dynamic progress bar visibility based on playback state
                function enforceProgressBarVisibility(isPlaying = false) {
                  const playingOpacity = '0.35'; // Subtle but still visible during playback
                  const pausedOpacity = '0.85';  // More visible when paused
                  
                  const currentOpacity = isPlaying ? playingOpacity : pausedOpacity;
                  
                  progressContainer.style.setProperty('opacity', currentOpacity, 'important');
                  progressContainer.style.setProperty('visibility', 'visible', 'important');
                  progressContainer.style.setProperty('display', 'block', 'important');
                  progressBar.style.setProperty('opacity', currentOpacity, 'important');
                  progressBar.style.setProperty('visibility', 'visible', 'important');
                  progressBar.style.setProperty('display', 'block', 'important');
                  
                  console.log(`🎥 Progress bar opacity: ${currentOpacity} (${isPlaying ? 'playing' : 'paused'})`);
                }
                
                // Force visibility whenever video plays - fade to lower opacity
                videoPlayer.addEventListener('play', () => {
                  enforceProgressBarVisibility(true); // true = playing, lower opacity
                  console.log('⚡ Progress bar faded to playing opacity (0.35) - subtle but visible');
                });
                
                // Restore normal opacity when video pauses
                videoPlayer.addEventListener('pause', () => {
                  enforceProgressBarVisibility(false); // false = paused, normal opacity
                  console.log('⏸️ Progress bar restored to paused opacity (0.85) - more visible');
                });
                
                // Restore normal opacity when video ends
                videoPlayer.addEventListener('ended', () => {
                  enforceProgressBarVisibility(false); // false = ended, normal opacity
                  console.log('🏁 Progress bar restored to ended opacity (0.85) - more visible');
                });
                
                // Handle hover events to show progress bar more clearly on hover
                const videoContainer = document.querySelector('.professional-video-player');
                if (videoContainer) {
                  videoContainer.addEventListener('mouseenter', () => {
                    // On hover, always show progress bar more clearly regardless of playback state
                    const hoverOpacity = '0.9'; // Higher opacity on hover for better visibility
                    progressContainer.style.setProperty('opacity', hoverOpacity, 'important');
                    progressBar.style.setProperty('opacity', hoverOpacity, 'important');
                    console.log('🖱️ Mouse enter - showing progress bar clearly (0.9 opacity)');
                  });
                  
                  videoContainer.addEventListener('mouseleave', () => {
                    // On mouse leave, restore playback-based opacity
                    const isCurrentlyPlaying = !videoPlayer.paused && !videoPlayer.ended;
                    enforceProgressBarVisibility(isCurrentlyPlaying);
                    console.log('🖱️ Mouse leave - restored to playback-based opacity');
                  });
                }
                
                // DISABLED: No enforcement during time updates to prevent opacity fighting
                // Clean event-driven opacity changes only
                console.log('⚡ Time update enforcement disabled for clean opacity behavior');
                
                // DISABLED: MutationObserver was fighting our opacity changes
                // Now relying purely on event-driven opacity changes for cleaner behavior
                console.log('🛡️ Progress bar using event-driven opacity changes (MutationObserver disabled)');
                
                // DEBUG: Add visibility check function
                function debugProgressBarVisibility() {
                  const containerStyles = window.getComputedStyle(progressContainer);
                  const barStyles = window.getComputedStyle(progressBar);
                  console.log('📊 Progress bar visibility debug:', {
                    containerOpacity: containerStyles.opacity,
                    containerDisplay: containerStyles.display,
                    containerVisibility: containerStyles.visibility,
                    barOpacity: barStyles.opacity,
                    barDisplay: barStyles.display,
                    barVisibility: barStyles.visibility,
                    containerRect: progressContainer.getBoundingClientRect(),
                    barRect: progressBar.getBoundingClientRect()
                  });
                }
                
                // Debug visibility every 5 seconds during playback
                let debugInterval;
                videoPlayer.addEventListener('play', () => {
                  debugInterval = setInterval(debugProgressBarVisibility, 5000);
                });
                
                videoPlayer.addEventListener('pause', () => {
                  if (debugInterval) clearInterval(debugInterval);
                });
                
                // Only reset when video actually ends
                videoPlayer.addEventListener('ended', () => {
                  progressBar.style.setProperty('width', '100%', 'important');
                  console.log('🏁 Video ended - progress set to 100%');
                });
                
                console.log('✅ Progress bar display-only functionality initialized (no scrubbing)');
              } else {
                console.log('⚠️ Progress bar elements not found');
              }
              
              
              // UPDATE EVENT LISTENERS TO SHOW/HIDE PLAY BUTTON
              // Use 'playing' event instead of 'play' to prevent black flash on iOS
              videoPlayer.addEventListener('playing', () => {
                console.log('▶️ Video actually playing (first frame rendered)');
                playOverlay.classList.add('hidden');
                
                // Ensure video is not muted when playing
                if (videoPlayer.muted) {
                  videoPlayer.muted = false;
                  console.log('🔊 Video unmuted on play');
                }
                centerPlayBtn.classList.add('hidden');
                hasPlayed = true;
                
                // Reset to play icon when playing (in case it was showing replay)
                setPlayIcon();
                console.log('✅ Overlays hidden - video fully started');
              });
              
              videoPlayer.addEventListener('pause', () => {
                console.log('⏸️ Video paused');
                if (!videoPlayer.ended) {
                  playOverlay.classList.remove('hidden');
                  centerPlayBtn.classList.remove('hidden');
                  console.log('🎯 Showing pause overlays - blur and play button');
                  const videoCaption = playOverlay.querySelector('.video-caption');
                  if (videoCaption) {
                    videoCaption.textContent = 'Click to resume video';
                  }
                  // Show play icon when paused (not replay)
                  setPlayIcon();
                }
              });
              
              videoPlayer.addEventListener('ended', () => {
                console.log('🏁 Video ended');
                
                // Show overlay and replay button
                playOverlay.classList.remove('hidden');
                centerPlayBtn.classList.remove('hidden');
                hasPlayed = false; // Reset for replay
                
                // Update caption for replay  
                const videoCaption = playOverlay.querySelector('.video-caption');
                if (videoCaption) {
                  videoCaption.textContent = 'Click to replay video';
                }
                
                // Show replay icon when video has ended
                setReplayIcon();
                
                // CRITICAL: Reload video to restore poster (fixes black blur)
                // This resets video state and shows the poster image again
                videoPlayer.load();
                console.log('🔄 Video reloaded - poster restored for clean blur effect');
              });
              
              console.log('✅ Video player functionality initialized with proper play/pause');
            } else {
              console.log('⚠️ Video player elements not found:', {
                videoPlayer: !!videoPlayer,
                centerPlayBtn: !!centerPlayBtn,
                playOverlay: !!playOverlay
              });
            }
            
            // 2. Initialize Accordion
            const prepItems = document.querySelectorAll('.prep-item');
            if (prepItems.length > 0) {
              console.log('✅ Accordion elements found, setting up functionality...');
              
              prepItems.forEach((item, index) => {
                // REMOVED CONFLICTING EVENT LISTENERS
                // The old toggle('active') listeners were conflicting with our togglePrepItem function
                // Now only using the onclick="togglePrepItem(this)" handlers for clean accordion behavior
                console.log('🚫 Removed conflicting toggle listener for item', index);
              });
              
              console.log('✅ Accordion functionality initialized');
              
              // CRITICAL: Initialize modern event listeners for accordion
              if (typeof window.initializeAccordionListeners === 'function') {
                window.initializeAccordionListeners();
              }
              
              // CRITICAL FIX: Clean accordion state after creation (with delay to override other scripts)
              if (typeof window.cleanAccordionState === 'function') {
                window.cleanAccordionState();
                // Double-clean with delay to ensure no other scripts re-add active classes
                setTimeout(() => {
                  window.cleanAccordionState();
                  console.log('🧹 DOUBLE-CLEAN: Ensured accordion state is completely reset');
                }, 100);
              }
              
            } else {
              console.log('⚠️ Accordion elements not found');
            }
            
            // 3. AI phone component already initialized above
            console.log('📱 AI phone component initialization completed above');
            
            console.log('✅ Confirmation page interactivity fully initialized');
          };
          
          // Initialize IMMEDIATELY after DOM insertion - no delays
          const checkAndInitialize = () => {
            const container = document.querySelector('.enhanced-confirmation');
            if (container) {
              console.log('✅ Confirmation container found, initializing immediately...');
              window.initializeConfirmationPageInteractivity();
              
              console.log('📱 AI Strategy Call button initialization handled within confirmation page setup');
            } else {
              console.log('⚠️ Confirmation container not ready, retrying in 50ms...');
              setTimeout(checkAndInitialize, 50);
            }
          };
          checkAndInitialize();
          
          // CRITICAL: Hide Cal.com booking form to prevent conflicts
          const calContainer = document.getElementById('my-cal-inline-30min');
          if (calContainer) {
            calContainer.style.display = 'none';
            console.log('🔒 Cal.com booking form hidden after confirmation page creation');
          }
          
          // Hide any remaining Cal.com elements
          const calElements = document.querySelectorAll('[data-cal-link], [data-cal-namespace]');
          calElements.forEach(el => {
            el.style.display = 'none';
          });
          
          if (calElements.length > 0) {
            console.log(`🔒 Hidden ${calElements.length} additional Cal.com elements`);
          }
        };


        // CRITICAL: Persistence check after function definitions
        console.log('🔍 === BOOKING PERSISTENCE CHECK (AFTER FUNCTION DEFINITIONS) ===');
        
        const existingBooking = localStorage.getItem('bookingConfirmed');
        const isSchedulingAnother = new URLSearchParams(window.location.search).get('schedule_another') === 'true';
        const referrer = document.referrer;
        const isFromForm = referrer && (referrer.includes('contact.html') || referrer.includes('index.html')) && !referrer.includes('schedule_another=true');
        const isReload = !referrer || referrer === window.location.href;
        
        console.log('🔍 existingBooking:', existingBooking);
        console.log('🔍 isSchedulingAnother:', isSchedulingAnother);
        console.log('🔍 referrer:', referrer || 'empty/none');
        console.log('🔍 isFromForm:', isFromForm);
        console.log('🔍 isReload:', isReload);
        
        if (existingBooking === 'true' && !isSchedulingAnother && !isFromForm) {
          console.log('🎯 EXISTING BOOKING DETECTED - Showing confirmation page via persistence');
          console.log('🔍 Persistence state check:', {
            existingBooking,
            bookingTimestamp: localStorage.getItem('bookingTimestamp'),
            confirmationPageCreated: window.confirmationPageCreated,
            bookingHandled: window.bookingHandled
          });
          
          // Reset confirmation page flag to ensure creation works on reload
          window.confirmationPageCreated = false;
          window.bookingHandled = false;
          console.log('✅ Reset flags for persistence reload');
          
          // Get stored questionnaire data for the confirmation page
          let questionnaireData = {};
          try {
            let storedData = localStorage.getItem('questionnaireData');
            if (storedData && storedData !== 'undefined' && storedData !== 'null') {
              questionnaireData = JSON.parse(storedData);
            }
          } catch (error) {
            console.log('⚠️ Could not parse stored questionnaire data:', error);
          }
          
          // Hide Cal.com widget immediately since we're showing confirmation
          const calContainer = document.getElementById('my-cal-inline-30min');
          if (calContainer) {
            calContainer.style.display = 'none';
          }
          
          // Create confirmation page IMMEDIATELY for persistence - DOM is ready
          console.log('🔄 Creating confirmation page for existing booking (persistence)...');
          console.log('🔍 About to call createConfirmationPage with data:', {
            source: 'page_load_existing_booking_persistence',
            data: questionnaireData,
            timestamp: localStorage.getItem('bookingTimestamp'),
            functionExists: typeof window.createConfirmationPage === 'function'
          });
            
            try {
              if (typeof window.createConfirmationPage !== 'function') {
                throw new Error('createConfirmationPage function not defined');
              }
              
              window.createConfirmationPage({
                detail: {
                  source: 'page_load_existing_booking_persistence',
                  data: questionnaireData,
                  timestamp: localStorage.getItem('bookingTimestamp')
                }
              });
              console.log('✅ Persistence confirmation page creation call completed');
              
              // Verify the page was actually created - immediate check
              setTimeout(() => {
                const confirmationContainer = document.querySelector('.enhanced-confirmation');
                const videoPlayer = document.getElementById('mainVideo');
                console.log('🔍 Verification check after persistence creation:', {
                  confirmationContainer: !!confirmationContainer,
                  videoPlayer: !!videoPlayer,
                  pageCreated: window.confirmationPageCreated
                });
              }, 10);
              
            } catch (error) {
              console.error('❌ CRITICAL ERROR: Failed to create confirmation page via persistence:', error);
              console.log('🔄 Clearing failed persistence state and showing Cal.com...');
              
              // Reset persistence flags since creation failed
              localStorage.removeItem('bookingConfirmed');
              sessionStorage.removeItem('confirmationPageActive');
              
              // Show Cal.com widget again
              if (calContainer) {
                calContainer.style.display = 'block';
              }
            }
        } else {
          console.log('📅 No existing booking detected or scheduling another - Cal.com widget remains active');
        }
        
        // Restore original console.log for other scripts
        console.log = originalLog;
        
        // REMOVED: Duplicate Cal.com Universal API event handler - already handled in main DOMContentLoaded listener
      </script>
  <!-- Cookie Consent Script -->
  <script src="js/cookie-consent.js" type="text/javascript"></script>
</body>
</html>
